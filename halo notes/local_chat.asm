;notes by Jesus7Freak

;found chat sender function

;0018D8D4 L"test str"
00545E0F   83FD 0D             CMP EBP,0D
00545E12   74 43               JE SHORT haloce.00545E57
;00545E14   83FD 1B             CMP EBP,1B
;00545E17   75 21               JNZ SHORT haloce.00545E3A
;00545E19   A0 A8E76400         MOV AL,BYTE PTR DS:[64E7A8]
;00545E1E   84C0                TEST AL,AL
;00545E20   74 13               JE SHORT haloce.00545E35
;00545E22   68 FA000000         PUSH 0FA
;00545E27   33FF                XOR EDI,EDI
;00545E29   E8 42DDF4FF         CALL haloce.00493B70
;00545E2E   8B7C24 44           MOV EDI,DWORD PTR SS:[ESP+44]
;00545E32   83C4 04             ADD ESP,4
;00545E35   E8 367FF6FF         CALL haloce.004ADD70
;00545E3A   8B4424 44           MOV EAX,DWORD PTR SS:[ESP+44]
;00545E3E   85C0                TEST EAX,EAX
;00545E40   8BCF                MOV ECX,EDI
;00545E42   8BC5                MOV EAX,EBP
;00545E44   75 50               JNZ SHORT haloce.00545E96
;00545E46   E8 45DEF4FF         CALL haloce.00493C90
;00545E4B   5F                  POP EDI                                  ; Case F100 of switch 00545B1E
;00545E4C   5E                  POP ESI
;00545E4D   5D                  POP EBP
;00545E4E   33C0                XOR EAX,EAX
;00545E50   5B                  POP EBX
;00545E51   83C4 28             ADD ESP,28
;00545E54   C2 1000             RETN 10
00545E57   A0 A8E76400         MOV AL,BYTE PTR DS:[64E7A8]
00545E5C   84C0                TEST AL,AL
00545E5E  ^74 DA               JE SHORT haloce.00545E3A
00545E60   E8 BB7FF6FF         CALL haloce.004ADE20
->
004ADE20   A0 A8E76400      MOV AL,BYTE PTR DS:[64E7A8] ;->AL=01
004ADE25   81EC 00020000    SUB ESP,200
004ADE2B   84C0             TEST AL,AL
004ADE2D   0F84 B8000000    JE haloce.004ADEEB
004ADE33   53               PUSH EBX
004ADE34   E8 C7090000      CALL haloce.004AE800;test if chat is from local player
->
 004AE800   83EC 10          SUB ESP,10
 004AE803   A1 C0558100      MOV EAX,DWORD PTR DS:[8155C0] ;"players" -> EAX=402AAF94
 004AE808   56               PUSH ESI
 004AE809   894424 04        MOV DWORD PTR SS:[ESP+4],EAX
 004AE80D   57               PUSH EDI
 004AE80E   35 72657469      XOR EAX,69746572
 004AE813   83CE FF          OR ESI,FFFFFFFF
 004AE816   8D7C24 08        LEA EDI,DWORD PTR SS:[ESP+8]
 004AE81A   66:C74424 0C 0000 MOV WORD PTR SS:[ESP+C],0
 004AE821   897424 10        MOV DWORD PTR SS:[ESP+10],ESI
 004AE825   894424 14        MOV DWORD PTR SS:[ESP+14],EAX
 004AE829   E8 E2520200      CALL haloce.004D3B10 ;get valid staic player ptr and tag
 004AE82E   85C0             TEST EAX,EAX ;EAX=402AAFCC player 0
 004AE830   74 13            JE SHORT haloce.004AE845
 004AE832   66:3970 02       /CMP WORD PTR DS:[EAX+2],SI ;test player_0->IsLocalPlayer = 0 (0 = local player)
 004AE836   75 15            |JNZ SHORT haloce.004AE84D
 ;004AE838   8D7C24 08        |LEA EDI,DWORD PTR SS:[ESP+8]
 ;004AE83C   E8 CF520200      |CALL haloce.004D3B10
 ;004AE841   85C0             |TEST EAX,EAX
 ;004AE843  ^75 ED            \JNZ SHORT haloce.004AE832
 ;004AE845   5F               POP EDI
 ;004AE846   8BC6             MOV EAX,ESI
 ;004AE848   5E               POP ESI
 ;004AE849   83C4 10          ADD ESP,10
 ;004AE84C   C3               RETN
 004AE84D   0FBE40 67        MOVSX EAX,BYTE PTR DS:[EAX+67]
 004AE851   5F               POP EDI
 004AE852   5E               POP ESI
 004AE853   83C4 10          ADD ESP,10
 004AE856   C3               RETN
<-
004ADE39   8BD8             MOV EBX,EAX;->EBX=00000000
004ADE3B   83FB FF          CMP EBX,-1
004ADE3E   0F84 A1000000    JE haloce.004ADEE5
004ADE44   A1 607D6300      MOV EAX,DWORD PTR DS:[637D60] ;->EAX=0060E770 "KeystoneEditbox"
004ADE49   8B0D 94D16B00    MOV ECX,DWORD PTR DS:[6BD194] ;->ECX=084F1BC8
004ADE4F   56               PUSH ESI
004ADE50   57               PUSH EDI
004ADE51   50               PUSH EAX
004ADE52   51               PUSH ECX
004ADE53   33F6             XOR ESI,ESI
004ADE55   FF15 A8D16B00    CALL DWORD PTR DS:[6BD1A8]               ; keystone.Call_KsGetWindow
->
 102127A0 > 8B4C24 04           MOV ECX,DWORD PTR SS:[ESP+4]
 102127A4   85C9                TEST ECX,ECX
 102127A6   74 0B               JE SHORT keystone.102127B3
 102127A8   8B5424 08           MOV EDX,DWORD PTR SS:[ESP+8]
 102127AC   8B01                MOV EAX,DWORD PTR DS:[ECX] ;EAX=102F2C58   keystone.102F2C58
 102127AE   52                  PUSH EDX
 102127AF   FF50 14             CALL DWORD PTR DS:[EAX+14]
 102127B2   C3                  RETN
 ;102127B3   33C0                XOR EAX,EAX
 ;102127B5   C3                  RETN
<-
004ADE5B   8BF8             MOV EDI,EAX ;->EDI=084EB800
004ADE5D   83C4 08          ADD ESP,8
004ADE60   85FF             TEST EDI,EDI
004ADE62   74 7F            JE SHORT haloce.004ADEE3

004ADE64   68 8CA46000      PUSH haloce.0060A48C                     ; UNICODE "oEditbox"
004ADE69   57               PUSH EDI
004ADE6A   FF15 BCD16B00    CALL DWORD PTR DS:[6BD1BC]               ; keystone.Call_KW_GetControlByID
->
 10212870 > 8B4C24 04           MOV ECX,DWORD PTR SS:[ESP+4] ;->ECX=084EB800
 10212874   85C9                TEST ECX,ECX
 10212876   74 0E               JE SHORT keystone.10212886
 10212878   8B5424 08           MOV EDX,DWORD PTR SS:[ESP+8] ;->EDX=0060A48C L"oEditbox"
 1021287C   8B01                MOV EAX,DWORD PTR DS:[ECX]
 1021287E   52                  PUSH EDX
 1021287F   FF90 84000000       CALL DWORD PTR DS:[EAX+84]
 10212885   C3                  RETN
 ;10212886   33C0                XOR EAX,EAX
 ;10212888   C3                  RETN
<-
004ADE70   83C4 08          ADD ESP,8

004ADE73   85C0             TEST EAX,EAX ;EAX=09539500
004ADE75   74 11            JE SHORT haloce.004ADE88

004ADE77   68 A0A46000      PUSH haloce.0060A4A0                     ; UNICODE "text"
004ADE7C   50               PUSH EAX
004ADE7D   FF15 D0D16B00    CALL DWORD PTR DS:[6BD1D0]               ; keystone.Call_KC_GetAttribute
->
 10212910 > 8B4C24 04           MOV ECX,DWORD PTR SS:[ESP+4] ;->ECX=09539500
 10212914   85C9                TEST ECX,ECX
 10212916   74 0B               JE SHORT keystone.10212923
 10212918   8B5424 08           MOV EDX,DWORD PTR SS:[ESP+8] ;->EDX=haloce.0060A4A0  ; UNICODE "text"
 1021291C   8B01                MOV EAX,DWORD PTR DS:[ECX] ;->EAX=02464790
 1021291E   52                  PUSH EDX
 1021291F   FF50 60             CALL DWORD PTR DS:[EAX+60] ;DS:[024647F0]=0241AAC0
 10212922   C3                  RETN
 ;10212923   33C0                XOR EAX,EAX
 ;10212925   C3                  RETN
<-
004ADE83   83C4 08          ADD ESP,8

004ADE86   8BF0             MOV ESI,EAX ;->ESI=09401588 L"test str" <------------------ from chat
004ADE88   57               PUSH EDI
004ADE89   FF15 B8D16B00    CALL DWORD PTR DS:[6BD1B8]               ; keystone.Call_KW_Release
004ADE8F   83C4 04          ADD ESP,4
004ADE92   85F6             TEST ESI,ESI
004ADE94   74 4D            JE SHORT haloce.004ADEE3
004ADE96   66:833E 00       CMP WORD PTR DS:[ESI],0 ;[ESI]=0074 L't'
004ADE9A   74 47            JE SHORT haloce.004ADEE3

004ADE9C   56               PUSH ESI ;wchar_t* string
004ADE9D   E8 F8CF1100      CALL haloce.005CAE9A ;get string length
->
 005CAE9A   8B4424 04        MOV EAX,DWORD PTR SS:[ESP+4]
 005CAE9E   66:8B08          MOV CX,WORD PTR DS:[EAX] ;<------------1:
 005CAEA1   40               INC EAX
 005CAEA2   40               INC EAX
 005CAEA3   66:85C9          TEST CX,CX
 005CAEA6  ^75 F6            JNZ SHORT haloce.005CAE9E
 005CAEA8   2B4424 04        SUB EAX,DWORD PTR SS:[ESP+4]
 005CAEAC   D1F8             SAR EAX,1
 005CAEAE   48               DEC EAX
 005CAEAF   C3               RETN
<-
004ADEA2   83C4 04          ADD ESP,4

004ADEA5   3D FE000000      CMP EAX,0FE
004ADEAA   76 07            JBE SHORT haloce.004ADEB3
;004ADEAC   BF FE000000      MOV EDI,0FE
;004ADEB1   EB 0B            JMP SHORT haloce.004ADEBE

004ADEB3   56               PUSH ESI ;string
004ADEB4   E8 E1CF1100      CALL haloce.005CAE9A ;get string length (it gets called again?)
004ADEB9   83C4 04          ADD ESP,4

004ADEBC   8BF8             MOV EDI,EAX;->EDX=00000008 
004ADEBE   57               PUSH EDI ;string length param3
004ADEBF   8D5424 10        LEA EDX,DWORD PTR SS:[ESP+10] ;buffer to copy to ->EDX=0018D8D4 (00000000)
004ADEC3   56               PUSH ESI ;string  param2
004ADEC4   52               PUSH EDX ;ptr to player index  param1
004ADEC5   E8 59EF1100      CALL haloce.005CCE23
->
 005CCE23   8B4C24 0C           MOV ECX,DWORD PTR SS:[ESP+C] ;->ECX=00000008 str len
 005CCE27   85C9                TEST ECX,ECX
 005CCE29   56                  PUSH ESI
 005CCE2A   57                  PUSH EDI
 005CCE2B   8B7C24 0C           MOV EDI,DWORD PTR SS:[ESP+C] ;->EDI=0018D8D4
 005CCE2F   8BF7                MOV ESI,EDI
 005CCE31   74 28               JE SHORT haloce.005CCE5B
 005CCE33   8B5424 10           MOV EDX,DWORD PTR SS:[ESP+10] ;->EDX=09401588 "test str"   (chat)
 005CCE37   66:8B02             /MOV AX,WORD PTR DS:[EDX] ;->AX=0074
 005CCE3A   66:8907             |MOV WORD PTR DS:[EDI],AX ;copy to buffer
 005CCE3D   47                  |INC EDI
 005CCE3E   47                  |INC EDI
 005CCE3F   42                  |INC EDX
 005CCE40   42                  |INC EDX
 005CCE41   66:85C0             |TEST AX,AX
 005CCE44   74 03               |JE SHORT haloce.005CCE49
 005CCE46   49                  |DEC ECX
 005CCE47  ^75 EE               \JNZ SHORT haloce.005CCE37
 005CCE49   85C9                TEST ECX,ECX
 005CCE4B   74 0E               JE SHORT haloce.005CCE5B
 ;005CCE4D   49                  DEC ECX
 ;005CCE4E   74 0B               JE SHORT haloce.005CCE5B
 ;005CCE50   33C0                XOR EAX,EAX
 ;005CCE52   D1E9                SHR ECX,1
 ;005CCE54   F3:AB               REP STOS DWORD PTR ES:[EDI]
 ;005CCE56   13C9                ADC ECX,ECX
 ;005CCE58   66:F3:AB            REP STOS WORD PTR ES:[EDI]
 005CCE5B   5F                  POP EDI
 005CCE5C   8BC6                MOV EAX,ESI
 005CCE5E   5E                  POP ESI
 005CCE5F   C3                  RETN
<-
004ADECA   A1 ACE76400      MOV EAX,DWORD PTR DS:[64E7AC] ;->EAX=00000000
004ADECF   53               PUSH EBX ;EBX=00000000 param2 ptr?
004ADED0   8D5424 1C        LEA EDX,DWORD PTR SS:[ESP+1C] ;->EDX=0018D8D4 L"test str" fastcall param1
004ADED4   66:C7447C 1C 0000 MOV WORD PTR SS:[ESP+EDI*2+1C],0 ;add null terminator
004ADEDB   E8 90000000      CALL haloce.004ADF70
->
 004ADF70   83EC 10             SUB ESP,10
 004ADF73   8A4C24 14           MOV CL,BYTE PTR SS:[ESP+14] ;->CL=00 param2
 004ADF77   55                  PUSH EBP
 004ADF78   6A 00               PUSH 0
 004ADF7A   6A 01               PUSH 1
 004ADF7C   6A 00               PUSH 0
 004ADF7E   884C24 18           MOV BYTE PTR SS:[ESP+18],CL
 004ADF82   8D4C24 24           LEA ECX,DWORD PTR SS:[ESP+24] ;address of param2->ECX=0018D8B8
 004ADF86   51                  PUSH ECX
 004ADF87   894424 18           MOV DWORD PTR SS:[ESP+18],EAX
 004ADF8B   6A 00               PUSH 0
 004ADF8D   8D4424 1C           LEA EAX,DWORD PTR SS:[ESP+1C]
 004ADF91   895424 24           MOV DWORD PTR SS:[ESP+24],EDX
 004ADF95   894424 2C           MOV DWORD PTR SS:[ESP+2C],EAX
 004ADF99   6A 0F               PUSH 0F
 004ADF9B   6A 00               PUSH 0
 004ADF9D   BA F87F0000         MOV EDX,7FF8 ;param2
 004ADFA2   B8 20CE8000         MOV EAX,haloce.0080CE20 ;param1 
 004ADFA7   C74424 20 00000000  MOV DWORD PTR SS:[ESP+20],0
 004ADFAF   E8 1C260400         CALL haloce.004F05D0
 ->
  004F05D0   81EC A4000000    SUB ESP,0A4
  004F05D6   53               PUSH EBX
  004F05D7   55               PUSH EBP
  004F05D8   8BAC24 BC000000  MOV EBP,DWORD PTR SS:[ESP+BC] ;struc ptr? ->EBP=0018D8B8
  004F05DF   33DB             XOR EBX,EBX
  004F05E1   56               PUSH ESI
  004F05E2   8BF0             MOV ESI,EAX ;->ESI=0080CE20
  004F05E4   57               PUSH EDI
  004F05E5   33C0             XOR EAX,EAX
  004F05E7   885C24 20        MOV BYTE PTR SS:[ESP+20],BL ;BL=00 Stack SS:[0018D7EC]=28 ('(')
  004F05EB   B9 24000000      MOV ECX,24
  004F05F0   8D7C24 24        LEA EDI,DWORD PTR SS:[ESP+24] ;->EDI=0018D7F0
  004F05F4   F3:AB            REP STOS DWORD PTR ES:[EDI] ;set stack from 0018D7F0 to 0018D880 to zero
  004F05F6   8B8C24 BC000000  MOV ECX,DWORD PTR SS:[ESP+BC] ;->ECX=0000000F
  004F05FD   8B048D 40BA5F00  MOV EAX,DWORD PTR DS:[ECX*4+5FBA40] ;->EAX=0062E460
  004F0604   8B40 0C          MOV EAX,DWORD PTR DS:[EAX+C] ;->EAX=00000007
  004F0607   895424 30        MOV DWORD PTR SS:[ESP+30],EDX ;EDX=00007FF8 Stack SS:[0018D7FC]=00000000 store param2
  004F060B   2BD0             SUB EDX,EAX ;->EDX=00007FF1
  004F060D   894C24 24        MOV DWORD PTR SS:[ESP+24],ECX 
  004F0611   8B8C24 B8000000  MOV ECX,DWORD PTR SS:[ESP+B8] ;->ECX=00000000
  004F0618   895424 38        MOV DWORD PTR SS:[ESP+38],EDX
  004F061C   897424 2C        MOV DWORD PTR SS:[ESP+2C],ESI
  004F0620   897424 40        MOV DWORD PTR SS:[ESP+40],ESI
  004F0624   8D50 FF          LEA EDX,DWORD PTR DS:[EAX-1] ;->EDX=00000006
  004F0627   8D7424 20        LEA ESI,DWORD PTR SS:[ESP+20] ;->ESI=0018D7EC
  004F062B   894C24 28        MOV DWORD PTR SS:[ESP+28],ECX
  004F062F   895C24 34        MOV DWORD PTR SS:[ESP+34],EBX
  004F0633   895C24 58        MOV DWORD PTR SS:[ESP+58],EBX
  004F0637   894424 5C        MOV DWORD PTR SS:[ESP+5C],EAX
  004F063B   895C24 4C        MOV DWORD PTR SS:[ESP+4C],EBX
  004F063F   895C24 48        MOV DWORD PTR SS:[ESP+48],EBX
  004F0643   895C24 3C        MOV DWORD PTR SS:[ESP+3C],EBX
  004F0647   895C24 44        MOV DWORD PTR SS:[ESP+44],EBX
  004F064B   895424 50        MOV DWORD PTR SS:[ESP+50],EDX
  004F064F   894424 54        MOV DWORD PTR SS:[ESP+54],EAX
  004F0653   C64424 20 01     MOV BYTE PTR SS:[ESP+20],1
  004F0658   E8 33030000      CALL haloce.004F0990
  ->
   004F0990   51               PUSH ECX
   004F0991   A1 64826B00      MOV EAX,DWORD PTR DS:[6B8264] ;->EAX=00000000
   004F0996   53               PUSH EBX
   004F0997   57               PUSH EDI
   004F0998   894424 08        MOV DWORD PTR SS:[ESP+8],EAX
   004F099C   8B46 08          MOV EAX,DWORD PTR DS:[ESI+8] ;->EAX=00000000
   004F099F   8D7E 1C          LEA EDI,DWORD PTR DS:[ESI+1C] ;->EDI=0018D808
   004F09A2   50               PUSH EAX
   004F09A3   8BD7             MOV EDX,EDI ;->EDX=0018D808
   004F09A5   E8 3625FEFF      CALL haloce.004D2EE0
   ->
    004D2EE0   53               PUSH EBX
    004D2EE1   8B5A 08          MOV EBX,DWORD PTR DS:[EDX+8] ;->EBX=00000000
    004D2EE4   56               PUSH ESI
    004D2EE5   8B72 0C          MOV ESI,DWORD PTR DS:[EDX+C] ;->ESI=00000000
    004D2EE8   57               PUSH EDI
    004D2EE9   8B7A 10          MOV EDI,DWORD PTR DS:[EDX+10] ;->EDI=00000000
    004D2EEC   8D0CF7           LEA ECX,DWORD PTR DS:[EDI+ESI*8] ;->ECX=00000000
    004D2EEF   32C0             XOR AL,AL
    004D2EF1   3BCB             CMP ECX,EBX
    004D2EF3   72 5C            JB SHORT haloce.004D2F51
    004D2EF5   3B4A 14          CMP ECX,DWORD PTR DS:[EDX+14] ;Stack DS:[0018D81C]=00000006
    004D2EF8   77 57            JA SHORT haloce.004D2F51
    004D2EFA   837C24 10 01     CMP DWORD PTR SS:[ESP+10],1 ;Stack SS:[0018D7B8]=00000000
    004D2EFF   75 11            JNZ SHORT haloce.004D2F12
    ;004D2F01   8B42 04          MOV EAX,DWORD PTR DS:[EDX+4]
    ;004D2F04   03F0             ADD ESI,EAX
    ;004D2F06   8BCF             MOV ECX,EDI
    ;004D2F08   B0 01            MOV AL,1
    ;004D2F0A   D2E0             SHL AL,CL
    ;004D2F0C   8A0E             MOV CL,BYTE PTR DS:[ESI]
    ;004D2F0E   0AC8             OR CL,AL
    ;004D2F10   EB 11            JMP SHORT haloce.004D2F23
    004D2F12   8B4A 04          MOV ECX,DWORD PTR DS:[EDX+4] ;->ECX=0080CE20
    004D2F15   03F1             ADD ESI,ECX ;->ESI=0080CE20
    004D2F17   8BCF             MOV ECX,EDI ;->ECX=00000000
    004D2F19   B0 01            MOV AL,1 
    004D2F1B   D2E0             SHL AL,CL ;->AL=01
    004D2F1D   8A0E             MOV CL,BYTE PTR DS:[ESI] ;->CL=4D 'M'
    004D2F1F   F6D0             NOT AL ;->AL=FE
    004D2F21   22C8             AND CL,AL ;->CL=4C 'L'
    004D2F23   880E             MOV BYTE PTR DS:[ESI],CL
    004D2F25   8B4A 0C          MOV ECX,DWORD PTR DS:[EDX+C] ;->ECX=00000000
    004D2F28   8B42 10          MOV EAX,DWORD PTR DS:[EDX+10] ;->EAX=00000000
    004D2F2B   8D44C8 01        LEA EAX,DWORD PTR DS:[EAX+ECX*8+1] ;->EAX=00000001
    004D2F2F   3B42 08          CMP EAX,DWORD PTR DS:[EDX+8] ;Stack DS:[0018D810]=00000000
    004D2F32   72 05            JB SHORT haloce.004D2F39
    004D2F34   3B42 14          CMP EAX,DWORD PTR DS:[EDX+14] ;Stack DS:[0018D81C]=00000006
    004D2F37   76 08            JBE SHORT haloce.004D2F41
    ;004D2F39   8B4A 14          MOV ECX,DWORD PTR DS:[EDX+14]
    ;004D2F3C   41               INC ECX
    ;004D2F3D   3BC1             CMP EAX,ECX
    ;004D2F3F   75 0E            JNZ SHORT haloce.004D2F4F
    004D2F41   8BC8             MOV ECX,EAX ;->ECX=00000001
    004D2F43   83E1 07          AND ECX,7 ;->ECX=00000001
    004D2F46   C1E8 03          SHR EAX,3 ;->EAX=00000000
    004D2F49   894A 10          MOV DWORD PTR DS:[EDX+10],ECX
    004D2F4C   8942 0C          MOV DWORD PTR DS:[EDX+C],EAX
    004D2F4F   B0 01            MOV AL,1
    004D2F51   5F               POP EDI
    004D2F52   5E               POP ESI
    004D2F53   5B               POP EBX
    004D2F54   C3               RETN
   <-
   004F09AA   8B96 84000000    MOV EDX,DWORD PTR DS:[ESI+84] ;->EDX=00000000
   004F09B0   84C0             TEST AL,AL
   004F09B2   0F95C3           SETNE BL ;->BL=01
   004F09B5   83C2 06          ADD EDX,6 ;->EDX=00000006
   004F09B8   8BC2             MOV EAX,EDX ;->EAX=00000006
   004F09BA   50               PUSH EAX
   004F09BB   8D4E 04          LEA ECX,DWORD PTR DS:[ESI+4] ;->ECX=0018D7F0
   004F09BE   8BC7             MOV EAX,EDI ;->EAX=0018D808
   004F09C0   C786 80000000 01000000  MOV DWORD PTR DS:[ESI+80],1
   004F09CA   8996 84000000    MOV DWORD PTR DS:[ESI+84],EDX
   004F09D0   E8 5B24FEFF      CALL haloce.004D2E30
   004F09D5   83C4 08          ADD ESP,8
   004F09D8   85C0             TEST EAX,EAX ;00000006
   004F09DA   74 08            JE SHORT haloce.004F09E4
   004F09DC   84DB             TEST BL,BL ;01
   004F09DE   74 04            JE SHORT haloce.004F09E4
   004F09E0   B3 01            MOV BL,1
   004F09E2   EB 02            JMP SHORT haloce.004F09E6
   ;004F09E4   32DB             XOR BL,BL
   004F09E6   803D 60826B00 01 CMP BYTE PTR DS:[6B8260],1 ;00
   004F09ED   75 6D            JNZ SHORT haloce.004F0A5C
   ;004F09EF   0FB60D 6C826B00  MOVZX ECX,BYTE PTR DS:[6B826C]
   ;004F09F6   51               PUSH ECX
   ;004F09F7   8BD7             MOV EDX,EDI
   ;004F09F9   C786 88000000 02000000  MOV DWORD PTR DS:[ESI+88],2
   ;004F0A03   E8 D824FEFF      CALL haloce.004D2EE0
   ;004F0A08   83C4 04          ADD ESP,4
   ;004F0A0B   84C0             TEST AL,AL
   ;004F0A0D   74 08            JE SHORT haloce.004F0A17
   ;004F0A0F   84DB             TEST BL,BL
   ;004F0A11   74 04            JE SHORT haloce.004F0A17
   ;004F0A13   B3 01            MOV BL,1
   ;004F0A15   EB 02            JMP SHORT haloce.004F0A19
   ;004F0A17   32DB             XOR BL,BL
   ;004F0A19   8B96 88000000    MOV EDX,DWORD PTR DS:[ESI+88]
   ;004F0A1F   52               PUSH EDX
   ;004F0A20   8D4C24 0C        LEA ECX,DWORD PTR SS:[ESP+C]
   ;004F0A24   8BC7             MOV EAX,EDI
   ;004F0A26   E8 0524FEFF      CALL haloce.004D2E30
   ;004F0A2B   83C4 04          ADD ESP,4
   ;004F0A2E   85C0             TEST EAX,EAX
   ;004F0A30   74 17            JE SHORT haloce.004F0A49
   ;004F0A32   84DB             TEST BL,BL
   ;004F0A34   74 13            JE SHORT haloce.004F0A49
   ;004F0A36   8B8E 88000000    MOV ECX,DWORD PTR DS:[ESI+88]
   ;004F0A3C   41               INC ECX
   ;004F0A3D   5F               POP EDI
   ;004F0A3E   B0 01            MOV AL,1
   ;004F0A40   898E 88000000    MOV DWORD PTR DS:[ESI+88],ECX
   ;004F0A46   5B               POP EBX
   ;004F0A47   59               POP ECX
   ;004F0A48   C3               RETN
   ;004F0A49   8B8E 88000000    MOV ECX,DWORD PTR DS:[ESI+88]
   ;004F0A4F   32C0             XOR AL,AL
   ;004F0A51   41               INC ECX
   ;004F0A52   5F               POP EDI
   ;004F0A53   898E 88000000    MOV DWORD PTR DS:[ESI+88],ECX
   ;004F0A59   5B               POP EBX
   ;004F0A5A   59               POP ECX
   ;004F0A5B   C3               RETN
   004F0A5C   5F               POP EDI
   004F0A5D   8AC3             MOV AL,BL ;->AL=01
   004F0A5F   5B               POP EBX
   004F0A60   59               POP ECX
   004F0A61   C3               RETN
  <-
  004F065D   8B8424 CC000000  MOV EAX,DWORD PTR SS:[ESP+CC] ;->EAX=00000001
  004F0664   3BC3             CMP EAX,EBX ;EBX=00000000
  004F0666   0F8E 25010000    JLE haloce.004F0791
  004F066C   8B9424 C0000000  MOV EDX,DWORD PTR SS:[ESP+C0] ;->EDX=00000000
  004F0673   8BB424 C8000000  MOV ESI,DWORD PTR SS:[ESP+C8] ;->ESI=00000000
  004F067A   2BD5             SUB EDX,EBP ;->EDX=FFE72748
  004F067C   8BCD             MOV ECX,EBP ;->ECX=0018D8B8
  004F067E   2BF5             SUB ESI,EBP ;->ESI=FFE72748
  004F0680   894C24 10        MOV DWORD PTR SS:[ESP+10],ECX
  004F0684   895424 14        MOV DWORD PTR SS:[ESP+14],EDX
  004F0688   897424 1C        MOV DWORD PTR SS:[ESP+1C],ESI
  004F068C   894424 18        MOV DWORD PTR SS:[ESP+18],EAX
  004F0690   EB 0E            JMP SHORT haloce.004F06A0
  ;004F0692   8B7424 1C        /MOV ESI,DWORD PTR SS:[ESP+1C]
  ;004F0696   8B5424 14        |MOV EDX,DWORD PTR SS:[ESP+14]
  ;004F069A   8B4C24 10        |MOV ECX,DWORD PTR SS:[ESP+10]
  ;004F069E   8BFF             |MOV EDI,EDI
  004F06A0   399C24 C0000000   CMP DWORD PTR SS:[ESP+C0],EBX ;Stack SS:[0018D88C]=00000000
  004F06A7   75 04            |JNZ SHORT haloce.004F06AD
  004F06A9   33FF             |XOR EDI,EDI
  004F06AB   EB 03            |JMP SHORT haloce.004F06B0
  ;004F06AD   8B3C0A           |MOV EDI,DWORD PTR DS:[EDX+ECX]
  004F06B0   399C24 B8000000  |CMP DWORD PTR SS:[ESP+B8],EBX ;Stack SS:[0018D884]=00000000
  004F06B7   8B29             |MOV EBP,DWORD PTR DS:[ECX] ;->EBP=0018D8A8
  004F06B9   75 04            |JNZ SHORT haloce.004F06BF
  004F06BB   33F6             |XOR ESI,ESI
  004F06BD   EB 03            |JMP SHORT haloce.004F06C2
  ;004F06BF   8B340E           |MOV ESI,DWORD PTR DS:[ESI+ECX]
  004F06C2   8D4424 20        |LEA EAX,DWORD PTR SS:[ESP+20] ;->EAX=0018D7EC
  004F06C6   E8 25010000      |CALL haloce.004F07F0
  ->
   004F07F0   8B48 08    MOV ECX,DWORD PTR DS:[EAX+8] ;->ECX=00000000
   004F07F3   53         PUSH EBX
   004F07F4   56         PUSH ESI
   004F07F5   57         PUSH EDI
   004F07F6   33FF       XOR EDI,EDI
   004F07F8   83F9 01    CMP ECX,1
   004F07FB   8978 40    MOV DWORD PTR DS:[EAX+40],EDI
   004F07FE   8978 44    MOV DWORD PTR DS:[EAX+44],EDI
   004F0801   75 3B      JNZ SHORT haloce.004F083E
   ;004F0803   8B48 04    MOV ECX,DWORD PTR DS:[EAX+4]
   ;004F0806   8B148D 40BA5F00   MOV EDX,DWORD PTR DS:[ECX*4+5FBA40]
   ;004F080D   8B48 3C    MOV ECX,DWORD PTR DS:[EAX+3C]
   ;004F0810   8B52 20    MOV EDX,DWORD PTR DS:[EDX+20]
   ;004F0813   8B70 0C    MOV ESI,DWORD PTR DS:[EAX+C]
   ;004F0816   8BD9       MOV EBX,ECX
   ;004F0818   83E3 07    AND EBX,7
   ;004F081B   8958 58    MOV DWORD PTR DS:[EAX+58],EBX
   ;004F081E   8BD9       MOV EBX,ECX
   ;004F0820   8948 50    MOV DWORD PTR DS:[EAX+50],ECX
   ;004F0823   8D4C11 FF  LEA ECX,DWORD PTR DS:[ECX+EDX-1]
   ;004F0827   C1EB 03    SHR EBX,3
   ;004F082A   8948 5C    MOV DWORD PTR DS:[EAX+5C],ECX
   ;004F082D   8958 54    MOV DWORD PTR DS:[EAX+54],EBX
   ;004F0830   8978 48    MOV DWORD PTR DS:[EAX+48],EDI
   ;004F0833   8970 4C    MOV DWORD PTR DS:[EAX+4C],ESI
   ;004F0836   8950 60    MOV DWORD PTR DS:[EAX+60],EDX
   ;004F0839   0150 40    ADD DWORD PTR DS:[EAX+40],EDX
   ;004F083C   EB 19      JMP SHORT haloce.004F0857
   004F083E   33D2       XOR EDX,EDX
   004F0840   8D48 48    LEA ECX,DWORD PTR DS:[EAX+48] ;->ECX=0018D834
   004F0843   8911       MOV DWORD PTR DS:[ECX],EDX
   004F0845   8951 04    MOV DWORD PTR DS:[ECX+4],EDX
   004F0848   8951 08    MOV DWORD PTR DS:[ECX+8],EDX
   004F084B   8951 0C    MOV DWORD PTR DS:[ECX+C],EDX
   004F084E   8951 10    MOV DWORD PTR DS:[ECX+10],EDX
   004F0851   8951 14    MOV DWORD PTR DS:[ECX+14],EDX
   004F0854   8951 18    MOV DWORD PTR DS:[ECX+18],EDX
   004F0857   8B70 40    MOV ESI,DWORD PTR DS:[EAX+40]
   004F085A   8B48 3C    MOV ECX,DWORD PTR DS:[EAX+3C] ;->ECX=00000007
   004F085D   8B50 18    MOV EDX,DWORD PTR DS:[EAX+18] ;->EDX=00007FF1
   004F0860   03CE       ADD ECX,ESI
   004F0862   2BD6       SUB EDX,ESI
   004F0864   8B70 0C    MOV ESI,DWORD PTR DS:[EAX+C] ;->ESI=0080CE20
   004F0867   8BD9       MOV EBX,ECX ;->EBX=00000007
   004F0869   83E3 07    AND EBX,7
   004F086C   8958 74    MOV DWORD PTR DS:[EAX+74],EBX
   004F086F   8BD9       MOV EBX,ECX
   004F0871   8978 64    MOV DWORD PTR DS:[EAX+64],EDI
   004F0874   8948 6C    MOV DWORD PTR DS:[EAX+6C],ECX
   004F0877   5F         POP EDI
   004F0878   C1EB 03    SHR EBX,3 ;->EBX=00000000
   004F087B   8970 68    MOV DWORD PTR DS:[EAX+68],ESI
   004F087E   8D4C0A FF  LEA ECX,DWORD PTR DS:[EDX+ECX-1] ;->ECX=00007FF7
   004F0882   8958 70    MOV DWORD PTR DS:[EAX+70],EBX
   004F0885   5E         POP ESI
   004F0886   8948 78    MOV DWORD PTR DS:[EAX+78],ECX
   004F0889   8950 7C    MOV DWORD PTR DS:[EAX+7C],EDX
   004F088C   B0 01      MOV AL,1
   004F088E   5B         POP EBX
   004F088F   C3         RETN
  <-
  004F06CB   56               |PUSH ESI ;00000000
  004F06CC   55               |PUSH EBP ;0018D8A8=0
  004F06CD   57               |PUSH EDI ;00000000
  004F06CE   8D4424 2C        |LEA EAX,DWORD PTR SS:[ESP+2C] ;->EAX=0018D7EC
  004F06D2   E8 B9010000      |CALL haloce.004F0890
  ->
  004F0890   83EC 08           SUB ESP,8
  004F0893   53                PUSH EBX
  004F0894   55                PUSH EBP
  004F0895   56                PUSH ESI
  004F0896   8BF0              MOV ESI,EAX
  004F0898   8B46 04           MOV EAX,DWORD PTR DS:[ESI+4]
  004F089B   8B0C85 40BA5F00   MOV ECX,DWORD PTR DS:[EAX*4+5FBA40]
  004F08A2   8B51 1C           MOV EDX,DWORD PTR DS:[ECX+1C]
  004F08A5   833A 00           CMP DWORD PTR DS:[EDX],0
  004F08A8   57                PUSH EDI
  004F08A9   894C24 14         MOV DWORD PTR SS:[ESP+14],ECX
  004F08AD   7E 68             JLE SHORT haloce.004F0917
  004F08AF   8BC2              MOV EAX,EDX
  004F08B1   8B00              MOV EAX,DWORD PTR DS:[EAX]
  004F08B3   85C0              TEST EAX,EAX
  004F08B5   B3 01             MOV BL,1
  004F08B7   7E 5E             JLE SHORT haloce.004F0917
  ;004F08B9   8D6E 64           LEA EBP,DWORD PTR DS:[ESI+64]
  ;004F08BC   33FF              XOR EDI,EDI
  ;004F08BE   894424 10         MOV DWORD PTR SS:[ESP+10],EAX
  ;004F08C2   8B4E 04           /MOV ECX,DWORD PTR DS:[ESI+4]
  ;004F08C5   8B148D 40BA5F00   |MOV EDX,DWORD PTR DS:[ECX*4+5FBA40]
  ;004F08CC   8B42 1C           |MOV EAX,DWORD PTR DS:[EDX+1C]
  ;004F08CF   8B4C38 08         |MOV ECX,DWORD PTR DS:[EAX+EDI+8]
  ;004F08D3   8B5424 1C         |MOV EDX,DWORD PTR SS:[ESP+1C]
  ;004F08D7   8D4438 08         |LEA EAX,DWORD PTR DS:[EAX+EDI+8]
  ;004F08DB   8B40 04           |MOV EAX,DWORD PTR DS:[EAX+4]
  ;004F08DE   55                |PUSH EBP
  ;004F08DF   03C2              |ADD EAX,EDX
  ;004F08E1   50                |PUSH EAX
  ;004F08E2   6A 00             |PUSH 0
  ;004F08E4   51                |PUSH ECX
  ;004F08E5   FF51 50           |CALL DWORD PTR DS:[ECX+50]
  ;004F08E8   83C4 10           |ADD ESP,10
  ;004F08EB   85C0              |TEST EAX,EAX
  ;004F08ED   7E 10             |JLE SHORT haloce.004F08FF
  ;004F08EF   8B4E 40           |MOV ECX,DWORD PTR DS:[ESI+40]
  ;004F08F2   03C8              |ADD ECX,EAX
  ;004F08F4   84DB              |TEST BL,BL
  ;004F08F6   894E 40           |MOV DWORD PTR DS:[ESI+40],ECX
  ;004F08F9   74 04             |JE SHORT haloce.004F08FF
  ;004F08FB   B3 01             |MOV BL,1
  ;004F08FD   EB 02             |JMP SHORT haloce.004F0901
  ;004F08FF   32DB              |XOR BL,BL
  ;004F0901   8B4424 10         |MOV EAX,DWORD PTR SS:[ESP+10]
  ;004F0905   83C7 10           |ADD EDI,10
  ;004F0908   48                |DEC EAX
  ;004F0909   894424 10         |MOV DWORD PTR SS:[ESP+10],EAX
  ;004F090D  ^75 B3             \JNZ SHORT haloce.004F08C2
  ;004F090F   84DB              TEST BL,BL
  ;004F0911   74 69             JE SHORT haloce.004F097C
  ;004F0913   8B4C24 14         MOV ECX,DWORD PTR SS:[ESP+14]
  004F0917   8B51 20           MOV EDX,DWORD PTR DS:[ECX+20]
  004F091A   33C0              XOR EAX,EAX
  004F091C   B9 10000000       MOV ECX,10
  004F0921   BF 10396500       MOV EDI,haloce.00653910
  004F0926   F3:AB             REP STOS DWORD PTR ES:[EDI] ;set stack to zero
  004F0928   8B4E 08           MOV ECX,DWORD PTR DS:[ESI+8]
  004F092B   BD 01000000       MOV EBP,1
  004F0930   3BCD              CMP ECX,EBP
  004F0932   0F95C3            SETNE BL
  004F0935   33FF              XOR EDI,EDI
  004F0937   85D2              TEST EDX,EDX
  004F0939   895424 14         MOV DWORD PTR SS:[ESP+14],EDX
  004F093D   7E 3D             JLE SHORT haloce.004F097C
  004F093F   90                NOP
  004F0940   8B4C24 20         /MOV ECX,DWORD PTR SS:[ESP+20]
  004F0944   8B4424 24         |MOV EAX,DWORD PTR SS:[ESP+24]
  004F0948   51                |PUSH ECX
  004F0949   57                |PUSH EDI
  004F094A   E8 21010000       |CALL haloce.004F0A70
  004F094F   8B4E 08           |MOV ECX,DWORD PTR DS:[ESI+8]
  004F0952   83C4 08           |ADD ESP,8
  004F0955   3BCD              |CMP ECX,EBP
  004F0957   75 0C             |JNZ SHORT haloce.004F0965
  004F0959   84DB              |TEST BL,BL
  004F095B   75 04             |JNZ SHORT haloce.004F0961
  004F095D   84C0              |TEST AL,AL
  004F095F   74 10             |JE SHORT haloce.004F0971
  004F0961   B3 01             |MOV BL,1
  004F0963   EB 0E             |JMP SHORT haloce.004F0973
  004F0965   84DB              |TEST BL,BL
  004F0967   74 08             |JE SHORT haloce.004F0971
  004F0969   84C0              |TEST AL,AL
  004F096B   74 04             |JE SHORT haloce.004F0971
  004F096D   B3 01             |MOV BL,1
  004F096F   EB 02             |JMP SHORT haloce.004F0973
  004F0971   32DB              |XOR BL,BL
  004F0973   8B4424 14         |MOV EAX,DWORD PTR SS:[ESP+14]
  004F0977   47                |INC EDI
  004F0978   3BF8              |CMP EDI,EAX
  004F097A  ^7C C4             \JL SHORT haloce.004F0940
  004F097C   5F                POP EDI
  004F097D   5E                POP ESI
  004F097E   5D                POP EBP
  004F097F   8AC3              MOV AL,BL
  004F0981   5B                POP EBX
  004F0982   83C4 08           ADD ESP,8
  004F0985   C3                RETN
  <-
  004F06D7   8B4424 70        |MOV EAX,DWORD PTR SS:[ESP+70]
  004F06DB   83C4 0C          |ADD ESP,0C
  004F06DE   3BC3             |CMP EAX,EBX
  004F06E0   7F 09            |JG SHORT haloce.004F06EB
  004F06E2   389C24 D0000000  |CMP BYTE PTR SS:[ESP+D0],BL
  004F06E9   74 2D            |JE SHORT haloce.004F0718
  004F06EB   8B4C24 60        |MOV ECX,DWORD PTR SS:[ESP+60]
  004F06EF   8B7C24 34        |MOV EDI,DWORD PTR SS:[ESP+34]
  004F06F3   8B7424 38        |MOV ESI,DWORD PTR SS:[ESP+38]
  004F06F7   8B5424 5C        |MOV EDX,DWORD PTR SS:[ESP+5C]
  004F06FB   03C1             |ADD EAX,ECX
  004F06FD   8B4C24 58        |MOV ECX,DWORD PTR SS:[ESP+58]
  004F0701   03F8             |ADD EDI,EAX
  004F0703   2BF0             |SUB ESI,EAX
  004F0705   03D0             |ADD EDX,EAX
  004F0707   41               |INC ECX
  004F0708   897C24 34        |MOV DWORD PTR SS:[ESP+34],EDI
  004F070C   897424 38        |MOV DWORD PTR SS:[ESP+38],ESI
  004F0710   895424 5C        |MOV DWORD PTR SS:[ESP+5C],EDX
  004F0714   894C24 58        |MOV DWORD PTR SS:[ESP+58],ECX
  004F0718   837C24 28 01     |CMP DWORD PTR SS:[ESP+28],1
  004F071D   75 23            |JNZ SHORT haloce.004F0742
  004F071F   C74424 68 FFFFFF>|MOV DWORD PTR SS:[ESP+68],-1
  004F0727   895C24 6C        |MOV DWORD PTR SS:[ESP+6C],EBX
  004F072B   895C24 70        |MOV DWORD PTR SS:[ESP+70],EBX
  004F072F   895C24 74        |MOV DWORD PTR SS:[ESP+74],EBX
  004F0733   895C24 78        |MOV DWORD PTR SS:[ESP+78],EBX
  004F0737   895C24 7C        |MOV DWORD PTR SS:[ESP+7C],EBX
  004F073B   899C24 80000000  |MOV DWORD PTR SS:[ESP+80],EBX
  004F0742   8B4C24 10        |MOV ECX,DWORD PTR SS:[ESP+10]
  004F0746   8B4424 18        |MOV EAX,DWORD PTR SS:[ESP+18]
  004F074A   83C1 04          |ADD ECX,4
  004F074D   48               |DEC EAX
  004F074E   C78424 84000000 >|MOV DWORD PTR SS:[ESP+84],-1
  004F0759   899C24 88000000  |MOV DWORD PTR SS:[ESP+88],EBX
  004F0760   899C24 8C000000  |MOV DWORD PTR SS:[ESP+8C],EBX
  004F0767   899C24 90000000  |MOV DWORD PTR SS:[ESP+90],EBX
  004F076E   899C24 94000000  |MOV DWORD PTR SS:[ESP+94],EBX
  004F0775   899C24 98000000  |MOV DWORD PTR SS:[ESP+98],EBX
  004F077C   899C24 9C000000  |MOV DWORD PTR SS:[ESP+9C],EBX
  004F0783   894C24 10        |MOV DWORD PTR SS:[ESP+10],ECX
  004F0787   894424 18        |MOV DWORD PTR SS:[ESP+18],EAX
  004F078B  ^0F85 01FFFFFF    \JNZ haloce.004F0692
  004F0791   8B4C24 34        MOV ECX,DWORD PTR SS:[ESP+34]
  004F0795   8B5424 24        MOV EDX,DWORD PTR SS:[ESP+24]
  004F0799   8B3C95 40BA5F00  MOV EDI,DWORD PTR DS:[EDX*4+5FBA40]
  004F07A0   33C0             XOR EAX,EAX
  004F07A2   3BCB             CMP ECX,EBX
  004F07A4   7E 37            JLE SHORT haloce.004F07DD
  004F07A6   8B47 14          MOV EAX,DWORD PTR DS:[EDI+14]
  004F07A9   83F8 01          CMP EAX,1
  004F07AC   7E 28            JLE SHORT haloce.004F07D6
  004F07AE   0FB6B0 27BB5F00  MOVZX ESI,BYTE PTR DS:[EAX+5FBB27]
  004F07B5   8B4424 58        MOV EAX,DWORD PTR SS:[ESP+58]
  004F07B9   48               DEC EAX
  004F07BA   894424 14        MOV DWORD PTR SS:[ESP+14],EAX
  004F07BE   56               PUSH ESI
  004F07BF   8D4C24 18        LEA ECX,DWORD PTR SS:[ESP+18]
  004F07C3   8D4424 40        LEA EAX,DWORD PTR SS:[ESP+40]
  004F07C7   E8 6426FEFF      CALL haloce.004D2E30
  004F07CC   83C4 04          ADD ESP,4
  004F07CF   89B424 AC000000  MOV DWORD PTR SS:[ESP+AC],ESI
  004F07D6   8B47 0C          MOV EAX,DWORD PTR DS:[EDI+C]
  004F07D9   034424 34        ADD EAX,DWORD PTR SS:[ESP+34]
  004F07DD   5F               POP EDI
  004F07DE   5E               POP ESI
  004F07DF   5D               POP EBP
  004F07E0   5B               POP EBX
  004F07E1   81C4 A4000000    ADD ESP,0A4
  004F07E7   C3               RETN
 <-
 004ADFB4   8BE8                MOV EBP,EAX ;->EBP=0000009F
 004ADFB6   83C4 1C             ADD ESP,1C
 004ADFB9   85ED                TEST EBP,EBP
 004ADFBB   7E 73               JLE SHORT haloce.004AE030
 004ADFBD   8B15 88736B00       MOV EDX,DWORD PTR DS:[6B7388] ;->EDX=haloce.0080DE20
 004ADFC3   53                  PUSH EBX
 004ADFC4   57                  PUSH EDI
 004ADFC5   8BBA DC0A0000       MOV EDI,DWORD PTR DS:[EDX+ADC] ;->EDI=11084288
 004ADFCB   F687 8C0A0000 01    TEST BYTE PTR DS:[EDI+A8C],1 ;[]=2
 004ADFD2   C64424 20 01        MOV BYTE PTR SS:[ESP+20],1
 004ADFD7   8D5D 01             LEA EBX,DWORD PTR SS:[EBP+1] ;->EBX=000000A0
 004ADFDA   75 52               JNZ SHORT haloce.004AE02E
 004ADFDC   8B47 1C             MOV EAX,DWORD PTR DS:[EDI+1C] ;->EAX=00000001
 004ADFDF   8B4F 24             MOV ECX,DWORD PTR DS:[EDI+24] ;->ECX=0000287F
 004ADFE2   56                  PUSH ESI
 004ADFE3   8D77 10             LEA ESI,DWORD PTR DS:[EDI+10] ;->ESI=11084298
 004ADFE6   C1E0 03             SHL EAX,3 ;->EAX=00000008
 004ADFE9   2BC8                SUB ECX,EAX ;->ECX=00002877
 004ADFEB   2B4E 10             SUB ECX,DWORD PTR DS:[ESI+10] ;->ECX=00002874
 004ADFEE   41                  INC ECX ;->ECX=00002875
 004ADFEF   3BD9                CMP EBX,ECX ;EBX=000000A0
 004ADFF1   7E 0F               JLE SHORT haloce.004AE002
 ;004ADFF3   6A 01               PUSH 1
 ;004ADFF5   57                  PUSH EDI
 ;004ADFF6   E8 65310300         CALL haloce.004E1160
 ;004ADFFB   83C4 08             ADD ESP,8
 ;004ADFFE   84C0                TEST AL,AL
 ;004AE000   74 2B               JE SHORT haloce.004AE02D
 004AE002   019F 800A0000       ADD DWORD PTR DS:[EDI+A80],EBX ;DS:[11084D08]=000000E0 += EBX=000000A0
 004AE008   6A 01               PUSH 1 ;param1 (1st pushed param)
 004AE00A   8D4C24 28           LEA ECX,DWORD PTR SS:[ESP+28];address of param2 ->ECX=0018D8B8
 004AE00E   8BC6                MOV EAX,ESI ;->EAX=11084298
 004AE010   E8 1B4E0200         CALL haloce.004D2E30
 ->
  004D2E30   53                  PUSH EBX
  004D2E31   55                  PUSH EBP
  004D2E32   8B6C24 0C           MOV EBP,DWORD PTR SS:[ESP+C];->EBP=00000001 param1
  004D2E36   85ED                TEST EBP,EBP
  004D2E38   56                  PUSH ESI
  004D2E39   57                  PUSH EDI
  004D2E3A   8BF0                MOV ESI,EAX ;->ESI=11084298
  004D2E3C   8BD9                MOV EBX,ECX ;->EBX=0018D8B8
  004D2E3E   8BFD                MOV EDI,EBP ;->EDI=00000001
  004D2E40   7E 37               JLE SHORT haloce.004D2E79
  004D2E42   83FF 20             /CMP EDI,20
  004D2E45   8B13                |MOV EDX,DWORD PTR DS:[EBX] ;->EDX=0018D801
  004D2E47   7C 21               |JL SHORT haloce.004D2E6A
  ;004D2E49   6A 20               |PUSH 20
  ;004D2E4B   E8 10010000         |CALL haloce.004D2F60
  ;004D2E50   83C4 04             |ADD ESP,4
  ;004D2E53   84C0                |TEST AL,AL
  ;004D2E55   74 22               |JE SHORT haloce.004D2E79
  ;004D2E57   83EF 20             |SUB EDI,20
  ;004D2E5A   83C3 04             |ADD EBX,4
  ;004D2E5D   85FF                |TEST EDI,EDI
  ;004D2E5F  ^7F E1               \JG SHORT haloce.004D2E42
  ;004D2E61   8BC5                MOV EAX,EBP
  ;004D2E63   2BC7                SUB EAX,EDI
  ;004D2E65   5F                  POP EDI
  ;004D2E66   5E                  POP ESI
  ;004D2E67   5D                  POP EBP
  ;004D2E68   5B                  POP EBX
  ;004D2E69   C3                  RETN
  004D2E6A   57                  PUSH EDI ;00000001
  004D2E6B   E8 F0000000         CALL haloce.004D2F60
  ->
   004D2F60   8B4E 0C             MOV ECX,DWORD PTR DS:[ESI+C]
   004D2F63   83EC 08             SUB ESP,8
   004D2F66   53                  PUSH EBX
   004D2F67   55                  PUSH EBP
   004D2F68   8B6C24 14           MOV EBP,DWORD PTR SS:[ESP+14]
   004D2F6C   57                  PUSH EDI
   004D2F6D   8B7E 10             MOV EDI,DWORD PTR DS:[ESI+10]
   004D2F70   8D1CCF              LEA EBX,DWORD PTR DS:[EDI+ECX*8]
   004D2F73   8D5C2B FF           LEA EBX,DWORD PTR DS:[EBX+EBP-1]
   004D2F77   32C0                XOR AL,AL
   004D2F79   3B5E 08             CMP EBX,DWORD PTR DS:[ESI+8]
   004D2F7C   0F82 33010000       JB haloce.004D30B5
   004D2F82   3B5E 14             CMP EBX,DWORD PTR DS:[ESI+14]
   004D2F85   0F87 2A010000       JA haloce.004D30B5
   004D2F8B   33DB                XOR EBX,EBX
   004D2F8D   85FF                TEST EDI,EDI
   004D2F8F   74 7C               JE SHORT haloce.004D300D
   004D2F91   BB 08000000         MOV EBX,8
   004D2F96   2BDF                SUB EBX,EDI
   004D2F98   3BEB                CMP EBP,EBX
   004D2F9A   73 08               JNB SHORT haloce.004D2FA4
   004D2F9C   8A85 C0A85F00       MOV AL,BYTE PTR SS:[EBP+5FA8C0]
   004D2FA2   EB 08               JMP SHORT haloce.004D2FAC
   004D2FA4   8A83 C0A85F00       MOV AL,BYTE PTR DS:[EBX+5FA8C0]
   004D2FAA   8BEB                MOV EBP,EBX
   004D2FAC   8B5E 04             MOV EBX,DWORD PTR DS:[ESI+4]
   004D2FAF   03D9                ADD EBX,ECX
   004D2FB1   895C24 10           MOV DWORD PTR SS:[ESP+10],EBX
   004D2FB5   8AD8                MOV BL,AL
   004D2FB7   8BCF                MOV ECX,EDI
   004D2FB9   D2E3                SHL BL,CL
   004D2FBB   8B4C24 10           MOV ECX,DWORD PTR SS:[ESP+10]
   004D2FBF   F6D3                NOT BL
   004D2FC1   2219                AND BL,BYTE PTR DS:[ECX]
   004D2FC3   8ACA                MOV CL,DL
   004D2FC5   22C8                AND CL,AL
   004D2FC7   8AC1                MOV AL,CL
   004D2FC9   8BCF                MOV ECX,EDI
   004D2FCB   D2E0                SHL AL,CL
   004D2FCD   8BCD                MOV ECX,EBP
   004D2FCF   D3EA                SHR EDX,CL
   004D2FD1   0AD8                OR BL,AL
   004D2FD3   8B4424 10           MOV EAX,DWORD PTR SS:[ESP+10]
   004D2FD7   8818                MOV BYTE PTR DS:[EAX],BL
   004D2FD9   8B4E 0C             MOV ECX,DWORD PTR DS:[ESI+C]
   004D2FDC   8B7E 10             MOV EDI,DWORD PTR DS:[ESI+10]
   004D2FDF   8D44CD 00           LEA EAX,DWORD PTR SS:[EBP+ECX*8]
   004D2FE3   8B4E 08             MOV ECX,DWORD PTR DS:[ESI+8]
   004D2FE6   03C7                ADD EAX,EDI
   004D2FE8   3BC1                CMP EAX,ECX
   004D2FEA   8BDD                MOV EBX,EBP
   004D2FEC   72 05               JB SHORT haloce.004D2FF3
   004D2FEE   3B46 14             CMP EAX,DWORD PTR DS:[ESI+14]
   004D2FF1   76 08               JBE SHORT haloce.004D2FFB
   004D2FF3   8B4E 14             MOV ECX,DWORD PTR DS:[ESI+14]
   004D2FF6   41                  INC ECX
   004D2FF7   3BC1                CMP EAX,ECX
   004D2FF9   75 0E               JNZ SHORT haloce.004D3009
   004D2FFB   8BC8                MOV ECX,EAX
   004D2FFD   83E1 07             AND ECX,7
   004D3000   C1E8 03             SHR EAX,3
   004D3003   894E 10             MOV DWORD PTR DS:[ESI+10],ECX
   004D3006   8946 0C             MOV DWORD PTR DS:[ESI+C],EAX
   004D3009   8B6C24 18           MOV EBP,DWORD PTR SS:[ESP+18]
   004D300D   3BDD                CMP EBX,EBP
   004D300F   0F83 9E000000       JNB haloce.004D30B3
   004D3015   8B4E 04             /MOV ECX,DWORD PTR DS:[ESI+4]
   004D3018   8B46 0C             |MOV EAX,DWORD PTR DS:[ESI+C]
   004D301B   8BFD                |MOV EDI,EBP
   004D301D   2BFB                |SUB EDI,EBX
   004D301F   83FF 08             |CMP EDI,8
   004D3022   72 37               |JB SHORT haloce.004D305B
   004D3024   881408              |MOV BYTE PTR DS:[EAX+ECX],DL
   004D3027   8B4E 10             |MOV ECX,DWORD PTR DS:[ESI+10]
   004D302A   8B46 0C             |MOV EAX,DWORD PTR DS:[ESI+C]
   004D302D   8D44C1 08           |LEA EAX,DWORD PTR DS:[ECX+EAX*8+8]
   004D3031   8B4E 08             |MOV ECX,DWORD PTR DS:[ESI+8]
   004D3034   C1EA 08             |SHR EDX,8
   004D3037   83C3 08             |ADD EBX,8
   004D303A   3BC1                |CMP EAX,ECX
   004D303C   72 05               |JB SHORT haloce.004D3043
   004D303E   3B46 14             |CMP EAX,DWORD PTR DS:[ESI+14]
   004D3041   76 08               |JBE SHORT haloce.004D304B
   004D3043   8B4E 14             |MOV ECX,DWORD PTR DS:[ESI+14]
   004D3046   41                  |INC ECX
   004D3047   3BC1                |CMP EAX,ECX
   004D3049   75 60               |JNZ SHORT haloce.004D30AB
   004D304B   8BC8                |MOV ECX,EAX
   004D304D   83E1 07             |AND ECX,7
   004D3050   C1E8 03             |SHR EAX,3
   004D3053   894E 10             |MOV DWORD PTR DS:[ESI+10],ECX
   004D3056   8946 0C             |MOV DWORD PTR DS:[ESI+C],EAX
   004D3059   EB 50               |JMP SHORT haloce.004D30AB
   004D305B   8D2C08              |LEA EBP,DWORD PTR DS:[EAX+ECX]
   004D305E   8A87 B4A85F00       |MOV AL,BYTE PTR DS:[EDI+5FA8B4]
   004D3064   2245 00             |AND AL,BYTE PTR SS:[EBP]
   004D3067   8A8F C0A85F00       |MOV CL,BYTE PTR DS:[EDI+5FA8C0]
   004D306D   22CA                |AND CL,DL
   004D306F   0AC1                |OR AL,CL
   004D3071   8845 00             |MOV BYTE PTR SS:[EBP],AL
   004D3074   8B46 0C             |MOV EAX,DWORD PTR DS:[ESI+C]
   004D3077   8BCF                |MOV ECX,EDI
   004D3079   03DF                |ADD EBX,EDI
   004D307B   8D04C7              |LEA EAX,DWORD PTR DS:[EDI+EAX*8]
   004D307E   8B7E 10             |MOV EDI,DWORD PTR DS:[ESI+10]
   004D3081   D3EA                |SHR EDX,CL
   004D3083   8B4E 08             |MOV ECX,DWORD PTR DS:[ESI+8]
   004D3086   03C7                |ADD EAX,EDI
   004D3088   3BC1                |CMP EAX,ECX
   004D308A   72 05               |JB SHORT haloce.004D3091
   004D308C   3B46 14             |CMP EAX,DWORD PTR DS:[ESI+14]
   004D308F   76 08               |JBE SHORT haloce.004D3099
   004D3091   8B4E 14             |MOV ECX,DWORD PTR DS:[ESI+14]
   004D3094   41                  |INC ECX
   004D3095   3BC1                |CMP EAX,ECX
   004D3097   75 0E               |JNZ SHORT haloce.004D30A7
   004D3099   8BC8                |MOV ECX,EAX
   004D309B   83E1 07             |AND ECX,7
   004D309E   C1E8 03             |SHR EAX,3
   004D30A1   894E 10             |MOV DWORD PTR DS:[ESI+10],ECX
   004D30A4   8946 0C             |MOV DWORD PTR DS:[ESI+C],EAX
   004D30A7   8B6C24 18           |MOV EBP,DWORD PTR SS:[ESP+18]
   004D30AB   3BDD                |CMP EBX,EBP
   004D30AD  ^0F82 62FFFFFF       \JB haloce.004D3015
   004D30B3   B0 01               MOV AL,1
   004D30B5   5F                  POP EDI
   004D30B6   5D                  POP EBP
   004D30B7   5B                  POP EBX
   004D30B8   83C4 08             ADD ESP,8
   004D30BB   C3                  RETN
  <-
  004D2E70   83C4 04             ADD ESP,4
  004D2E73   84C0                TEST AL,AL ;01
  004D2E75   74 02               JE SHORT haloce.004D2E79
  004D2E77   33FF                XOR EDI,EDI
  004D2E79   8BC5                MOV EAX,EBP
  004D2E7B   2BC7                SUB EAX,EDI
  004D2E7D   5F                  POP EDI
  004D2E7E   5E                  POP ESI
  004D2E7F   5D                  POP EBP
  004D2E80   5B                  POP EBX
  004D2E81   C3                  RETN
 <-
 004AE015   55                  PUSH EBP
 004AE016   B9 20CE8000         MOV ECX,haloce.0080CE20 ;->ECX=0080CE20
 004AE01B   8BC6                MOV EAX,ESI ;->EAX=11084298
 004AE01D   C646 1C 00          MOV BYTE PTR DS:[ESI+1C],0
 004AE021   E8 0A4E0200         CALL haloce.004D2E30 ;called twice?
 ->
 <-;ret EAX=0000009F
 004AE026   83C4 08             ADD ESP,8 
 004AE029   C646 1C 00          MOV BYTE PTR DS:[ESI+1C],0 ;DS:[110842B4]=00
 004AE02D   5E                  POP ESI
 004AE02E   5F                  POP EDI
 004AE02F   5B                  POP EBX
 004AE030   5D                  POP EBP
 004AE031   83C4 10             ADD ESP,10
 004AE034   C3                  RETN
<-
004ADEE0   83C4 10          ADD ESP,10
004ADEE3   5F               POP EDI
004ADEE4   5E               POP ESI
004ADEE5   E8 86FEFFFF      CALL haloce.004ADD70 ;close the chat window
->
 004ADD70   51                  PUSH ECX
 004ADD71   A0 A8E76400         MOV AL,BYTE PTR DS:[64E7A8]
 004ADD76   84C0                TEST AL,AL
 004ADD78   0F84 99000000       JE haloce.004ADE17
 004ADD7E   8025 92D56A00 FB    AND BYTE PTR DS:[6AD592],0FB
 004ADD85   A1 50C76400         MOV EAX,DWORD PTR DS:[64C750]
 004ADD8A   83C9 FF             OR ECX,FFFFFFFF
 004ADD8D   85C0                TEST EAX,EAX
 004ADD8F   890D ACE76400       MOV DWORD PTR DS:[64E7AC],ECX
 004ADD95   C605 A8E76400 00    MOV BYTE PTR DS:[64E7A8],0
 004ADD9C   74 35               JE SHORT haloce.004ADDD3
 004ADD9E   57                  PUSH EDI
 004ADD9F   6A 00               PUSH 0
 004ADDA1   8D5424 08           LEA EDX,DWORD PTR SS:[ESP+8]
 004ADDA5   52                  PUSH EDX
 004ADDA6   6A 00               PUSH 0
 004ADDA8   6A 14               PUSH 14
 004ADDAA   894C24 14           MOV DWORD PTR SS:[ESP+14],ECX
 004ADDAE   8B08                MOV ECX,DWORD PTR DS:[EAX]
 004ADDB0   50                  PUSH EAX
 004ADDB1   FF51 28             CALL DWORD PTR DS:[ECX+28]
 004ADDB4   33C0                XOR EAX,EAX
 004ADDB6   B9 1B000000         MOV ECX,1B
 004ADDBB   BF DDC56400         MOV EDI,haloce.0064C5DD
 004ADDC0   F3:AB               REP STOS DWORD PTR ES:[EDI]
 004ADDC2   AA                  STOS BYTE PTR ES:[EDI]
 004ADDC3   B9 1B000000         MOV ECX,1B
 004ADDC8   33C0                XOR EAX,EAX
 004ADDCA   BF 70C56400         MOV EDI,haloce.0064C570
 004ADDCF   F3:AB               REP STOS DWORD PTR ES:[EDI]
 004ADDD1   AA                  STOS BYTE PTR ES:[EDI]
 004ADDD2   5F                  POP EDI
 004ADDD3   A1 607D6300         MOV EAX,DWORD PTR DS:[637D60]
 004ADDD8   8B0D 94D16B00       MOV ECX,DWORD PTR DS:[6BD194]
 004ADDDE   56                  PUSH ESI
 004ADDDF   50                  PUSH EAX
 004ADDE0   51                  PUSH ECX
 004ADDE1   C705 DCD16B00 00000>MOV DWORD PTR DS:[6BD1DC],0
 004ADDEB   FF15 A8D16B00       CALL DWORD PTR DS:[6BD1A8]               ; keystone.Call_KsGetWindow
 004ADDF1   8BF0                MOV ESI,EAX
 004ADDF3   83C4 08             ADD ESP,8
 004ADDF6   85F6                TEST ESI,ESI
 004ADDF8   74 1C               JE SHORT haloce.004ADE16
 004ADDFA   6A 00               PUSH 0
 004ADDFC   56                  PUSH ESI
 004ADDFD   FF15 C4D16B00       CALL DWORD PTR DS:[6BD1C4]               ; keystone.Call_KW_SetFocusControl
 004ADE03   6A 00               PUSH 0
 004ADE05   56                  PUSH ESI
 004ADE06   FF15 CCD16B00       CALL DWORD PTR DS:[6BD1CC]               ; keystone.Call_KW_ShowWindow
 004ADE0C   56                  PUSH ESI
 004ADE0D   FF15 B8D16B00       CALL DWORD PTR DS:[6BD1B8]               ; keystone.Call_KW_Release
 004ADE13   83C4 14             ADD ESP,14
 004ADE16   5E                  POP ESI
 004ADE17   59                  POP ECX
 004ADE18   C3                  RETN
<-
004ADEEA   5B               POP EBX
004ADEEB   81C4 00020000    ADD ESP,200
004ADEF1   C3               RETN
<-
00545E65   68 C8000000         PUSH 0C8
00545E6A   BF 38000000         MOV EDI,38
00545E6F   E8 FCDCF4FF         CALL haloce.00493B70
00545E74   68 C8000000         PUSH 0C8
00545E79   BF 66000000         MOV EDI,66
00545E7E   E8 EDDCF4FF         CALL haloce.00493B70
00545E83   83C4 08             ADD ESP,8
00545E86   5F                  POP EDI
00545E87   5E                  POP ESI
00545E88   5D                  POP EBP
00545E89   33C0                XOR EAX,EAX
00545E8B   5B                  POP EBX
00545E8C   83C4 28             ADD ESP,28
00545E8F   C2 1000             RETN 10

