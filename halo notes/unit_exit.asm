;notes by Jesus7Freak
;haloce :rpg_beta6_2 first-player vehicle=rp_h1
...1 ;inspect
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F5DD8   haloce.0048C8D0
...2 ;unit_exit
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F68DC   haloce.0047ED60 
...3 ;unit
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F5DF4   haloce.0048C9D0
...4 ;list_get
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F60A0   haloce.0047D6C0
...5 ;players
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F5EA4   haloce.0047D1D0
...6 ;list_get
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F60A0   haloce.0047D6C0
...7 ;list_get
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F60A0   haloce.0047D6C0
...8 ;unit
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F5DF4   haloce.0048C9D0
...9 ;unit_exit
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F68DC   haloce.0047ED60 
...10 ;inspect
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F5DD8   haloce.0048C8D0
...




...3
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F5DF4   haloce.0048C9D0
->
0048C9D0   8B5424 08        MOV EDX,DWORD PTR SS:[ESP+8]
0048C9D4   8B0D B0558100    MOV ECX,DWORD PTR DS:[8155B0] ;hs thread
0048C9DA   8B49 34          MOV ECX,DWORD PTR DS:[ECX+34]
0048C9DD   8BC2             MOV EAX,EDX
0048C9DF   25 FFFF0000      AND EAX,0FFFF
0048C9E4   69C0 18020000    IMUL EAX,EAX,218
0048C9EA   53               PUSH EBX
0048C9EB   56               PUSH ESI
0048C9EC   8D7408 10        LEA ESI,DWORD PTR DS:[EAX+ECX+10]
0048C9F0   8B06             MOV EAX,DWORD PTR DS:[ESI]
0048C9F2   33C9             XOR ECX,ECX
0048C9F4   66:8B48 0C       MOV CX,WORD PTR DS:[EAX+C]
0048C9F8   57               PUSH EDI
0048C9F9   0FBFF9           MOVSX EDI,CX
0048C9FC   8D5C07 0E        LEA EBX,DWORD PTR DS:[EDI+EAX+E]
0048CA00   83C1 04          ADD ECX,4
0048CA03   66:8948 0C       MOV WORD PTR DS:[EAX+C],CX
0048CA07   8A4424 18        MOV AL,BYTE PTR SS:[ESP+18]
0048CA0B   84C0             TEST AL,AL
0048CA0D   74 2E            JE SHORT haloce.0048CA3D
0048CA0F   A1 B4558100      MOV EAX,DWORD PTR DS:[8155B4] ;script node
0048CA14   8B48 34          MOV ECX,DWORD PTR DS:[EAX+34]
0048CA17   8B06             MOV EAX,DWORD PTR DS:[ESI]
0048CA19   8B40 04          MOV EAX,DWORD PTR DS:[EAX+4]
0048CA1C   25 FFFF0000      AND EAX,0FFFF
0048CA21   8D0480           LEA EAX,DWORD PTR DS:[EAX+EAX*4]
0048CA24   8B4481 10        MOV EAX,DWORD PTR DS:[ECX+EAX*4+10]
0048CA28   25 FFFF0000      AND EAX,0FFFF
0048CA2D   8D0480           LEA EAX,DWORD PTR DS:[EAX+EAX*4]
0048CA30   8B4481 08        MOV EAX,DWORD PTR DS:[ECX+EAX*4+8] ;EAX=E3770004
0048CA34   E8 77080000      CALL haloce.0048D2B0
->
0048D2B0   55               PUSH EBP
0048D2B1   8B2D B0558100    MOV EBP,DWORD PTR DS:[8155B0] ;hs thread
0048D2B7   56               PUSH ESI
0048D2B8   8B35 B4558100    MOV ESI,DWORD PTR DS:[8155B4] ;script node
0048D2BE   8B76 34          MOV ESI,DWORD PTR DS:[ESI+34]
0048D2C1   81E2 FFFF0000    AND EDX,0FFFF
0048D2C7   57               PUSH EDI
0048D2C8   69D2 18020000    IMUL EDX,EDX,218
0048D2CE   8BF8             MOV EDI,EAX
0048D2D0   8B45 34          MOV EAX,DWORD PTR SS:[EBP+34]
0048D2D3   8BCF             MOV ECX,EDI
0048D2D5   81E1 FFFF0000    AND ECX,0FFFF
0048D2DB   8D0C89           LEA ECX,DWORD PTR DS:[ECX+ECX*4]
0048D2DE   8D348E           LEA ESI,DWORD PTR DS:[ESI+ECX*4]
0048D2E1   8A4E 06          MOV CL,BYTE PTR DS:[ESI+6]
0048D2E4   03C2             ADD EAX,EDX
0048D2E6   F6C1 01          TEST CL,1
0048D2E9   74 65            JE SHORT haloce.0048D350
...
0048D350   8B48 10          MOV ECX,DWORD PTR DS:[EAX+10]
0048D353   8959 08          MOV DWORD PTR DS:[ECX+8],EBX
0048D356   8B4D 34          MOV ECX,DWORD PTR SS:[EBP+34]
0048D359   03CA             ADD ECX,EDX
0048D35B   8B51 10          MOV EDX,DWORD PTR DS:[ECX+10]
0048D35E   0FBF72 0C        MOVSX ESI,WORD PTR DS:[EDX+C]
0048D362   8D7416 10        LEA ESI,DWORD PTR DS:[ESI+EDX+10]
0048D366   8916             MOV DWORD PTR DS:[ESI],EDX
0048D368   8971 10          MOV DWORD PTR DS:[ECX+10],ESI
0048D36B   66:C746 0C 0000  MOV WORD PTR DS:[ESI+C],0
0048D371   8A48 03          MOV CL,BYTE PTR DS:[EAX+3]
0048D374   8B50 10          MOV EDX,DWORD PTR DS:[EAX+10]
0048D377   80C9 01          OR CL,1
0048D37A   8848 03          MOV BYTE PTR DS:[EAX+3],CL
0048D37D   897A 04          MOV DWORD PTR DS:[EDX+4],EDI
0048D380   5F               POP EDI
0048D381   5E               POP ESI
0048D382   5D               POP EBP
0048D383   C3               RETN
<-
0048CA39   5F               POP EDI
0048CA3A   5E               POP ESI
0048CA3B   5B               POP EBX
0048CA3C   C3               RETN
<-
0048D1E6   83C4 0C          ADD ESP,0C
0048D1E9   EB 53            JMP SHORT haloce.0048D23E
...
0048D23E   8B4E 10          MOV ECX,DWORD PTR DS:[ESI+10]
0048D241   8D46 18          LEA EAX,DWORD PTR DS:[ESI+18]
0048D244   3BC8             CMP ECX,EAX
0048D246  ^0F85 14FFFFFF    JNZ haloce.0048D160
...
0048D160   8B4E 08          MOV ECX,DWORD PTR DS:[ESI+8]
0048D163   85C9             TEST ECX,ECX
0048D165   0F8C E1000000    JL haloce.0048D24C
0048D16B   A1 90CD6800      MOV EAX,DWORD PTR DS:[68CD90]
0048D170   8038 00          CMP BYTE PTR DS:[EAX],0
0048D173   74 17            JE SHORT haloce.0048D18C
0048D173   74 17            JE SHORT haloce.0048D18C
0048D175   8A50 01          MOV DL,BYTE PTR DS:[EAX+1]
0048D178   84D2             TEST DL,DL
0048D17A   75 07            JNZ SHORT haloce.0048D183
...
0048D183   3B48 0C          CMP ECX,DWORD PTR DS:[EAX+C]
0048D186   0F8F C0000000    JG haloce.0048D24C
0048D18C   A0 38C56400      MOV AL,BYTE PTR DS:[64C538]
0048D191   84C0             TEST AL,AL
0048D193   0F84 B3000000    JE haloce.0048D24C
0048D199   8B4E 10          MOV ECX,DWORD PTR DS:[ESI+10]
0048D19C   8B41 04          MOV EAX,DWORD PTR DS:[ECX+4]
0048D19F   25 FFFF0000      AND EAX,0FFFF
0048D1A4   8D1480           LEA EDX,DWORD PTR DS:[EAX+EAX*4]
0048D1A7   A1 B4558100      MOV EAX,DWORD PTR DS:[8155B4]
0048D1AC   8B40 34          MOV EAX,DWORD PTR DS:[EAX+34]
0048D1AF   8D0490           LEA EAX,DWORD PTR DS:[EAX+EDX*4]
0048D1B2   8A56 03          MOV DL,BYTE PTR DS:[ESI+3]
0048D1B5   66:C741 0C 0000  MOV WORD PTR DS:[ECX+C],0
0048D1BB   8066 03 FE       AND BYTE PTR DS:[ESI+3],0FE
0048D1BF   8A48 06          MOV CL,BYTE PTR DS:[EAX+6]
0048D1C2   0FBF40 02        MOVSX EAX,WORD PTR DS:[EAX+2]
0048D1C6   80E2 01          AND DL,1
0048D1C9   F6C1 02          TEST CL,2
0048D1CC   885424 14        MOV BYTE PTR SS:[ESP+14],DL
0048D1D0   75 19            JNZ SHORT haloce.0048D1EB
0048D1D2   0FBFC8           MOVSX ECX,AX
0048D1D5   8B148D 18416200  MOV EDX,DWORD PTR DS:[ECX*4+624118]
0048D1DC   8B4C24 14        MOV ECX,DWORD PTR SS:[ESP+14]
0048D1E0   51               PUSH ECX
0048D1E1   57               PUSH EDI
0048D1E2   50               PUSH EAX
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F60A0   haloce.0047D6C0   4
->
0047D6C0   0FBF4424 04      MOVSX EAX,WORD PTR SS:[ESP+4]
0047D6C5   8B0485 18416200  MOV EAX,DWORD PTR DS:[EAX*4+624118]
0047D6CC   8B4C24 0C        MOV ECX,DWORD PTR SS:[ESP+C]
0047D6D0   56               PUSH ESI
0047D6D1   8B7424 0C        MOV ESI,DWORD PTR SS:[ESP+C]
0047D6D5   51               PUSH ECX
0047D6D6   8D50 1C          LEA EDX,DWORD PTR DS:[EAX+1C]
0047D6D9   0FBF40 1A        MOVSX EAX,WORD PTR DS:[EAX+1A]
0047D6DD   52               PUSH EDX
0047D6DE   50               PUSH EAX
0047D6DF   56               PUSH ESI
0047D6E0   E8 BBFE0000      CALL haloce.0048D5A0
->
0048D5A0   8B4C24 04        MOV ECX,DWORD PTR SS:[ESP+4]
0048D5A4   53               PUSH EBX
0048D5A5   81E1 FFFF0000    AND ECX,0FFFF
0048D5AB   69C9 18020000    IMUL ECX,ECX,218
0048D5B1   55               PUSH EBP
0048D5B2   8B6C24 10        MOV EBP,DWORD PTR SS:[ESP+10]
0048D5B6   56               PUSH ESI
0048D5B7   57               PUSH EDI
0048D5B8   8B3D B0558100    MOV EDI,DWORD PTR DS:[8155B0] ;hs thread
0048D5BE   8B47 34          MOV EAX,DWORD PTR DS:[EDI+34]
0048D5C1   8B7408 10        MOV ESI,DWORD PTR DS:[EAX+ECX+10]
0048D5C5   8D5408 10        LEA EDX,DWORD PTR DS:[EAX+ECX+10]
0048D5C9   33DB             XOR EBX,EBX
0048D5CB   66:8B5E 0C       MOV BX,WORD PTR DS:[ESI+C]
0048D5CF   0FBFC3           MOVSX EAX,BX
0048D5D2   8D4430 0E        LEA EAX,DWORD PTR DS:[EAX+ESI+E]
0048D5D6   8D1CAB           LEA EBX,DWORD PTR DS:[EBX+EBP*4]
0048D5D9   66:895E 0C       MOV WORD PTR DS:[ESI+C],BX
0048D5DD   8B77 34          MOV ESI,DWORD PTR DS:[EDI+34]
0048D5E0   8B740E 10        MOV ESI,DWORD PTR DS:[ESI+ECX+10]
0048D5E4   33DB             XOR EBX,EBX
0048D5E6   66:8B5E 0C       MOV BX,WORD PTR DS:[ESI+C]
0048D5EA   0FBFEB           MOVSX EBP,BX
0048D5ED   8D6C2E 0E        LEA EBP,DWORD PTR DS:[ESI+EBP+E]
0048D5F1   83C3 02          ADD EBX,2
0048D5F4   66:895E 0C       MOV WORD PTR DS:[ESI+C],BX
0048D5F8   8B77 34          MOV ESI,DWORD PTR DS:[EDI+34]
0048D5FB   8B4C0E 10        MOV ECX,DWORD PTR DS:[ESI+ECX+10]
0048D5FF   8B1D B4558100    MOV EBX,DWORD PTR DS:[8155B4] ;script node
0048D605   33F6             XOR ESI,ESI
0048D607   66:8B71 0C       MOV SI,WORD PTR DS:[ECX+C]
0048D60B   0FBFFE           MOVSX EDI,SI
0048D60E   8D7C0F 0E        LEA EDI,DWORD PTR DS:[EDI+ECX+E]
0048D612   83C6 04          ADD ESI,4
0048D615   66:8971 0C       MOV WORD PTR DS:[ECX+C],SI
0048D619   8A4C24 20        MOV CL,BYTE PTR SS:[ESP+20]
0048D61D   84C9             TEST CL,CL
0048D61F   74 2A            JE SHORT haloce.0048D64B
0048D621   66:C745 00 0000  MOV WORD PTR SS:[EBP],0
0048D627   8B0A             MOV ECX,DWORD PTR DS:[EDX]
0048D629   8B49 04          MOV ECX,DWORD PTR DS:[ECX+4]
0048D62C   8B73 34          MOV ESI,DWORD PTR DS:[EBX+34]
0048D62F   81E1 FFFF0000    AND ECX,0FFFF
0048D635   8D1489           LEA EDX,DWORD PTR DS:[ECX+ECX*4]
0048D638   8B4C96 10        MOV ECX,DWORD PTR DS:[ESI+EDX*4+10]
0048D63C   81E1 FFFF0000    AND ECX,0FFFF
0048D642   8D0C89           LEA ECX,DWORD PTR DS:[ECX+ECX*4]
0048D645   8B548E 08        MOV EDX,DWORD PTR DS:[ESI+ECX*4+8]
0048D649   8917             MOV DWORD PTR DS:[EDI],EDX
0048D64B   66:8B4D 00       MOV CX,WORD PTR SS:[EBP]
0048D64F   66:3B4C24 18     CMP CX,WORD PTR SS:[ESP+18]
0048D654   7D 4E            JGE SHORT haloce.0048D6A4
0048D656   8B17             MOV EDX,DWORD PTR DS:[EDI]
0048D658   8B5B 34          MOV EBX,DWORD PTR DS:[EBX+34]
0048D65B   0FBFF1           MOVSX ESI,CX
0048D65E   8BCA             MOV ECX,EDX
0048D660   81E1 FFFF0000    AND ECX,0FFFF
0048D666   8D0C89           LEA ECX,DWORD PTR DS:[ECX+ECX*4]
0048D669   66:8B4C8B 04     MOV CX,WORD PTR DS:[EBX+ECX*4+4]
0048D66E   8B5C24 1C        MOV EBX,DWORD PTR SS:[ESP+1C]
0048D672   66:3B0C73        CMP CX,WORD PTR DS:[EBX+ESI*2]
0048D676   75 2C            JNZ SHORT haloce.0048D6A4
0048D678   8D1CB0           LEA EBX,DWORD PTR DS:[EAX+ESI*4]
0048D67B   8BC2             MOV EAX,EDX
0048D67D   8B5424 14        MOV EDX,DWORD PTR SS:[ESP+14]
0048D681   E8 2AFCFFFF      CALL haloce.0048D2B0
->
0048D2B0   55               PUSH EBP
0048D2B1   8B2D B0558100    MOV EBP,DWORD PTR DS:[8155B0] ;hs thread
0048D2B7   56               PUSH ESI
0048D2B8   8B35 B4558100    MOV ESI,DWORD PTR DS:[8155B4] ;script node
0048D2BE   8B76 34          MOV ESI,DWORD PTR DS:[ESI+34]
0048D2C1   81E2 FFFF0000    AND EDX,0FFFF
0048D2C7   57               PUSH EDI
0048D2C8   69D2 18020000    IMUL EDX,EDX,218
0048D2CE   8BF8             MOV EDI,EAX
0048D2D0   8B45 34          MOV EAX,DWORD PTR SS:[EBP+34]
0048D2D3   8BCF             MOV ECX,EDI
0048D2D5   81E1 FFFF0000    AND ECX,0FFFF
0048D2DB   8D0C89           LEA ECX,DWORD PTR DS:[ECX+ECX*4]
0048D2DE   8D348E           LEA ESI,DWORD PTR DS:[ESI+ECX*4]
0048D2E1   8A4E 06          MOV CL,BYTE PTR DS:[ESI+6]
0048D2E4   03C2             ADD EAX,EDX
0048D2E6   F6C1 01          TEST CL,1
0048D2E9   74 65            JE SHORT haloce.0048D350
...
0048D350   8B48 10          MOV ECX,DWORD PTR DS:[EAX+10]
0048D353   8959 08          MOV DWORD PTR DS:[ECX+8],EBX
0048D356   8B4D 34          MOV ECX,DWORD PTR SS:[EBP+34]
0048D359   03CA             ADD ECX,EDX
0048D35B   8B51 10          MOV EDX,DWORD PTR DS:[ECX+10]
0048D35E   0FBF72 0C        MOVSX ESI,WORD PTR DS:[EDX+C]
0048D362   8D7416 10        LEA ESI,DWORD PTR DS:[ESI+EDX+10]
0048D366   8916             MOV DWORD PTR DS:[ESI],EDX
0048D368   8971 10          MOV DWORD PTR DS:[ECX+10],ESI
0048D36B   66:C746 0C 0000  MOV WORD PTR DS:[ESI+C],0
0048D371   8A48 03          MOV CL,BYTE PTR DS:[EAX+3]
0048D374   8B50 10          MOV EDX,DWORD PTR DS:[EAX+10]
0048D377   80C9 01          OR CL,1
0048D37A   8848 03          MOV BYTE PTR DS:[EAX+3],CL
0048D37D   897A 04          MOV DWORD PTR DS:[EDX+4],EDI
0048D380   5F               POP EDI
0048D381   5E               POP ESI
0048D382   5D               POP EBP
0048D383   C3               RETN
<-
0048D686   8B07             MOV EAX,DWORD PTR DS:[EDI]
0048D688   25 FFFF0000      AND EAX,0FFFF
0048D68D   8D1480           LEA EDX,DWORD PTR DS:[EAX+EAX*4]
0048D690   A1 B4558100      MOV EAX,DWORD PTR DS:[8155B4] ;script node
0048D695   8B48 34          MOV ECX,DWORD PTR DS:[EAX+34]
0048D698   8B5491 08        MOV EDX,DWORD PTR DS:[ECX+EDX*4+8]
0048D69C   8917             MOV DWORD PTR DS:[EDI],EDX
0048D69E   66:FF45 00       INC WORD PTR SS:[EBP]
0048D6A2   33C0             XOR EAX,EAX
0048D6A4   5F               POP EDI
0048D6A5   5E               POP ESI
0048D6A6   5D               POP EBP
0048D6A7   5B               POP EBX
0048D6A8   C3               RETN
<-
0047D6E5   83C4 10          ADD ESP,10
0047D6E8   85C0             TEST EAX,EAX
0047D6EA   74 13            JE SHORT haloce.0047D6FF
...
0047D6FF   5E               POP ESI                                  ; 403D8500
0047D700   C3               RETN
<-

...5
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F5EA4   haloce.0047D1D0
->
0047D1D0   E8 ABD10000      CALL haloce.0048A380
->
0048A380   51               PUSH ECX   ;403DB501
0048A381   8B15 A4558100    MOV EDX,DWORD PTR DS:[8155A4] ;object list header
0048A387   55               PUSH EBP ;0
0048A388   56               PUSH ESI ;403DB500
0048A389   57               PUSH EDI ;F3690000
0048A38A   E8 31960400      CALL haloce.004D39C0
->
004D39C0   0FBF4A 22        MOVSX ECX,WORD PTR DS:[EDX+22] ;ItemSize
004D39C4   53               PUSH EBX
004D39C5   66:8B5A 2C       MOV BX,WORD PTR DS:[EDX+2C] ;last index?
004D39C9   55               PUSH EBP
004D39CA   8B6A 34          MOV EBP,DWORD PTR DS:[EDX+34] ;first object
004D39CD   56               PUSH ESI
004D39CE   0FBFF3           MOVSX ESI,BX
004D39D1   0FAFF1           IMUL ESI,ECX
004D39D4   83C8 FF          OR EAX,FFFFFFFF ;-1
004D39D7   03F5             ADD ESI,EBP
004D39D9   66:3B5A 20       CMP BX,WORD PTR DS:[EDX+20] ;MaxItems
004D39DD   7D 60            JGE SHORT haloce.004D3A3F
004D39DF   90               NOP
004D39E0   66:833E 00       /CMP WORD PTR DS:[ESI],0
004D39E4   74 0D            |JE SHORT haloce.004D39F3
...
004D39F3   8BE9             MOV EBP,ECX
004D39F5   C1E9 02          SHR ECX,2
004D39F8   57               PUSH EDI
004D39F9   33C0             XOR EAX,EAX
004D39FB   8BFE             MOV EDI,ESI
004D39FD   F3:AB            REP STOS DWORD PTR ES:[EDI]
004D39FF   8BCD             MOV ECX,EBP
004D3A01   83E1 03          AND ECX,3
004D3A04   F3:AA            REP STOS BYTE PTR ES:[EDI]
004D3A06   66:8B42 32       MOV AX,WORD PTR DS:[EDX+32] ;NextItemID
004D3A0A   66:8906          MOV WORD PTR DS:[ESI],AX
004D3A0D   66:FF42 32       INC WORD PTR DS:[EDX+32]
004D3A11   66:837A 32 00    CMP WORD PTR DS:[EDX+32],0 
004D3A16   5F               POP EDI
004D3A17   75 06            JNZ SHORT haloce.004D3A1F
...
004D3A1F   66:FF42 30       INC WORD PTR DS:[EDX+30] ;NextItemIndex
004D3A23   66:395A 2E       CMP WORD PTR DS:[EDX+2E],BX ;NumOfItems
004D3A27   8D43 01          LEA EAX,DWORD PTR DS:[EBX+1]
004D3A2A   66:8942 2C       MOV WORD PTR DS:[EDX+2C],AX
004D3A2E   7F 04            JG SHORT haloce.004D3A34
004D3A30   66:8942 2E       MOV WORD PTR DS:[EDX+2E],AX
004D3A34   0FBF06           MOVSX EAX,WORD PTR DS:[ESI] ;FFFFE26F
004D3A37   0FBFCB           MOVSX ECX,BX
004D3A3A   C1E0 10          SHL EAX,10 ;E26F0000
004D3A3D   0BC1             OR EAX,ECX
004D3A3F   5E               POP ESI
004D3A40   5D               POP EBP
004D3A41   5B               POP EBX
004D3A42   C3               RETN
<-
0048A38F   8BF0             MOV ESI,EAX
0048A391   83FE FF          CMP ESI,-1
0048A394   897424 0C        MOV DWORD PTR SS:[ESP+C],ESI
0048A398   74 1B            JE SHORT haloce.0048A3B5
0048A39A   8B4A 34          MOV ECX,DWORD PTR DS:[EDX+34] ;first object in object list header
0048A39D   25 FFFF0000      AND EAX,0FFFF ;EAX=0
0048A3A2   8D0440           LEA EAX,DWORD PTR DS:[EAX+EAX*2]
0048A3A5   8D0481           LEA EAX,DWORD PTR DS:[ECX+EAX*4]
0048A3A8   66:C740 06 0000  MOV WORD PTR DS:[EAX+6],0 ;write to object
0048A3AE   C740 08 FFFFFFFF MOV DWORD PTR DS:[EAX+8],-1 ;write to object
0048A3B5   8B2D C0558100    MOV EBP,DWORD PTR DS:[8155C0] ;players
0048A3BB   83CA FF          OR EDX,FFFFFFFF
0048A3BE   8BFD             MOV EDI,EBP
0048A3C0   E8 AB970400      CALL haloce.004D3B70
->;get static player index
004D3B70   83C8 FF          OR EAX,FFFFFFFF
004D3B73   42               INC EDX
004D3B74   66:85D2          TEST DX,DX
004D3B77   7C 3B            JL SHORT haloce.004D3BB4
004D3B79   53               PUSH EBX
004D3B7A   66:8B5F 2E       MOV BX,WORD PTR DS:[EDI+2E]
004D3B7E   66:3BD3          CMP DX,BX
004D3B81   7D 30            JGE SHORT haloce.004D3BB3
004D3B83   55               PUSH EBP
004D3B84   8B6F 34          MOV EBP,DWORD PTR DS:[EDI+34]
004D3B87   56               PUSH ESI
004D3B88   0FBF77 22        MOVSX ESI,WORD PTR DS:[EDI+22]
004D3B8C   0FBFCA           MOVSX ECX,DX
004D3B8F   0FAFCE           IMUL ECX,ESI
004D3B92   03CD             ADD ECX,EBP ;ECX=static_player
004D3B94   66:8339 00       /CMP WORD PTR DS:[ECX],0 ;test player ID
004D3B98   75 0C            |JNZ SHORT haloce.004D3BA6
004D3B9A   42               |INC EDX
004D3B9B   03CE             |ADD ECX,ESI
004D3B9D   66:3BD3          |CMP DX,BX
004D3BA0  ^7C F2            \JL SHORT haloce.004D3B94
004D3BA2   5E               ;POP ESI
004D3BA3   5D               ;POP EBP
004D3BA4   5B               ;POP EBX
004D3BA5   C3               ;RETN
004D3BA6   0FBF01           MOVSX EAX,WORD PTR DS:[ECX]
004D3BA9   0FBFCA           MOVSX ECX,DX
004D3BAC   C1E0 10          SHL EAX,10
004D3BAF   5E               POP ESI
004D3BB0   0BC1             OR EAX,ECX
004D3BB2   5D               POP EBP
004D3BB3   5B               POP EBX
004D3BB4   C3               RETN
<-;ret
0048A3C5   8BF8             MOV EDI,EAX
0048A3C7   83FF FF          CMP EDI,-1 ;make sure its a valid ID
0048A3CA   0F84 C7000000    JE haloce.0048A497
0048A3CA   0F84 C7000000    JE haloce.0048A497
0048A3D0   53               PUSH EBX
0048A3D1   EB 0D            JMP SHORT haloce.0048A3E0
...
0048A3E0   8B4D 34          MOV ECX,DWORD PTR SS:[EBP+34] ;first obj in static player array
0048A3E3   8BC7             MOV EAX,EDI
0048A3E5   25 FFFF0000      AND EAX,0FFFF
0048A3EA   C1E0 09          SHL EAX,9
0048A3ED   8B5C08 34        MOV EBX,DWORD PTR DS:[EAX+ECX+34] ;get player obj index
0048A3F1   03C1             ADD EAX,ECX
0048A3F3   83FB FF          CMP EBX,-1 ;test obj player index
0048A3F6   74 4C            JE SHORT haloce.0048A444
0048A3F8   8BC6             MOV EAX,ESI
0048A3FA   25 FFFF0000      AND EAX,0FFFF
0048A3FF   8D1440           LEA EDX,DWORD PTR DS:[EAX+EAX*2]
0048A402   A1 A4558100      MOV EAX,DWORD PTR DS:[8155A4] ;object list header
0048A407   8B48 34          MOV ECX,DWORD PTR DS:[EAX+34] ;ptr to first obj
0048A40A   8D3491           LEA ESI,DWORD PTR DS:[ECX+EDX*4]
0048A40D   8B15 A8558100    MOV EDX,DWORD PTR DS:[8155A8] ;list object reference
0048A413   E8 A8950400      CALL haloce.004D39C0
->
004D39C0   0FBF4A 22        MOVSX ECX,WORD PTR DS:[EDX+22]
004D39C4   53               PUSH EBX
004D39C5   66:8B5A 2C       MOV BX,WORD PTR DS:[EDX+2C]
004D39C9   55               PUSH EBP
004D39CA   8B6A 34          MOV EBP,DWORD PTR DS:[EDX+34]
004D39CD   56               PUSH ESI
004D39CE   0FBFF3           MOVSX ESI,BX
004D39D1   0FAFF1           IMUL ESI,ECX
004D39D4   83C8 FF          OR EAX,FFFFFFFF
004D39D7   03F5             ADD ESI,EBP
004D39D9   66:3B5A 20       CMP BX,WORD PTR DS:[EDX+20]
004D39DD   7D 60            JGE SHORT haloce.004D3A3F
004D39DF   90               NOP
...
004D39E0   66:833E 00       /CMP WORD PTR DS:[ESI],0
004D39E4   74 0D            |JE SHORT haloce.004D39F3
...
004D39F3   8BE9             MOV EBP,ECX
004D39F5   C1E9 02          SHR ECX,2
004D39F8   57               PUSH EDI
004D39F9   33C0             XOR EAX,EAX
004D39FB   8BFE             MOV EDI,ESI
004D39FD   F3:AB            REP STOS DWORD PTR ES:[EDI]
004D39FF   8BCD             MOV ECX,EBP
004D3A01   83E1 03          AND ECX,3
004D3A04   F3:AA            REP STOS BYTE PTR ES:[EDI]
004D3A06   66:8B42 32       MOV AX,WORD PTR DS:[EDX+32]
004D3A0A   66:8906          MOV WORD PTR DS:[ESI],AX
004D3A0D   66:FF42 32       INC WORD PTR DS:[EDX+32]  ;inc NextItemID in list object reference
004D3A11   66:837A 32 00    CMP WORD PTR DS:[EDX+32],0
004D3A16   5F               POP EDI
004D3A17   75 06            JNZ SHORT haloce.004D3A1F
...
004D3A1F   66:FF42 30       INC WORD PTR DS:[EDX+30]
004D3A23   66:395A 2E       CMP WORD PTR DS:[EDX+2E],BX
004D3A27   8D43 01          LEA EAX,DWORD PTR DS:[EBX+1]
004D3A2A   66:8942 2C       MOV WORD PTR DS:[EDX+2C],AX
004D3A2E   7F 04            JG SHORT haloce.004D3A34
004D3A30   66:8942 2E       MOV WORD PTR DS:[EDX+2E],AX
004D3A34   0FBF06           MOVSX EAX,WORD PTR DS:[ESI]
004D3A37   0FBFCB           MOVSX ECX,BX
004D3A3A   C1E0 10          SHL EAX,10
004D3A3D   0BC1             OR EAX,ECX
004D3A3F   5E               POP ESI
004D3A40   5D               POP EBP
004D3A41   5B               POP EBX
004D3A42   C3               RETN
<-
0048A418   83F8 FF          CMP EAX,-1
0048A41B   74 23            JE SHORT haloce.0048A440
0048A41D   8BC8             MOV ECX,EAX
0048A41F   81E1 FFFF0000    AND ECX,0FFFF
0048A425   8D1449           LEA EDX,DWORD PTR DS:[ECX+ECX*2]
0048A428   8B0D A8558100    MOV ECX,DWORD PTR DS:[8155A8] ;list object reference
0048A42E   8B49 34          MOV ECX,DWORD PTR DS:[ECX+34]
0048A431   8D0C91           LEA ECX,DWORD PTR DS:[ECX+EDX*4]
0048A434   8959 04          MOV DWORD PTR DS:[ECX+4],EBX ;copy player obj index here
0048A437   8B56 08          MOV EDX,DWORD PTR DS:[ESI+8]
0048A43A   8951 08          MOV DWORD PTR DS:[ECX+8],EDX
0048A43D   8946 08          MOV DWORD PTR DS:[ESI+8],EAX
0048A440   66:FF46 06       INC WORD PTR DS:[ESI+6]
0048A444   8D4F 01          LEA ECX,DWORD PTR DS:[EDI+1]
0048A447   83CB FF          OR EBX,FFFFFFFF
0048A44A   66:85C9          TEST CX,CX
0048A44D   7C 33            JL SHORT haloce.0048A482
0048A44F   66:8B55 2E       MOV DX,WORD PTR SS:[EBP+2E]
0048A453   66:3BCA          CMP CX,DX
0048A456   7D 2A            JGE SHORT haloce.0048A482
...
0048A482   83FB FF          CMP EBX,-1
0048A485   8BFB             MOV EDI,EBX
0048A487  ^0F85 46FFFFFF    JNZ haloce.0048A3D3
0048A48D   8B4424 10        MOV EAX,DWORD PTR SS:[ESP+10]
0048A491   5B               POP EBX
0048A492   5F               POP EDI
0048A493   5E               POP ESI
0048A494   5D               POP EBP
0048A495   59               POP ECX
0048A496   C3               RETN
<-
0047D1D5   8B4C24 08        MOV ECX,DWORD PTR SS:[ESP+8]
0047D1D9   E9 B2010100      JMP haloce.0048D390
...
0048D390   81E1 FFFF0000    AND ECX,0FFFF
0048D396   56               PUSH ESI
0048D397   8BF1             MOV ESI,ECX
0048D399   8B0D B0558100    MOV ECX,DWORD PTR DS:[8155B0] ;hs thread
0048D39F   69F6 18020000    IMUL ESI,ESI,218
0048D3A5   57               PUSH EDI
0048D3A6   8B79 34          MOV EDI,DWORD PTR DS:[ECX+34]
0048D3A9   8B5437 10        MOV EDX,DWORD PTR DS:[EDI+ESI+10]
0048D3AD   8B4A 04          MOV ECX,DWORD PTR DS:[EDX+4]
0048D3B0   8B15 B4558100    MOV EDX,DWORD PTR DS:[8155B4] ;script node
0048D3B6   8B52 34          MOV EDX,DWORD PTR DS:[EDX+34]
0048D3B9   03FE             ADD EDI,ESI
0048D3BB   81E1 FFFF0000    AND ECX,0FFFF
0048D3C1   8D0C89           LEA ECX,DWORD PTR DS:[ECX+ECX*4]
0048D3C4   8D0C8A           LEA ECX,DWORD PTR DS:[EDX+ECX*4]
0048D3C7   F641 06 02       TEST BYTE PTR DS:[ECX+6],2
0048D3CB   0FBF51 02        MOVSX EDX,WORD PTR DS:[ECX+2]
0048D3CF   75 0C            JNZ SHORT haloce.0048D3DD
0048D3D1   8B1495 18416200  MOV EDX,DWORD PTR DS:[EDX*4+624118]
0048D3D8   66:8B12          MOV DX,WORD PTR DS:[EDX]
0048D3DB   EB 16            JMP SHORT haloce.0048D3F3
...
0048D3F3   66:8B49 04       MOV CX,WORD PTR DS:[ECX+4]
0048D3F7   66:3BD1          CMP DX,CX
0048D3FA   74 47            JE SHORT haloce.0048D443
...
0048D443   8B4F 10          MOV ECX,DWORD PTR DS:[EDI+10]
0048D446   8B11             MOV EDX,DWORD PTR DS:[ECX]
0048D448   8B4A 08          MOV ECX,DWORD PTR DS:[EDX+8]
0048D44B   8B15 B0558100    MOV EDX,DWORD PTR DS:[8155B0] ;hs thread
0048D451   8901             MOV DWORD PTR DS:[ECX],EAX
0048D453   8B42 34          MOV EAX,DWORD PTR DS:[EDX+34]
0048D456   8B4C30 10        MOV ECX,DWORD PTR DS:[EAX+ESI+10]
0048D45A   8B11             MOV EDX,DWORD PTR DS:[ECX]
0048D45C   03C6             ADD EAX,ESI
0048D45E   5F               POP EDI
0048D45F   8950 10          MOV DWORD PTR DS:[EAX+10],EDX
0048D462   5E               POP ESI
0048D463   C3               RETN
<-
0048D1E6   83C4 0C          ADD ESP,0C
0048D1E9   EB 53            JMP SHORT haloce.0048D23E
..
0048D23E   8B4E 10          MOV ECX,DWORD PTR DS:[ESI+10]
0048D241   8D46 18          LEA EAX,DWORD PTR DS:[ESI+18]
0048D244   3BC8             CMP ECX,EAX
0048D246  ^0F85 14FFFFFF    JNZ haloce.0048D160
...
0048D160   8B4E 08          MOV ECX,DWORD PTR DS:[ESI+8]
0048D163   85C9             TEST ECX,ECX
0048D165   0F8C E1000000    JL haloce.0048D24C
0048D16B   A1 90CD6800      MOV EAX,DWORD PTR DS:[68CD90]
0048D170   8038 00          CMP BYTE PTR DS:[EAX],0
0048D173   74 17            JE SHORT haloce.0048D18C
0048D175   8A50 01          MOV DL,BYTE PTR DS:[EAX+1]
0048D178   84D2             TEST DL,DL
0048D17A   75 07            JNZ SHORT haloce.0048D183
...
0048D183   3B48 0C          CMP ECX,DWORD PTR DS:[EAX+C]
0048D186   0F8F C0000000    JG haloce.0048D24C
0048D18C   A0 38C56400      MOV AL,BYTE PTR DS:[64C538]
0048D191   84C0             TEST AL,AL
0048D193   0F84 B3000000    JE haloce.0048D24C
0048D199   8B4E 10          MOV ECX,DWORD PTR DS:[ESI+10]
0048D19C   8B41 04          MOV EAX,DWORD PTR DS:[ECX+4]
0048D19F   25 FFFF0000      AND EAX,0FFFF
0048D1A4   8D1480           LEA EDX,DWORD PTR DS:[EAX+EAX*4]
0048D1A7   A1 B4558100      MOV EAX,DWORD PTR DS:[8155B4] ;script node
0048D1AC   8B40 34          MOV EAX,DWORD PTR DS:[EAX+34]
0048D1AF   8D0490           LEA EAX,DWORD PTR DS:[EAX+EDX*4]
0048D1B2   8A56 03          MOV DL,BYTE PTR DS:[ESI+3]
0048D1B5   66:C741 0C 0000  MOV WORD PTR DS:[ECX+C],0
0048D1BB   8066 03 FE       AND BYTE PTR DS:[ESI+3],0FE
0048D1BF   8A48 06          MOV CL,BYTE PTR DS:[EAX+6]
0048D1C2   0FBF40 02        MOVSX EAX,WORD PTR DS:[EAX+2]
0048D1C6   80E2 01          AND DL,1
0048D1C9   F6C1 02          TEST CL,2
0048D1CC   885424 14        MOV BYTE PTR SS:[ESP+14],DL
0048D1D0   75 19            JNZ SHORT haloce.0048D1EB
0048D1D0   75 19            JNZ SHORT haloce.0048D1EB
0048D1D2   0FBFC8           MOVSX ECX,AX
0048D1D5   8B148D 18416200  MOV EDX,DWORD PTR DS:[ECX*4+624118]
0048D1DC   8B4C24 14        MOV ECX,DWORD PTR SS:[ESP+14]
0048D1E0   51               PUSH ECX
0048D1E1   57               PUSH EDI
0048D1E2   50               PUSH EAX
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F60A0   haloce.0047D6C0
->
0047D6C0   0FBF4424 04      MOVSX EAX,WORD PTR SS:[ESP+4]
0047D6C5   8B0485 18416200  MOV EAX,DWORD PTR DS:[EAX*4+624118]
0047D6CC   8B4C24 0C        MOV ECX,DWORD PTR SS:[ESP+C]
0047D6D0   56               PUSH ESI
0047D6D1   8B7424 0C        MOV ESI,DWORD PTR SS:[ESP+C]
0047D6D5   51               PUSH ECX
0047D6D6   8D50 1C          LEA EDX,DWORD PTR DS:[EAX+1C]
0047D6D9   0FBF40 1A        MOVSX EAX,WORD PTR DS:[EAX+1A]
0047D6DD   52               PUSH EDX
0047D6DE   50               PUSH EAX
0047D6DF   56               PUSH ESI
0047D6E0   E8 BBFE0000      CALL haloce.0048D5A0
->
0048D5A0   8B4C24 04        MOV ECX,DWORD PTR SS:[ESP+4]
0048D5A4   53               PUSH EBX
0048D5A5   81E1 FFFF0000    AND ECX,0FFFF
0048D5AB   69C9 18020000    IMUL ECX,ECX,218
0048D5B1   55               PUSH EBP
0048D5B2   8B6C24 10        MOV EBP,DWORD PTR SS:[ESP+10]
0048D5B6   56               PUSH ESI
0048D5B7   57               PUSH EDI
0048D5B8   8B3D B0558100    MOV EDI,DWORD PTR DS:[8155B0] ;hs thread
0048D5BE   8B47 34          MOV EAX,DWORD PTR DS:[EDI+34]
0048D5C1   8B7408 10        MOV ESI,DWORD PTR DS:[EAX+ECX+10]
0048D5C5   8D5408 10        LEA EDX,DWORD PTR DS:[EAX+ECX+10]
0048D5C9   33DB             XOR EBX,EBX
0048D5CB   66:8B5E 0C       MOV BX,WORD PTR DS:[ESI+C]
0048D5CF   0FBFC3           MOVSX EAX,BX
0048D5D2   8D4430 0E        LEA EAX,DWORD PTR DS:[EAX+ESI+E]
0048D5D6   8D1CAB           LEA EBX,DWORD PTR DS:[EBX+EBP*4]
0048D5D9   66:895E 0C       MOV WORD PTR DS:[ESI+C],BX
0048D5DD   8B77 34          MOV ESI,DWORD PTR DS:[EDI+34]
0048D5E0   8B740E 10        MOV ESI,DWORD PTR DS:[ESI+ECX+10]
0048D5E4   33DB             XOR EBX,EBX
0048D5E6   66:8B5E 0C       MOV BX,WORD PTR DS:[ESI+C]
0048D5EA   0FBFEB           MOVSX EBP,BX
0048D5ED   8D6C2E 0E        LEA EBP,DWORD PTR DS:[ESI+EBP+E]
0048D5F1   83C3 02          ADD EBX,2
0048D5F4   66:895E 0C       MOV WORD PTR DS:[ESI+C],BX
0048D5F8   8B77 34          MOV ESI,DWORD PTR DS:[EDI+34]
0048D5FB   8B4C0E 10        MOV ECX,DWORD PTR DS:[ESI+ECX+10]
0048D5FF   8B1D B4558100    MOV EBX,DWORD PTR DS:[8155B4] ;script node
0048D605   33F6             XOR ESI,ESI
0048D607   66:8B71 0C       MOV SI,WORD PTR DS:[ECX+C]
0048D60B   0FBFFE           MOVSX EDI,SI
0048D60E   8D7C0F 0E        LEA EDI,DWORD PTR DS:[EDI+ECX+E]
0048D612   83C6 04          ADD ESI,4
0048D615   66:8971 0C       MOV WORD PTR DS:[ECX+C],SI
0048D619   8A4C24 20        MOV CL,BYTE PTR SS:[ESP+20]
0048D61D   84C9             TEST CL,CL
0048D61F   74 2A            JE SHORT haloce.0048D64B
...
0048D64B   66:8B4D 00       MOV CX,WORD PTR SS:[EBP]
0048D64F   66:3B4C24 18     CMP CX,WORD PTR SS:[ESP+18]
0048D654   7D 4E            JGE SHORT haloce.0048D6A4
0048D656   8B17             MOV EDX,DWORD PTR DS:[EDI]
0048D658   8B5B 34          MOV EBX,DWORD PTR DS:[EBX+34]
0048D65B   0FBFF1           MOVSX ESI,CX
0048D65E   8BCA             MOV ECX,EDX
0048D660   81E1 FFFF0000    AND ECX,0FFFF
0048D666   8D0C89           LEA ECX,DWORD PTR DS:[ECX+ECX*4]
0048D669   66:8B4C8B 04     MOV CX,WORD PTR DS:[EBX+ECX*4+4]
0048D66E   8B5C24 1C        MOV EBX,DWORD PTR SS:[ESP+1C]
0048D672   66:3B0C73        CMP CX,WORD PTR DS:[EBX+ESI*2]
0048D676   75 2C            JNZ SHORT haloce.0048D6A4
0048D678   8D1CB0           LEA EBX,DWORD PTR DS:[EAX+ESI*4]
0048D67B   8BC2             MOV EAX,EDX
0048D67D   8B5424 14        MOV EDX,DWORD PTR SS:[ESP+14]
0048D681   E8 2AFCFFFF      CALL haloce.0048D2B0
->
0048D2B0   55               PUSH EBP
0048D2B1   8B2D B0558100    MOV EBP,DWORD PTR DS:[8155B0] ;hs thread
0048D2B7   56               PUSH ESI
0048D2B8   8B35 B4558100    MOV ESI,DWORD PTR DS:[8155B4] ;script node
0048D2BE   8B76 34          MOV ESI,DWORD PTR DS:[ESI+34]
0048D2C1   81E2 FFFF0000    AND EDX,0FFFF
0048D2C7   57               PUSH EDI
0048D2C8   69D2 18020000    IMUL EDX,EDX,218
0048D2CE   8BF8             MOV EDI,EAX
0048D2D0   8B45 34          MOV EAX,DWORD PTR SS:[EBP+34]
0048D2D3   8BCF             MOV ECX,EDI
0048D2D5   81E1 FFFF0000    AND ECX,0FFFF
0048D2DB   8D0C89           LEA ECX,DWORD PTR DS:[ECX+ECX*4]
0048D2DE   8D348E           LEA ESI,DWORD PTR DS:[ESI+ECX*4]
0048D2E1   8A4E 06          MOV CL,BYTE PTR DS:[ESI+6]
0048D2E4   03C2             ADD EAX,EDX
0048D2E6   F6C1 01          TEST CL,1
0048D2E9   74 65            JE SHORT haloce.0048D350
0048D2EB   8AC1             MOV AL,CL
0048D2ED   A8 04            TEST AL,4
0048D2EF   74 49            JE SHORT haloce.0048D33A
...
0048D33A   8B46 10          MOV EAX,DWORD PTR DS:[ESI+10]
0048D33D   66:8B4E 04       MOV CX,WORD PTR DS:[ESI+4]
0048D341   66:8B56 02       MOV DX,WORD PTR DS:[ESI+2]
0048D345   E8 26070000      CALL haloce.0048DA70
->
0048DA70   66:3BD1          CMP DX,CX
0048DA73   74 45            JE SHORT haloce.0048DABA
...
0048DABA   C3               RETN
<-
0048D34A   5F               POP EDI                                  ; 403D9A72
0048D34B   5E               POP ESI
0048D34C   8903             MOV DWORD PTR DS:[EBX],EAX
0048D34E   5D               POP EBP
0048D34F   C3               RETN
<-
0048D686   8B07             MOV EAX,DWORD PTR DS:[EDI]
0048D688   25 FFFF0000      AND EAX,0FFFF
0048D68D   8D1480           LEA EDX,DWORD PTR DS:[EAX+EAX*4]
0048D690   A1 B4558100      MOV EAX,DWORD PTR DS:[8155B4] ;script node
0048D695   8B48 34          MOV ECX,DWORD PTR DS:[EAX+34]
0048D698   8B5491 08        MOV EDX,DWORD PTR DS:[ECX+EDX*4+8]
0048D69C   8917             MOV DWORD PTR DS:[EDI],EDX
0048D69E   66:FF45 00       INC WORD PTR SS:[EBP]
0048D6A2   33C0             XOR EAX,EAX
0048D6A4   5F               POP EDI
0048D6A5   5E               POP ESI
0048D6A6   5D               POP EBP
0048D6A7   5B               POP EBX
0048D6A8   C3               RETN
<-
0047D6E5   83C4 10          ADD ESP,10
0047D6E8   85C0             TEST EAX,EAX
0047D6EA   74 13            JE SHORT haloce.0047D6FF
...
0047D6FF   5E               POP ESI                                  ; 403D99F0
0047D700   C3               RETN
<-
0048D1E6   83C4 0C          ADD ESP,0C
0048D1E9   EB 53            JMP SHORT haloce.0048D23E
...
0048D23E   8B4E 10          MOV ECX,DWORD PTR DS:[ESI+10]
0048D241   8D46 18          LEA EAX,DWORD PTR DS:[ESI+18]
0048D244   3BC8             CMP ECX,EAX
0048D246  ^0F85 14FFFFFF    JNZ haloce.0048D160
...
0048D160   8B4E 08          MOV ECX,DWORD PTR DS:[ESI+8]
0048D163   85C9             TEST ECX,ECX
0048D165   0F8C E1000000    JL haloce.0048D24C
0048D16B   A1 90CD6800      MOV EAX,DWORD PTR DS:[68CD90]
0048D170   8038 00          CMP BYTE PTR DS:[EAX],0
0048D173   74 17            JE SHORT haloce.0048D18C
0048D175   8A50 01          MOV DL,BYTE PTR DS:[EAX+1]
0048D178   84D2             TEST DL,DL
0048D17A   75 07            JNZ SHORT haloce.0048D183
...
0048D183   3B48 0C          CMP ECX,DWORD PTR DS:[EAX+C]
0048D186   0F8F C0000000    JG haloce.0048D24C
0048D18C   A0 38C56400      MOV AL,BYTE PTR DS:[64C538]
0048D191   84C0             TEST AL,AL
0048D193   0F84 B3000000    JE haloce.0048D24C
0048D199   8B4E 10          MOV ECX,DWORD PTR DS:[ESI+10]
0048D19C   8B41 04          MOV EAX,DWORD PTR DS:[ECX+4]
0048D19F   25 FFFF0000      AND EAX,0FFFF
0048D1A4   8D1480           LEA EDX,DWORD PTR DS:[EAX+EAX*4]
0048D1A7   A1 B4558100      MOV EAX,DWORD PTR DS:[8155B4] ;script node
0048D1AC   8B40 34          MOV EAX,DWORD PTR DS:[EAX+34]
0048D1AF   8D0490           LEA EAX,DWORD PTR DS:[EAX+EDX*4]
0048D1B2   8A56 03          MOV DL,BYTE PTR DS:[ESI+3]
0048D1B5   66:C741 0C 0000  MOV WORD PTR DS:[ECX+C],0
0048D1BB   8066 03 FE       AND BYTE PTR DS:[ESI+3],0FE
0048D1BF   8A48 06          MOV CL,BYTE PTR DS:[EAX+6]
0048D1C2   0FBF40 02        MOVSX EAX,WORD PTR DS:[EAX+2]
0048D1C6   80E2 01          AND DL,1
0048D1C9   F6C1 02          TEST CL,2
0048D1CC   885424 14        MOV BYTE PTR SS:[ESP+14],DL
0048D1D0   75 19            JNZ SHORT haloce.0048D1EB
0048D1D2   0FBFC8           MOVSX ECX,AX
0048D1D5   8B148D 18416200  MOV EDX,DWORD PTR DS:[ECX*4+624118]
0048D1DC   8B4C24 14        MOV ECX,DWORD PTR SS:[ESP+14]
0048D1E0   51               PUSH ECX
0048D1E1   57               PUSH EDI
0048D1E2   50               PUSH EAX
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F60A0
->
0047D6C0   0FBF4424 04      MOVSX EAX,WORD PTR SS:[ESP+4]
0047D6C5   8B0485 18416200  MOV EAX,DWORD PTR DS:[EAX*4+624118]
0047D6CC   8B4C24 0C        MOV ECX,DWORD PTR SS:[ESP+C]
0047D6D0   56               PUSH ESI
0047D6D1   8B7424 0C        MOV ESI,DWORD PTR SS:[ESP+C]
0047D6D5   51               PUSH ECX
0047D6D6   8D50 1C          LEA EDX,DWORD PTR DS:[EAX+1C]
0047D6D9   0FBF40 1A        MOVSX EAX,WORD PTR DS:[EAX+1A]
0047D6DD   52               PUSH EDX
0047D6DE   50               PUSH EAX
0047D6DF   56               PUSH ESI
0047D6E0   E8 BBFE0000      CALL haloce.0048D5A0
->
0048D5A0   8B4C24 04        MOV ECX,DWORD PTR SS:[ESP+4]
0048D5A4   53               PUSH EBX
0048D5A5   81E1 FFFF0000    AND ECX,0FFFF
0048D5AB   69C9 18020000    IMUL ECX,ECX,218
0048D5B1   55               PUSH EBP
0048D5B2   8B6C24 10        MOV EBP,DWORD PTR SS:[ESP+10]
0048D5B6   56               PUSH ESI
0048D5B7   57               PUSH EDI
0048D5B8   8B3D B0558100    MOV EDI,DWORD PTR DS:[8155B0] ;hs thread
0048D5BE   8B47 34          MOV EAX,DWORD PTR DS:[EDI+34]
0048D5C1   8B7408 10        MOV ESI,DWORD PTR DS:[EAX+ECX+10]
0048D5C5   8D5408 10        LEA EDX,DWORD PTR DS:[EAX+ECX+10]
0048D5C9   33DB             XOR EBX,EBX
0048D5CB   66:8B5E 0C       MOV BX,WORD PTR DS:[ESI+C]
0048D5CF   0FBFC3           MOVSX EAX,BX
0048D5D2   8D4430 0E        LEA EAX,DWORD PTR DS:[EAX+ESI+E]
0048D5D6   8D1CAB           LEA EBX,DWORD PTR DS:[EBX+EBP*4]
0048D5D9   66:895E 0C       MOV WORD PTR DS:[ESI+C],BX
0048D5DD   8B77 34          MOV ESI,DWORD PTR DS:[EDI+34]
0048D5E0   8B740E 10        MOV ESI,DWORD PTR DS:[ESI+ECX+10]
0048D5E4   33DB             XOR EBX,EBX
0048D5E6   66:8B5E 0C       MOV BX,WORD PTR DS:[ESI+C]
0048D5EA   0FBFEB           MOVSX EBP,BX
0048D5ED   8D6C2E 0E        LEA EBP,DWORD PTR DS:[ESI+EBP+E]
0048D5F1   83C3 02          ADD EBX,2
0048D5F4   66:895E 0C       MOV WORD PTR DS:[ESI+C],BX
0048D5F8   8B77 34          MOV ESI,DWORD PTR DS:[EDI+34]
0048D5FB   8B4C0E 10        MOV ECX,DWORD PTR DS:[ESI+ECX+10]
0048D5FF   8B1D B4558100    MOV EBX,DWORD PTR DS:[8155B4] ;script node
0048D605   33F6             XOR ESI,ESI
0048D607   66:8B71 0C       MOV SI,WORD PTR DS:[ECX+C]
0048D60B   0FBFFE           MOVSX EDI,SI
0048D60E   8D7C0F 0E        LEA EDI,DWORD PTR DS:[EDI+ECX+E]
0048D612   83C6 04          ADD ESI,4
0048D615   66:8971 0C       MOV WORD PTR DS:[ECX+C],SI
0048D619   8A4C24 20        MOV CL,BYTE PTR SS:[ESP+20]
0048D61D   84C9             TEST CL,CL
0048D61F   74 2A            JE SHORT haloce.0048D64B
...
0048D64B   66:8B4D 00       MOV CX,WORD PTR SS:[EBP]
0048D64F   66:3B4C24 18     CMP CX,WORD PTR SS:[ESP+18]
0048D654   7D 4E            JGE SHORT haloce.0048D6A4
...
0048D6A4   5F               POP EDI
0048D6A5   5E               POP ESI
0048D6A6   5D               POP EBP
0048D6A7   5B               POP EBX
0048D6A8   C3               RETN
<-
0047D6E5   83C4 10          ADD ESP,10
0047D6E8   85C0             TEST EAX,EAX
0047D6EA   74 13            JE SHORT haloce.0047D6FF
0047D6EC   66:8B48 04       MOV CX,WORD PTR DS:[EAX+4]
0047D6F0   8B00             MOV EAX,DWORD PTR DS:[EAX]
0047D6F2   E8 C9DB0000      CALL haloce.0048B2C0
->
0048B2C0   51               PUSH ECX
0048B2C1   56               PUSH ESI
0048B2C2   8B35 A8558100    MOV ESI,DWORD PTR DS:[8155A8] ;list object reference
0048B2C8   83CA FF          OR EDX,FFFFFFFF
0048B2CB   83F8 FF          CMP EAX,-1
0048B2CE   57               PUSH EDI
0048B2CF   8BF9             MOV EDI,ECX
0048B2D1   74 3A            JE SHORT haloce.0048B30D
0048B2D3   8B0D A4558100    MOV ECX,DWORD PTR DS:[8155A4] ;object list header
0048B2D9   8B51 34          MOV EDX,DWORD PTR DS:[ECX+34]
0048B2DC   25 FFFF0000      AND EAX,0FFFF
0048B2E1   8D0440           LEA EAX,DWORD PTR DS:[EAX+EAX*2]
0048B2E4   8B4C82 08        MOV ECX,DWORD PTR DS:[EDX+EAX*4+8]
0048B2E8   83F9 FF          CMP ECX,-1
0048B2EB   74 19            JE SHORT haloce.0048B306
0048B2ED   81E1 FFFF0000    AND ECX,0FFFF
0048B2F3   8D0449           LEA EAX,DWORD PTR DS:[ECX+ECX*2]
0048B2F6   8B4E 34          MOV ECX,DWORD PTR DS:[ESI+34]
0048B2F9   8D0481           LEA EAX,DWORD PTR DS:[ECX+EAX*4]
0048B2FC   8B48 08          MOV ECX,DWORD PTR DS:[EAX+8]
0048B2FF   8B40 04          MOV EAX,DWORD PTR DS:[EAX+4]
0048B302   8BD0             MOV EDX,EAX
0048B304   EB 0B            JMP SHORT haloce.0048B311
...
0048B311   66:85FF          TEST DI,DI
0048B314   8BC2             MOV EAX,EDX
0048B316   7E 2C            JLE SHORT haloce.0048B344
...
0048B344   5F               POP EDI
0048B345   5E               POP ESI
0048B346   59               POP ECX
0048B347   C3               RETN
<-
0047D6F7   8BCE             MOV ECX,ESI
0047D6F9   5E               POP ESI
0047D6FA   E9 91FC0000      JMP haloce.0048D390
...
0048D390   81E1 FFFF0000    AND ECX,0FFFF
0048D396   56               PUSH ESI
0048D397   8BF1             MOV ESI,ECX
0048D399   8B0D B0558100    MOV ECX,DWORD PTR DS:[8155B0] ;hs thread
0048D39F   69F6 18020000    IMUL ESI,ESI,218 
0048D3A5   57               PUSH EDI
0048D3A6   8B79 34          MOV EDI,DWORD PTR DS:[ECX+34]
0048D3A9   8B5437 10        MOV EDX,DWORD PTR DS:[EDI+ESI+10]
0048D3AD   8B4A 04          MOV ECX,DWORD PTR DS:[EDX+4]
0048D3B0   8B15 B4558100    MOV EDX,DWORD PTR DS:[8155B4] ;script node
0048D3B6   8B52 34          MOV EDX,DWORD PTR DS:[EDX+34]
0048D3B9   03FE             ADD EDI,ESI
0048D3BB   81E1 FFFF0000    AND ECX,0FFFF
0048D3C1   8D0C89           LEA ECX,DWORD PTR DS:[ECX+ECX*4]
0048D3C4   8D0C8A           LEA ECX,DWORD PTR DS:[EDX+ECX*4]
0048D3C7   F641 06 02       TEST BYTE PTR DS:[ECX+6],2
0048D3CB   0FBF51 02        MOVSX EDX,WORD PTR DS:[ECX+2]
0048D3CF   75 0C            JNZ SHORT haloce.0048D3DD
0048D3D1   8B1495 18416200  MOV EDX,DWORD PTR DS:[EDX*4+624118]      ; haloce.005F60A0
0048D3D8   66:8B12          MOV DX,WORD PTR DS:[EDX]
0048D3DB   EB 16            JMP SHORT haloce.0048D3F3
...
0048D3F3   66:8B49 04       MOV CX,WORD PTR DS:[ECX+4]
0048D3F7   66:3BD1          CMP DX,CX
0048D3FA   74 47            JE SHORT haloce.0048D443
...
0048D443   8B4F 10          MOV ECX,DWORD PTR DS:[EDI+10]
0048D446   8B11             MOV EDX,DWORD PTR DS:[ECX]
0048D448   8B4A 08          MOV ECX,DWORD PTR DS:[EDX+8]
0048D44B   8B15 B0558100    MOV EDX,DWORD PTR DS:[8155B0] ;hs thread
0048D451   8901             MOV DWORD PTR DS:[ECX],EAX
0048D453   8B42 34          MOV EAX,DWORD PTR DS:[EDX+34]
0048D456   8B4C30 10        MOV ECX,DWORD PTR DS:[EAX+ESI+10]
0048D45A   8B11             MOV EDX,DWORD PTR DS:[ECX]
0048D45C   03C6             ADD EAX,ESI
0048D45E   5F               POP EDI
0048D45F   8950 10          MOV DWORD PTR DS:[EAX+10],EDX
0048D462   5E               POP ESI
0048D463   C3               RETN
<-
0048D1E6   83C4 0C          ADD ESP,0C
0048D1E9   EB 53            JMP SHORT haloce.0048D23E
...
0048D23E   8B4E 10          MOV ECX,DWORD PTR DS:[ESI+10]
0048D241   8D46 18          LEA EAX,DWORD PTR DS:[ESI+18]
0048D244   3BC8             CMP ECX,EAX
0048D246  ^0F85 14FFFFFF    JNZ haloce.0048D160
...
0048D160   8B4E 08          MOV ECX,DWORD PTR DS:[ESI+8]
0048D163   85C9             TEST ECX,ECX
0048D165   0F8C E1000000    JL haloce.0048D24C
0048D16B   A1 90CD6800      MOV EAX,DWORD PTR DS:[68CD90]
0048D170   8038 00          CMP BYTE PTR DS:[EAX],0
0048D173   74 17            JE SHORT haloce.0048D18C
0048D175   8A50 01          MOV DL,BYTE PTR DS:[EAX+1]
0048D178   84D2             TEST DL,DL
0048D17A   75 07            JNZ SHORT haloce.0048D183
...
0048D183   3B48 0C          CMP ECX,DWORD PTR DS:[EAX+C]
0048D186   0F8F C0000000    JG haloce.0048D24C
0048D18C   A0 38C56400      MOV AL,BYTE PTR DS:[64C538]
0048D191   84C0             TEST AL,AL
0048D193   0F84 B3000000    JE haloce.0048D24C
0048D199   8B4E 10          MOV ECX,DWORD PTR DS:[ESI+10]
0048D19C   8B41 04          MOV EAX,DWORD PTR DS:[ECX+4]
0048D19F   25 FFFF0000      AND EAX,0FFFF
0048D1A4   8D1480           LEA EDX,DWORD PTR DS:[EAX+EAX*4]
0048D1A7   A1 B4558100      MOV EAX,DWORD PTR DS:[8155B4] ;script node
0048D1AC   8B40 34          MOV EAX,DWORD PTR DS:[EAX+34]
0048D1AF   8D0490           LEA EAX,DWORD PTR DS:[EAX+EDX*4]
0048D1B2   8A56 03          MOV DL,BYTE PTR DS:[ESI+3]
0048D1B5   66:C741 0C 0000  MOV WORD PTR DS:[ECX+C],0
0048D1BB   8066 03 FE       AND BYTE PTR DS:[ESI+3],0FE
0048D1BF   8A48 06          MOV CL,BYTE PTR DS:[EAX+6]
0048D1C2   0FBF40 02        MOVSX EAX,WORD PTR DS:[EAX+2]
0048D1C6   80E2 01          AND DL,1
0048D1C9   F6C1 02          TEST CL,2
0048D1CC   885424 14        MOV BYTE PTR SS:[ESP+14],DL
0048D1D0   75 19            JNZ SHORT haloce.0048D1EB
0048D1D2   0FBFC8           MOVSX ECX,AX
0048D1D5   8B148D 18416200  MOV EDX,DWORD PTR DS:[ECX*4+624118]
0048D1DC   8B4C24 14        MOV ECX,DWORD PTR SS:[ESP+14]
0048D1E0   51               PUSH ECX
0048D1E1   57               PUSH EDI
0048D1E2   50               PUSH EAX
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F5DF4
->
0048C9D0   8B5424 08        MOV EDX,DWORD PTR SS:[ESP+8]
0048C9D4   8B0D B0558100    MOV ECX,DWORD PTR DS:[8155B0] ;hs thread
0048C9DA   8B49 34          MOV ECX,DWORD PTR DS:[ECX+34]
0048C9DD   8BC2             MOV EAX,EDX
0048C9DF   25 FFFF0000      AND EAX,0FFFF
0048C9E4   69C0 18020000    IMUL EAX,EAX,218
0048C9EA   53               PUSH EBX
0048C9EB   56               PUSH ESI
0048C9EC   8D7408 10        LEA ESI,DWORD PTR DS:[EAX+ECX+10]
0048C9F0   8B06             MOV EAX,DWORD PTR DS:[ESI]
0048C9F2   33C9             XOR ECX,ECX
0048C9F4   66:8B48 0C       MOV CX,WORD PTR DS:[EAX+C]
0048C9F8   57               PUSH EDI
0048C9F9   0FBFF9           MOVSX EDI,CX
0048C9FC   8D5C07 0E        LEA EBX,DWORD PTR DS:[EDI+EAX+E]
0048CA00   83C1 04          ADD ECX,4
0048CA03   66:8948 0C       MOV WORD PTR DS:[EAX+C],CX
0048CA07   8A4424 18        MOV AL,BYTE PTR SS:[ESP+18]
0048CA0B   84C0             TEST AL,AL
0048CA0D   74 2E            JE SHORT haloce.0048CA3D
...
0048CA3D   8B03             MOV EAX,DWORD PTR DS:[EBX]
0048CA3F   83F8 FF          CMP EAX,-1
0048CA42   5F               POP EDI
0048CA43   74 47            JE SHORT haloce.0048CA8C
0048CA45   8B35 B0B37F00    MOV ESI,DWORD PTR DS:[7FB3B0] ;object
0048CA4B   8B76 34          MOV ESI,DWORD PTR DS:[ESI+34]
0048CA4E   8BC8             MOV ECX,EAX
0048CA50   81E1 FFFF0000    AND ECX,0FFFF
0048CA56   8D0C49           LEA ECX,DWORD PTR DS:[ECX+ECX*2]
0048CA59   8B4C8E 08        MOV ECX,DWORD PTR DS:[ESI+ECX*4+8]       ; ECX=player object
0048CA5D   8A89 B4000000    MOV CL,BYTE PTR DS:[ECX+B4]              ; (ECX)CL=player object + B4
0048CA63   BE 01000000      MOV ESI,1
0048CA68   D3E6             SHL ESI,CL
0048CA6A   8B4C24 0C        MOV ECX,DWORD PTR SS:[ESP+C]
0048CA6E   83C1 EA          ADD ECX,-16
0048CA71   0FBFC9           MOVSX ECX,CX
0048CA74   0FBF0C4D 485A5F0>MOVSX ECX,WORD PTR DS:[ECX*2+5F5A48]
0048CA7C   85F1             TEST ECX,ESI
0048CA7E   5E               POP ESI
0048CA7F   8BCA             MOV ECX,EDX
0048CA81   5B               POP EBX
0048CA82   75 0F            JNZ SHORT haloce.0048CA93
...
0048CA93   E9 F8080000      JMP haloce.0048D390
...
0048D390   81E1 FFFF0000    AND ECX,0FFFF
0048D396   56               PUSH ESI
0048D397   8BF1             MOV ESI,ECX
0048D399   8B0D B0558100    MOV ECX,DWORD PTR DS:[8155B0] ;hs thread
0048D39F   69F6 18020000    IMUL ESI,ESI,218
0048D3A5   57               PUSH EDI
0048D3A6   8B79 34          MOV EDI,DWORD PTR DS:[ECX+34]
0048D3A9   8B5437 10        MOV EDX,DWORD PTR DS:[EDI+ESI+10]
0048D3AD   8B4A 04          MOV ECX,DWORD PTR DS:[EDX+4]
0048D3B0   8B15 B4558100    MOV EDX,DWORD PTR DS:[8155B4] ;script node
0048D3B6   8B52 34          MOV EDX,DWORD PTR DS:[EDX+34]
0048D3B9   03FE             ADD EDI,ESI
0048D3BB   81E1 FFFF0000    AND ECX,0FFFF
0048D3C1   8D0C89           LEA ECX,DWORD PTR DS:[ECX+ECX*4]
0048D3C4   8D0C8A           LEA ECX,DWORD PTR DS:[EDX+ECX*4]
0048D3C7   F641 06 02       TEST BYTE PTR DS:[ECX+6],2
0048D3CB   0FBF51 02        MOVSX EDX,WORD PTR DS:[ECX+2]
0048D3CF   75 0C            JNZ SHORT haloce.0048D3DD
0048D3D1   8B1495 18416200  MOV EDX,DWORD PTR DS:[EDX*4+624118]
0048D3D8   66:8B12          MOV DX,WORD PTR DS:[EDX]
0048D3DB   EB 16            JMP SHORT haloce.0048D3F3
...
0048D3F3   66:8B49 04       MOV CX,WORD PTR DS:[ECX+4]
0048D3F7   66:3BD1          CMP DX,CX
0048D3FA   74 47            JE SHORT haloce.0048D443
...
0048D443   8B4F 10          MOV ECX,DWORD PTR DS:[EDI+10]
0048D446   8B11             MOV EDX,DWORD PTR DS:[ECX]
0048D448   8B4A 08          MOV ECX,DWORD PTR DS:[EDX+8]
0048D44B   8B15 B0558100    MOV EDX,DWORD PTR DS:[8155B0] ;hs thread
0048D451   8901             MOV DWORD PTR DS:[ECX],EAX
0048D453   8B42 34          MOV EAX,DWORD PTR DS:[EDX+34]
0048D456   8B4C30 10        MOV ECX,DWORD PTR DS:[EAX+ESI+10]
0048D45A   8B11             MOV EDX,DWORD PTR DS:[ECX]
0048D45C   03C6             ADD EAX,ESI
0048D45E   5F               POP EDI
0048D45F   8950 10          MOV DWORD PTR DS:[EAX+10],EDX
0048D462   5E               POP ESI
0048D463   C3               RETN
<-
0048D1E6   83C4 0C          ADD ESP,0C
0048D1E9   EB 53            JMP SHORT haloce.0048D23E
...
0048D23E   8B4E 10          MOV ECX,DWORD PTR DS:[ESI+10]
0048D241   8D46 18          LEA EAX,DWORD PTR DS:[ESI+18]
0048D244   3BC8             CMP ECX,EAX
0048D246  ^0F85 14FFFFFF    JNZ haloce.0048D160
...
0048D160   8B4E 08          MOV ECX,DWORD PTR DS:[ESI+8]
0048D163   85C9             TEST ECX,ECX
0048D165   0F8C E1000000    JL haloce.0048D24C
0048D16B   A1 90CD6800      MOV EAX,DWORD PTR DS:[68CD90]
0048D170   8038 00          CMP BYTE PTR DS:[EAX],0
0048D173   74 17            JE SHORT haloce.0048D18C
0048D175   8A50 01          MOV DL,BYTE PTR DS:[EAX+1]
0048D178   84D2             TEST DL,DL
0048D17A   75 07            JNZ SHORT haloce.0048D183
...
0048D183   3B48 0C          CMP ECX,DWORD PTR DS:[EAX+C]
0048D186   0F8F C0000000    JG haloce.0048D24C
0048D18C   A0 38C56400      MOV AL,BYTE PTR DS:[64C538]
0048D191   84C0             TEST AL,AL
0048D193   0F84 B3000000    JE haloce.0048D24C
0048D199   8B4E 10          MOV ECX,DWORD PTR DS:[ESI+10]
0048D19C   8B41 04          MOV EAX,DWORD PTR DS:[ECX+4]
0048D19F   25 FFFF0000      AND EAX,0FFFF
0048D1A4   8D1480           LEA EDX,DWORD PTR DS:[EAX+EAX*4]
0048D1A7   A1 B4558100      MOV EAX,DWORD PTR DS:[8155B4] ;script node
0048D1AC   8B40 34          MOV EAX,DWORD PTR DS:[EAX+34]
0048D1AF   8D0490           LEA EAX,DWORD PTR DS:[EAX+EDX*4]
0048D1B2   8A56 03          MOV DL,BYTE PTR DS:[ESI+3]
0048D1B5   66:C741 0C 0000  MOV WORD PTR DS:[ECX+C],0
0048D1BB   8066 03 FE       AND BYTE PTR DS:[ESI+3],0FE
0048D1BF   8A48 06          MOV CL,BYTE PTR DS:[EAX+6]
0048D1C2   0FBF40 02        MOVSX EAX,WORD PTR DS:[EAX+2]
0048D1C6   80E2 01          AND DL,1
0048D1C9   F6C1 02          TEST CL,2
0048D1CC   885424 14        MOV BYTE PTR SS:[ESP+14],DL
0048D1D0   75 19            JNZ SHORT haloce.0048D1EB
0048D1D2   0FBFC8           MOVSX ECX,AX
0048D1D5   8B148D 18416200  MOV EDX,DWORD PTR DS:[ECX*4+624118]
0048D1DC   8B4C24 14        MOV ECX,DWORD PTR SS:[ESP+14]
0048D1E0   51               PUSH ECX
0048D1E1   57               PUSH EDI
0048D1E2   50               PUSH EAX
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F68DC (2)
->
0047ED60   0FBF4424 04      MOVSX EAX,WORD PTR SS:[ESP+4]
0047ED65   8B0485 18416200  MOV EAX,DWORD PTR DS:[EAX*4+624118]
0047ED6C   8B4C24 0C        MOV ECX,DWORD PTR SS:[ESP+C]
0047ED70   56               PUSH ESI
0047ED71   8B7424 0C        MOV ESI,DWORD PTR SS:[ESP+C]
0047ED75   51               PUSH ECX
0047ED76   8D50 1C          LEA EDX,DWORD PTR DS:[EAX+1C]
0047ED79   0FBF40 1A        MOVSX EAX,WORD PTR DS:[EAX+1A]
0047ED7D   52               PUSH EDX
0047ED7E   50               PUSH EAX
0047ED7F   56               PUSH ESI
0047ED80   E8 1BE80000      CALL haloce.0048D5A0
->
0048D5A0   8B4C24 04        MOV ECX,DWORD PTR SS:[ESP+4]
0048D5A4   53               PUSH EBX
0048D5A5   81E1 FFFF0000    AND ECX,0FFFF
0048D5AB   69C9 18020000    IMUL ECX,ECX,218
0048D5B1   55               PUSH EBP
0048D5B2   8B6C24 10        MOV EBP,DWORD PTR SS:[ESP+10]
0048D5B6   56               PUSH ESI
0048D5B7   57               PUSH EDI
0048D5B8   8B3D B0558100    MOV EDI,DWORD PTR DS:[8155B0] ;hs thread
0048D5BE   8B47 34          MOV EAX,DWORD PTR DS:[EDI+34]
0048D5C1   8B7408 10        MOV ESI,DWORD PTR DS:[EAX+ECX+10]
0048D5C5   8D5408 10        LEA EDX,DWORD PTR DS:[EAX+ECX+10]
0048D5C9   33DB             XOR EBX,EBX
0048D5CB   66:8B5E 0C       MOV BX,WORD PTR DS:[ESI+C]
0048D5CF   0FBFC3           MOVSX EAX,BX
0048D5D2   8D4430 0E        LEA EAX,DWORD PTR DS:[EAX+ESI+E]
0048D5D6   8D1CAB           LEA EBX,DWORD PTR DS:[EBX+EBP*4]
0048D5D9   66:895E 0C       MOV WORD PTR DS:[ESI+C],BX
0048D5DD   8B77 34          MOV ESI,DWORD PTR DS:[EDI+34]
0048D5E0   8B740E 10        MOV ESI,DWORD PTR DS:[ESI+ECX+10]
0048D5E4   33DB             XOR EBX,EBX
0048D5E6   66:8B5E 0C       MOV BX,WORD PTR DS:[ESI+C]
0048D5EA   0FBFEB           MOVSX EBP,BX
0048D5ED   8D6C2E 0E        LEA EBP,DWORD PTR DS:[ESI+EBP+E]
0048D5F1   83C3 02          ADD EBX,2
0048D5F4   66:895E 0C       MOV WORD PTR DS:[ESI+C],BX
0048D5F8   8B77 34          MOV ESI,DWORD PTR DS:[EDI+34]
0048D5FB   8B4C0E 10        MOV ECX,DWORD PTR DS:[ESI+ECX+10]
0048D5FF   8B1D B4558100    MOV EBX,DWORD PTR DS:[8155B4] ;script node
0048D605   33F6             XOR ESI,ESI
0048D607   66:8B71 0C       MOV SI,WORD PTR DS:[ECX+C]
0048D60B   0FBFFE           MOVSX EDI,SI
0048D60E   8D7C0F 0E        LEA EDI,DWORD PTR DS:[EDI+ECX+E]
0048D612   83C6 04          ADD ESI,4
0048D615   66:8971 0C       MOV WORD PTR DS:[ECX+C],SI
0048D619   8A4C24 20        MOV CL,BYTE PTR SS:[ESP+20]
0048D61D   84C9             TEST CL,CL
0048D61F   74 2A            JE SHORT haloce.0048D64B
...
0048D64B   66:8B4D 00       MOV CX,WORD PTR SS:[EBP]
0048D64F   66:3B4C24 18     CMP CX,WORD PTR SS:[ESP+18]
0048D654   7D 4E            JGE SHORT haloce.0048D6A4
...
0048D6A4   5F               POP EDI
0048D6A5   5E               POP ESI
0048D6A6   5D               POP EBP
0048D6A7   5B               POP EBX
0048D6A8   C3               RETN
<-
0047ED85   83C4 10          ADD ESP,10






0047ED88   85C0             TEST EAX,EAX
0047ED8A   74 11            JE SHORT haloce.0047ED9D
0047ED8C   8B00             MOV EAX,DWORD PTR DS:[EAX] ;player obj tag (ID + index)
0047ED8E   E8 9D050F00      CALL haloce.0056F330 ;pc1.09=0056BBB0 7;haloceded1.09=0051DA80
->;bool unit_exit_vehicle(DWORD PlayerObjTag)
0056F330   55               PUSH EBP
0056F331   8BEC             MOV EBP,ESP
0056F333   83E4 F8          AND ESP,FFFFFFF8
0056F336   81EC DC000000    SUB ESP,0DC
0056F33C   53               PUSH EBX
0056F33D   56               PUSH ESI
0056F33E   8BF0             MOV ESI,EAX
0056F340   83C9 FF          OR ECX,FFFFFFFF
0056F343   3BF1             CMP ESI,ECX
0056F345   57               PUSH EDI
0056F346   0F84 B4050000    JE haloce.0056F900
0056F34C   A1 B0B37F00      MOV EAX,DWORD PTR DS:[7FB3B0] ;object
0056F351   8B40 34          MOV EAX,DWORD PTR DS:[EAX+34]
0056F354   8BFE             MOV EDI,ESI
0056F356   81E7 FFFF0000    AND EDI,0FFFF
0056F35C   8D3C7F           LEA EDI,DWORD PTR DS:[EDI+EDI*2]
0056F35F   C1E7 02          SHL EDI,2
0056F362   8B5C38 08        MOV EBX,DWORD PTR DS:[EAX+EDI+8]         ; player object
0056F366   894424 0C        MOV DWORD PTR SS:[ESP+C],EAX             ;EAX=first obj (400506EC)
0056F36A   398B 1C010000    CMP DWORD PTR DS:[EBX+11C],ECX           ; test if in vehicle
0056F370   897C24 18        MOV DWORD PTR SS:[ESP+18],EDI            ;store player object index (000014E8)
0056F374   0F84 86050000    JE haloce.0056F900
0056F37A   66:398B F0020000 CMP WORD PTR DS:[EBX+2F0],CX ;test valid seat type in player obj CX=FFFF
0056F381   0F84 79050000    JE haloce.0056F900
0056F387   6A 03            PUSH 3
0056F389   8BCE             MOV ECX,ESI  ;player obj index
0056F38B   E8 C0B7F8FF      CALL haloce.004FAB50
->
004FAB50   57               PUSH EDI
004FAB51   33FF             XOR EDI,EDI
004FAB53   83F9 FF          CMP ECX,-1
004FAB56   74 39            JE SHORT haloce.004FAB91
004FAB58   56               PUSH ESI
004FAB59   8BF1             MOV ESI,ECX
004FAB5B   C1FE 10          SAR ESI,10
004FAB5E   66:85C9          TEST CX,CX
004FAB61   7C 2D            JL SHORT haloce.004FAB90
004FAB63   8B15 B0B37F00    MOV EDX,DWORD PTR DS:[7FB3B0] ;object
004FAB69   66:3B4A 20       CMP CX,WORD PTR DS:[EDX+20]
004FAB6D   7D 21            JGE SHORT haloce.004FAB90
004FAB6F   0FBF42 22        MOVSX EAX,WORD PTR DS:[EDX+22]
004FAB73   0FBFC9           MOVSX ECX,CX
004FAB76   0FAFC1           IMUL EAX,ECX
004FAB79   0342 34          ADD EAX,DWORD PTR DS:[EDX+34] ;obj header (40051BD4)
004FAB7C   66:8B08          MOV CX,WORD PTR DS:[EAX]     ;test ID
004FAB7F   66:85C9          TEST CX,CX
004FAB82   74 0C            JE SHORT haloce.004FAB90
004FAB82   74 0C            JE SHORT haloce.004FAB90
004FAB84   66:85F6          TEST SI,SI
004FAB87   74 05            JE SHORT haloce.004FAB8E
004FAB89   66:3BCE          CMP CX,SI
004FAB8C   75 02            JNZ SHORT haloce.004FAB90
004FAB8E   8BF8             MOV EDI,EAX
004FAB90   5E               POP ESI
004FAB91   33C0             XOR EAX,EAX
004FAB93   85FF             TEST EDI,EDI
004FAB95   74 13            JE SHORT haloce.004FABAA
004FAB97   8A4F 03          MOV CL,BYTE PTR DS:[EDI+3] ;
004FAB9A   BA 01000000      MOV EDX,1
004FAB9F   D3E2             SHL EDX,CL
004FABA1   855424 08        TEST DWORD PTR SS:[ESP+8],EDX 
004FABA5   74 03            JE SHORT haloce.004FABAA
004FABA7   8B47 08          MOV EAX,DWORD PTR DS:[EDI+8] ;EAX=player obj (400E2BD8)
004FABAA   5F               POP EDI ;obj table header
004FABAB   C3               RETN
<-
0056F390   83C4 04          ADD ESP,4
0056F393   85C0             TEST EAX,EAX
0056F395   894424 14        MOV DWORD PTR SS:[ESP+14],EAX ;store player obj ptr
0056F399   0F84 61050000    JE haloce.0056F900
0056F39F   BA 01000000      MOV EDX,1
0056F3A4   66:3915 D0476B00 CMP WORD PTR DS:[6B47D0],DX
0056F3AB   0F84 4F050000    JE haloce.0056F900
0056F3B1   8B88 1C010000    MOV ECX,DWORD PTR DS:[EAX+11C]; vehicle obj index in player obj ->ECX=E27C000D
0056F3B7   83F9 FF          CMP ECX,-1 ;ECX=E27C000D != -1?
0056F3BA   0F84 40050000    JE haloce.0056F900
0056F3C0   66:83B8 F0020000>CMP WORD PTR DS:[EAX+2F0],0FFFF ;DS:[400AF4E8]=0002 != -1? test valid seat type
0056F3C8   0F84 32050000    JE haloce.0056F900
0056F3CE   66:3990 B4000000 CMP WORD PTR DS:[EAX+B4],DX ;DS:[400AF2AC]=0000 == DX=0001?  test something at 0xB4
0056F3D5   0F85 F4030000    JNZ haloce.0056F7CF
...
0056F7CF   8D88 98020000    LEA ECX,DWORD PTR DS:[EAX+298] ;load something from 0x298 ->ECX=400AF490
0056F7D5   E8 869FFFFF      CALL haloce.00569760
->
00569760   0FBE49 0B        MOVSX ECX,BYTE PTR DS:[ECX+B] ;[400AF490+B] ->ECX=00000000
00569764   83C1 E9          ADD ECX,-17;->ECX=FFFFFFE9
00569767   32C0             XOR AL,AL ;->EAX=400AF1 00
00569769   83F9 12          CMP ECX,12;ECX=FFFFFFE9 > 12?                       ; Switch (cases 0..12)
0056976C   77 10            JA SHORT haloce.0056977E
...
0056977E   C3               RETN                                     ; Default case of switch 00569769
<-
0056F7DA   84C0             TEST AL,AL;AL=00
0056F7DC   0F85 1E010000    JNZ haloce.0056F900
0056F7E2   8B4C24 14        MOV ECX,DWORD PTR SS:[ESP+14] ;->ECX=400AF1F8 (player obj)
0056F7E6   8B11             MOV EDX,DWORD PTR DS:[ECX] ;->EDX=EA2C08B8 (BipdMetaIndex and ID)
0056F7E8   A1 E46D8100      MOV EAX,DWORD PTR DS:[816DE4] ;->EAX=40440028
0056F7ED   81E2 FFFF0000    AND EDX,0FFFF ;remove the ID, just the index ->EDX=000008B8
0056F7F3   C1E2 05          SHL EDX,5;8B8*2^5->EDX=00011700
0056F7F6   8B5C02 14        MOV EBX,DWORD PTR DS:[EDX+EAX+14];[00011700+40440028+0x14] ->EBX=40A41E2C

0056F7FA   8B53 44          MOV EDX,DWORD PTR DS:[EBX+44] ;[(EBX=40A41E2C)+0x44] ->EDX=EA3808C4
0056F7FD   81E2 FFFF0000    AND EDX,0FFFF ;index?->EDX=000008C4
0056F803   C1E2 05          SHL EDX,5;8C4*2^5->EDX=00011880
0056F806   8B5402 14        MOV EDX,DWORD PTR DS:[EDX+EAX+14];[00011880+40440028+0x14] ->EDX=40A445B0

0056F80A   0FBE81 A0020000  MOVSX EAX,BYTE PTR DS:[ECX+2A0] ;something at 0x2A0->EAX=00000001
0056F811   6BC0 64          IMUL EAX,EAX,64 ;EAX = 1 * 64
0056F814   0342 10          ADD EAX,DWORD PTR DS:[EDX+10] ;(EDX=40A445B0)+0x10=[40A445C0] =40A44630 (W-driver)
0056F817   8378 40 08       CMP DWORD PTR DS:[EAX+40],8 ;EAX=40A44694 ;EAX+0x40 =0xC
0056F81B   0F8E DF000000    JLE haloce.0056F900
0056F821   8B40 44          MOV EAX,DWORD PTR DS:[EAX+44] ;EAX+0x44=0x40A45188
0056F824   0FBF40 10        MOVSX EAX,WORD PTR DS:[EAX+10] ;EAX+0x10=0x0022
0056F828   66:3D FFFF       CMP AX,0FFFF
0056F82C   894424 10        MOV DWORD PTR SS:[ESP+10],EAX ;save 0x00000022
0056F830   0F84 CA000000    JE haloce.0056F900
0056F836   8B81 1C010000    MOV EAX,DWORD PTR DS:[ECX+11C] ;VehicleIndex
0056F83C   8B5424 0C        MOV EDX,DWORD PTR SS:[ESP+C] ;first obj ptr
0056F840   8BC8             MOV ECX,EAX
0056F842   81E1 FFFF0000    AND ECX,0FFFF
0056F848   8D0C49           LEA ECX,DWORD PTR DS:[ECX+ECX*2]
0056F84B   8B4C8A 08        MOV ECX,DWORD PTR DS:[EDX+ECX*4+8] ;vehicle obj
0056F84F   39B1 24030000    CMP DWORD PTR DS:[ECX+324],ESI ;something at v-obj 0x324(-1) ESI=0xE3AE013F
0056F855   75 05            JNZ SHORT haloce.0056F85C


;doesnt jmp if player is driver (scorpion driver)
0056F857   E8 F4EFFFFF      CALL haloce.0056E850
->
0056E850   83F8 FF          CMP EAX,-1 ;test vehicle index EAX=E42001B1
0056E853   74 0B            JE SHORT haloce.0056E860
0056E855   6A 25            PUSH 25
0056E857   50               PUSH EAX ;E42001B1
0056E858   E8 33B2FFFF      CALL haloce.00569A90
->
00569A90   83EC 14          SUB ESP,14
00569A93   8B4424 18        MOV EAX,DWORD PTR SS:[ESP+18] ;->EAX=E42001B1
00569A97   53               PUSH EBX
00569A98   25 FFFF0000      AND EAX,0FFFF ;->000001B1 (vehicle obj index)
00569A9D   55               PUSH EBP
00569A9E   8D2C40           LEA EBP,DWORD PTR DS:[EAX+EAX*2]
00569AA1   A1 B0B37F00      MOV EAX,DWORD PTR DS:[7FB3B0];object data header ptr
00569AA6   8B48 34          MOV ECX,DWORD PTR DS:[EAX+34]
00569AA9   A1 E46D8100      MOV EAX,DWORD PTR DS:[816DE4];(animation ptr?) ->EAX=40440028
00569AAE   C1E5 02          SHL EBP,2
00569AB1   56               PUSH ESI
00569AB2   8B7429 08        MOV ESI,DWORD PTR DS:[ECX+EBP+8] ; vehicle object ->ESI=400DBC94 (tank)
00569AB6   8B16             MOV EDX,DWORD PTR DS:[ESI] ;vehicle BipdMetaIndex
00569AB8   0FBE9E A1020000  MOVSX EBX,BYTE PTR DS:[ESI+2A1] ;veh obj + 2A1 ->EBX=00000000
00569ABF   81E2 FFFF0000    AND EDX,0FFFF ;vehicle BipdMetaIndex -> EDX 000002FB
00569AC5   69DB BC000000    IMUL EBX,EBX,0BC
00569ACB   C1E2 05          SHL EDX,5 ;->EDX=00005F60
00569ACE   8B4C02 14        MOV ECX,DWORD PTR DS:[EDX+EAX+14] ;[00005F60+40440028+0x14]->ECX=40774C40 animation obj?
00569AD2   57               PUSH EDI ;000014E8
00569AD3   0FBEBE A0020000  MOVSX EDI,BYTE PTR DS:[ESI+2A0];veh obj AnimationType->EDI=00000000
00569ADA   894C24 18        MOV DWORD PTR SS:[ESP+18],ECX ;save 40774C40 animation obj?
00569ADE   6BFF 64          IMUL EDI,EDI,64 ;00000000*64->EDI=00000000
00569AE1   8B49 44          MOV ECX,DWORD PTR DS:[ECX+44] ;animation obj? another index->ECX=E47C0308
00569AE4   81E1 FFFF0000    AND ECX,0FFFF ;->ECX=00000308
00569AEA   C1E1 05          SHL ECX,5 ;->ECX=00006100
00569AED   8B5401 14        MOV EDX,DWORD PTR DS:[ECX+EAX+14] ;[00006100+40440028+0x14]->EDX=40778DC4 2nd animation obj
00569AF1   8B4A 10          MOV ECX,DWORD PTR DS:[EDX+10] ;2nd animation obj->animation string ECX=40778E58 "stand"
00569AF4   8B440F 5C        MOV EAX,DWORD PTR DS:[EDI+ECX+5C] ;{00000000+40778E58+5C]->EAX=40778EF8 "fixed"
00569AF8   03F9             ADD EDI,ECX ;00000000+40778E58->EDI=40778E58 "stand"
00569AFA   03D8             ADD EBX,EAX ;00000000+40778EF8->EBX=40778EF8 "fixed"
00569AFC   8A86 A3020000    MOV AL,BYTE PTR DS:[ESI+2A3] ;veh action type->AL=0x26
00569B02   3C FF            CMP AL,0FF ;test valid action type 0x26 == FFFF?
00569B04   0F94C2           SETE DL ;Condition is FALSE, DL=C4
00569B07   84D2             TEST DL,DL ;DL=0
00569B09   885424 16        MOV BYTE PTR SS:[ESP+16],DL ;save DL=0
00569B0D   C64424 17 00     MOV BYTE PTR SS:[ESP+17],0
00569B12   75 14            JNZ SHORT haloce.00569B28
00569B14   66:0FBEC8        MOVSX CX,AL ;AL=0x26->CX=0x0026
00569B18   66:394C24 2C     CMP WORD PTR SS:[ESP+2C],CX ;CX=0026 == Stack SS:[0018CDC8]=0025?
00569B1D   66:894C24 1C     MOV WORD PTR SS:[ESP+1C],CX ;save CX=0026
00569B22   0F84 5C020000    JE haloce.00569D84
00569B28   3C 21            CMP AL,21 ;AL=0x26 == 0x21?
00569B2A   75 0F            JNZ SHORT haloce.00569B3B
...
00569B3B   0FBF5424 2C      MOVSX EDX,WORD PTR SS:[ESP+2C] ;->EDX=00000025
00569B40   83FA 2B          CMP EDX,2B ;0x25 == 2B?                    ; Switch (cases 0..2B) ;action switch
00569B43   0F87 91010000    JA haloce.00569CDA
00569B49   FF2495 409E5600  JMP DWORD PTR DS:[EDX*4+569E40] ;[00000025*4+569E40] ->  ; haloce.00569CC5
...
00569CC5   B8 1B000000      MOV EAX,1B ;->EAX=0000001B unit exit vehicle action          ; Case 25 of switch 00569B40
00569CCA  ^EB C7            JMP SHORT haloce.00569C93
...
00569C93   8B4F 40          MOV ECX,DWORD PTR DS:[EDI+40] ;[40778E58+0x40] "stand" ptr + 0x40->ECX=0000001D
00569C96   0FBFC0           MOVSX EAX,AX ;AX=001B, EAX=0000001B ->EAX=0000001B kind of pointless
00569C99   3BC1             CMP EAX,ECX ;EAX=0000001B == ECX=0000001D?
00569C9B   7D 3D            JGE SHORT haloce.00569CDA
00569C9D   8B4F 44          MOV ECX,DWORD PTR DS:[EDI+44] ;[40778E58+0x44] "stand" ptr + 0x40->ECX=40778EBC
00569CA0  ^E9 C4FEFFFF      JMP haloce.00569B69
...
00569B69   66:8B0C41        MOV CX,WORD PTR DS:[ECX+EAX*2] ;[40778EBC+0000001B*2]->CX=0005 (ECX=40770005 "tib")
00569B6D   66:83F9 FF       CMP CX,0FFFF ;CX=0005 == FFFF?
00569B71   0F85 75010000    JNZ haloce.00569CEC
...
00569CEC   8B4424 18        MOV EAX,DWORD PTR SS:[ESP+18] ;EAX=40774C40      ; Default case of switch 00569B77
00569CF0   8B40 44          MOV EAX,DWORD PTR DS:[EAX+44] ;[40774C40+0x44]->EAX=E47C0308 (index and ID again)
00569CF3   6A 01            PUSH 1
00569CF5   8BD1             MOV EDX,ECX ;->EDX=40770005 "tib"
00569CF7   E8 C4FAF6FF      CALL haloce.004D97C0
->
004D97C0   8B0D E46D8100    MOV ECX,DWORD PTR DS:[816DE4] ; ptr to 0x40440028 (animation ptr?)
004D97C6   25 FFFF0000      AND EAX,0FFFF ;->EAX=00000308
004D97CB   C1E0 05          SHL EAX,5 ;308 << 5 ->EAX=00006100
004D97CE   8B4408 14        MOV EAX,DWORD PTR DS:[EAX+ECX+14] ;[00006100+0x40440028+0x14] vehicle animation object->40778DC4
004D97D2   837C24 04 01     CMP DWORD PTR SS:[ESP+4],1 ;Stack SS:[0018CD98]=00000001 == 1?
004D97D7   75 25            JNZ SHORT haloce.004D97FE
004D97D9   8B0D 804D6B00    MOV ECX,DWORD PTR DS:[6B4D80] ;ptr to something->ECX=6D6C3236
004D97DF   69C9 0D661900    IMUL ECX,ECX,19660D ;ECX=A4F8E4EA * 19660D->ECX=E6B2DBE2
004D97E5   81C1 5FF36E3C    ADD ECX,3C6EF35F ;ECX=E6B2DBE2+3C6EF35F->ECX=2321CF41
004D97EB   890D 804D6B00    MOV DWORD PTR DS:[6B4D80],ECX ;save 2321CF41 to DWORD variable
004D97F1   C1E9 10          SHR ECX,10 ;ECX=2321CF41 >> 10->ECX = 00002321
004D97F4   894C24 04        MOV DWORD PTR SS:[ESP+4],ECX ;save 00002321 to stack
004D97F8   DB4424 04        FILD DWORD PTR SS:[ESP+4] ;then load as a float
004D97FC   EB 23            JMP SHORT haloce.004D9821
...
004D9821   66:83FA FF       CMP DX,0FFFF ;DX=0005 == FFFF?
004D9825   D80D C4226100    FMUL DWORD PTR DS:[6122C4] ;load float
004D982B   D95C24 04        FSTP DWORD PTR SS:[ESP+4] ;store float?
004D982F   74 38            JE SHORT haloce.004D9869
004D9831   56               PUSH ESI
004D9832   8B70 78          MOV ESI,DWORD PTR DS:[EAX+78] ;[EAX=40778DC4+0x78]->ESI=40779494 "stand closing"
004D9835   EB 09            JMP SHORT haloce.004D9840
...
004D9840   D94424 08        FLD DWORD PTR SS:[ESP+8] ;load float from stack 0.1372243911027908325 
004D9844   0FBFCA           MOVSX ECX,DX ;ECX=00002321 ,DX=0005->ECX=00000005
004D9847   69C9 B4000000    IMUL ECX,ECX,0B4 ;ECX=00000005*B4->ECX=00000384
004D984D   D85C31 44        FCOMP DWORD PTR DS:[ECX+ESI+44] ;cmp floats ST=0.1372243911027908325 == DS:[4077985C]=1.000000?
004D9851   DFE0             FSTSW AX ;AX=8DC4 store float?
004D9853   03CE             ADD ECX,ESI ;ECX=00000384+ESI=40779494->ECX=40779818 "stand opening"
004D9855   F6C4 41          TEST AH,41 ;AH=01 == 0x41?
004D9858   7B 0A            JPO SHORT haloce.004D9864
...
004D9864   66:8BC2          MOV AX,DX ;->AX=0005
004D9867   5E               POP ESI ;->ESI=400DDA10
004D9868   C3               RETN
<-
00569CFC   8B0D B0B37F00    MOV ECX,DWORD PTR DS:[7FB3B0] ;object
00569D02   8B51 34          MOV EDX,DWORD PTR DS:[ECX+34]
00569D05   8B4C2A 08        MOV ECX,DWORD PTR DS:[EDX+EBP+8] ;ECX=400DDA10 (tank rp_s1); vehicle object
00569D09   8B5424 1C        MOV EDX,DWORD PTR SS:[ESP+1C];load from stack->EDX=40774C40 animation object?
00569D0D   8B52 44          MOV EDX,DWORD PTR DS:[EDX+44];[EDX=40774C40+0x44]->EDX=E47C0308
00569D10   8991 CC000000    MOV DWORD PTR DS:[ECX+CC],EDX; veh animation trigger index and ID EDX=E47C0308
00569D16   8B5424 30        MOV EDX,DWORD PTR SS:[ESP+30];load from stack->EDX=00000025
00569D1A   66:8981 D0000000 MOV WORD PTR DS:[ECX+D0],AX;AX=0005 veh (scorpion hatch position 0 = closed, 5 = open)
00569D21   66:C781 D2000000 0000 MOV WORD PTR DS:[ECX+D2],0  ;veh BitFlags_03? ; change veh obj at D2 to 0
00569D2A   66:0FBE8E A3020000 MOVSX CX,BYTE PTR DS:[ESI+2A3];[400DDA10+2A3] veh action?->CX=0x0026
00569D32   83C4 04          ADD ESP,4 ;ESP=0018CD98 + 4->ESP=0018CD9C
00569D35   66:85D2          TEST DX,DX ;DX=0x0025
00569D38   66:894C24 1C     MOV WORD PTR SS:[ESP+1C],CX ;save 0x0025
00569D3D   B8 06000000      MOV EAX,6 ;->EAX=00000006
00569D42   74 0C            JE SHORT haloce.00569D50
00569D44   66:83FA 02                CMP DX,2 ;DX=0x0025 == 2?
00569D48   74 06                     JE SHORT haloce.00569D50
00569D4A   66:83FA 03                CMP DX,3;DX=0x0025 == 3?
00569D4E   75 16                     JNZ SHORT haloce.00569D66
...
00569D66   66:83FA 16                CMP DX,16;DX=0x0025 == 16?
00569D6A   74 06                     JE SHORT haloce.00569D72
00569D6C   66:83FA 15                CMP DX,15;DX=0x0025 == 15?
00569D70   75 05                     JNZ SHORT haloce.00569D77
...
00569D77   8A5424 16                 MOV DL,BYTE PTR SS:[ESP+16] ;load from stack->DL=00
00569D7B   894424 20                 MOV DWORD PTR SS:[ESP+20],EAX;save 00000006
00569D7F   C64424 17 01              MOV BYTE PTR SS:[ESP+17],1 ;save 1
00569D84   8B4C24 2C                 MOV ECX,DWORD PTR SS:[ESP+2C] ;load from stack->ECX=0x00000025
00569D88   E8 13FBFFFF               CALL haloce.005698A0
->
005698A0   0FBFC9                    MOVSX ECX,CX ;CX=0x0025, ECX=00000025->ECX=00000025
005698A3   83C8 FF                   OR EAX,FFFFFFFF ;EAX=00000006->EAX=FFFFFFFF
005698A6   83F9 26                   CMP ECX,26 ;ECX=0x00000025 == 0x26?              ; Switch (cases 0..26)
005698A9   77 19                     JA SHORT haloce.005698C4
005698AB   0FB689 D4985600           MOVZX ECX,BYTE PTR DS:[ECX+5698D4];[ECX=0x00000025+5698D4]->ECX=00000000
005698B2   FF248D C8985600           JMP DWORD PTR DS:[ECX*4+5698C8] ;[ECX=00000000*4+5698C8]-> haloce.005698B9
...
005698B9   B8 19000000               MOV EAX,19 ;->EAX=0x00000019                          ; Cases 0,2,3,10,11,12,13,14,15,16,25,26 of switch 005698A6
005698BE   C3                        RETN
<-
00569D8D   84D2                      TEST DL,DL ;DL=00
00569D8F   8BE8                      MOV EBP,EAX ;->EBX=00000019
00569D91   75 0E                     JNZ SHORT haloce.00569DA1
00569D93   8B4C24 1C                 MOV ECX,DWORD PTR SS:[ESP+1C]
00569D97   E8 04FBFFFF               CALL haloce.005698A0
->
005698A0   0FBFC9                    MOVSX ECX,CX ;ECX=40480026, CX=0x0026->ECX=00000026
005698A3   83C8 FF                   OR EAX,FFFFFFFF;->EAX=FFFFFFFF
005698A6   83F9 26                   CMP ECX,26 ;ECX=0x00000026 ==0x0026?      ; Switch (cases 0..26)
005698A9   77 19                     JA SHORT haloce.005698C4
005698AB   0FB689 D4985600           MOVZX ECX,BYTE PTR DS:[ECX+5698D4];[ECX=0x00000026+5698D4]->ECX=00000000
005698B2   FF248D C8985600           JMP DWORD PTR DS:[ECX*4+5698C8];[00000000*4+5698C8]->haloce.005698B9
...
005698B9   B8 19000000               MOV EAX,19 ;->EAX=0x00000019      ; Cases 0,2,3,10,11,12,13,14,15,16,25,26 of switch 005698A6
005698BE   C3                        RETN
<-
00569D9C   66:3BE8                   CMP BP,AX ;BP=0019 == AX=0019
00569D9F   74 72                     JE SHORT haloce.00569E13
...
00569E13   8A4424 17                 MOV AL,BYTE PTR SS:[ESP+17];load from stack->AL=01
00569E17   84C0                      TEST AL,AL;AL=01
00569E19   74 0F                     JE SHORT haloce.00569E2A
00569E1B   8B5C24 20                 MOV EBX,DWORD PTR SS:[ESP+20];->EBX=00000006
00569E1F   8B4424 28                 MOV EAX,DWORD PTR SS:[ESP+28];->EAX=E42401B5 (ID and index)
00569E23   8BD3                      MOV EDX,EBX ;EDX=00000006
00569E25   E8 D609F9FF               CALL haloce.004FA800
->
004FA800   8B0D B0B37F00             MOV ECX,DWORD PTR DS:[7FB3B0];object
004FA806   8B49 34                   MOV ECX,DWORD PTR DS:[ECX+34]
004FA809   53                        PUSH EBX
004FA80A   56                        PUSH ESI
004FA80B   25 FFFF0000               AND EAX,0FFFF;->EAX=000001B5
004FA810   8D0440                    LEA EAX,DWORD PTR DS:[EAX+EAX*2];->0000051F
004FA813   8B4481 08                 MOV EAX,DWORD PTR DS:[ECX+EAX*4+8];[400506EC+0000051F*4+8]->EAX=400DDA10 (tank rp_s1); vehicle object
004FA817   8B30                      MOV ESI,DWORD PTR DS:[EAX];veh BipdMetaIndex and ID->ESI=E46F02FB
004FA819   8B0D E46D8100             MOV ECX,DWORD PTR DS:[816DE4]; ptr to ECX=0x40440028 (animation ptr?)
004FA81F   81E6 FFFF0000             AND ESI,0FFFF;->ESI=000002FB
004FA825   C1E6 05                   SHL ESI,5 ;->ESI=00005F60
004FA828   8B740E 14                 MOV ESI,DWORD PTR DS:[ESI+ECX+14];[ESI=00005F60+ECX=0x40440028+0x14]->ESI=40774C40 vehicle model?
004FA82C   8B76 34                   MOV ESI,DWORD PTR DS:[ESI+34] ;[ESI=40774C40+34]->ESI=E47002FC (another index and ID)
004FA82F   81E6 FFFF0000             AND ESI,0FFFF;->ESI=000002FC
004FA835   C1E6 05                   SHL ESI,5;->ESI=00005F80
004FA838   8B4C0E 14                 MOV ECX,DWORD PTR DS:[ESI+ECX+14];[00005F80+0x40440028+0x14]->ECX=0x40775D44
004FA83C   0FBF89 B8000000           MOVSX ECX,WORD PTR DS:[ECX+B8];[0x40775D44+B8]->ECX=0000000B
004FA843   0FBFB0 EE010000           MOVSX ESI,WORD PTR DS:[EAX+1EE];[EAX=400DDA10+1EE]->ESI=000007FC
004FA84A   C1E1 05                   SHL ECX,5;->ECX=00000160rly?
004FA84D   57                        PUSH EDI ;save 40778E58 "stand"
004FA84E   0FBFB8 EA010000           MOVSX EDI,WORD PTR DS:[EAX+1EA] ;[EAX=400DDA10+1EA]->EDI=0000095C
004FA855   8BD9                      MOV EBX,ECX;->EBX=00000160
004FA857   C1E9 02                   SHR ECX,2 ;->ECX=00000058
004FA85A   03F0                      ADD ESI,EAX ;ESI=000007FC+EAX=400DDA10->ESI=400DE20C
004FA85C   03F8                      ADD EDI,EAX ;EDI=0000095C+EAX=400DDA10->EDI=400DE36C
004FA85E   F3:A5              REP MOVS DWORD PTR ES:[EDI],DWORD PTR DS:[ESI];->ECX=00000000 ESI=400DE36C EDI=400DE4CC
004FA860   8BCB                      MOV ECX,EBX;->ECX=00000160
004FA862   83E1 03                   AND ECX,3;->ECX=00000000
004FA865   F3:A4              REP MOVS BYTE PTR ES:[EDI],BYTE PTR DS:[ESI]
004FA867   0FBFB0 D4000000           MOVSX ESI,WORD PTR DS:[EAX+D4];[EAX=400DDA10+D4]->ESI=00000006
004FA86E   0FBF88 D6000000           MOVSX ECX,WORD PTR DS:[EAX+D6];[EAX=400DDA10+D6]->ECX=00000000
004FA875   2BCE                      SUB ECX,ESI;->ECX=FFFFFFFA
004FA877   0FBFF2                    MOVSX ESI,DX;->ESI=00000006
004FA87A   5F                        POP EDI;load from top of stack->EDI=40778E58 "stand"
004FA87B   3BF1                      CMP ESI,ECX ;ESI=00000006 == ECX=FFFFFFFA
004FA87D   5E                        POP ESI ;->ESI=400DDA10
004FA87E   5B                        POP EBX ;->EBX=00000006
004FA87F   7C 10                     JL SHORT haloce.004FA891
004FA881   66:C780 D4000000 0000    MOV WORD PTR DS:[EAX+D4],0;veh BitFlags_02
004FA88A   66:8990 D6000000         MOV WORD PTR DS:[EAX+D6],DX;DX=0006
004FA891   C3                       RETN
<-
00569E2A   8A4C24 2C                MOV CL,BYTE PTR SS:[ESP+2C];load from stack->CL=25
00569E2E   5F                       POP EDI;->EDI=00000EF4
00569E2F   888E A3020000            MOV BYTE PTR DS:[ESI+2A3],CL; veh obj action to 0x25
00569E35   5E                       POP ESI;->ESI=E3AE013F
00569E36   5D                       POP EBP;->EBP=0018CEBC
00569E37   B0 01                    MOV AL,1;->AL=01
00569E39   5B                       POP EBX;->EBX=40A41E2C
00569E3A   83C4 14                  ADD ESP,14;->ESP=0018CDC0
00569E3D   C3                       RETN;->0056E85D
<-
0056E85D   83C4 08                  ADD ESP,8;ESP=0018CDC4->ESP=0018CDCC
0056E860   C3                       RETN;->0056F85C
;end player is driver part

...
0056F85C   8B43 44          MOV EAX,DWORD PTR DS:[EBX+44] ;EBX=40A41E2C  +0x44= EA3808C4
0056F85F   8B5424 10        MOV EDX,DWORD PTR SS:[ESP+10] ;load from stack = 0x00000022
0056F863   6A 01            PUSH 1
0056F865   E8 569FF6FF      CALL haloce.004D97C0
->
004D97C0   8B0D E46D8100    MOV ECX,DWORD PTR DS:[816DE4] ; ptr to 0x40440028 (animation ptr?)
004D97C6   25 FFFF0000      AND EAX,0FFFF ;from EA3808C4 to 000008C4
004D97CB   C1E0 05          SHL EAX,5 ;(000008C4 * 2^5) = 00011880
004D97CE   8B4408 14        MOV EAX,DWORD PTR DS:[EAX+ECX+14] ;some object EAX=40A445B0
004D97D2   837C24 04 01     CMP DWORD PTR SS:[ESP+4],1 ;first parameter
004D97D7   75 25            JNZ SHORT haloce.004D97FE
004D97D9   8B0D 804D6B00    MOV ECX,DWORD PTR DS:[6B4D80] ;ptr to D5DD6134
004D97DF   69C9 0D661900    IMUL ECX,ECX,19660D ;D5DD6134 * 19660D = 8F0CA7A4(bytes cut off)
004D97E5   81C1 5FF36E3C    ADD ECX,3C6EF35F ;8F0CA7A4 + 3C6EF35F = CB7B9B03
004D97EB   890D 804D6B00    MOV DWORD PTR DS:[6B4D80],ECX ;change ptr to CB7B9B03
004D97F1   C1E9 10          SHR ECX,10 ;CB7B9B03 >> 0x10 = 0000CB7B
004D97F4   894C24 04        MOV DWORD PTR SS:[ESP+4],ECX ;store were 1st parameter was
004D97F8   DB4424 04        FILD DWORD PTR SS:[ESP+4] ;load it as a float (52091.0f)
004D97FC   EB 23            JMP SHORT haloce.004D9821
...
004D9821   66:83FA FF       CMP DX,0FFFF ;0x0022 != -1?
004D9825   D80D C4226100    FMUL DWORD PTR DS:[6122C4] ;ptr to 1.525902e-05 * 52091.0 = 0.7948577094357460737 (0x3F4B7BCB)
004D982B   D95C24 04        FSTP DWORD PTR SS:[ESP+4] ;store were 1st parameter used to be 
004D982F   74 38            JE SHORT haloce.004D9869
004D9831   56               PUSH ESI ;ESI=E3AE013F (player obj index)
004D9832   8B70 78          MOV ESI,DWORD PTR DS:[EAX+78] ;(EAX=40A445B0)+0x78 =[40A44628] = 40A4C8FC "B-driver enter" (seat name enter/exit animation list?)
004D9835   EB 09            JMP SHORT haloce.004D9840
...
004D9840   D94424 08        FLD DWORD PTR SS:[ESP+8] ;load 0.7948577094357460737 (0x3F4B7BCB)
004D9844   0FBFCA           MOVSX ECX,DX ;ECX = 00000022
004D9847   69C9 B4000000    IMUL ECX,ECX,0B4 ;00000022 * B4 = 17E8
004D984D   D85C31 44        FCOMP DWORD PTR DS:[ECX+ESI+44] ;ST=0.7948576807975769043 == DS:[40A4E128]=1.000000
004D9851   DFE0             FSTSW AX ;45B0
004D9853   03CE             ADD ECX,ESI ;ESI=40A4C8FC, (ASCII "B-driver enter") ECX=000017E8 ??(ASCII "W-gunner exit")
004D9855   F6C4 41          TEST AH,41 ;(EAX=40A40137) 0x01? == 0x41
004D9858   7B 0A            JPO SHORT haloce.004D9864
...
004D9864   66:8BC2          MOV AX,DX ;DX = 0022 -> (EAX=40A40022) (return val)
004D9867   5E               POP ESI ;ESI=40A4C8FC (ASCII "B-driver enter") -> ESI=E3AE013F
004D9868   C3               RETN
<-
0056F86A   8B53 44          MOV EDX,DWORD PTR DS:[EBX+44] ;EBX=40A41E2C  +0x44 ->EDX=EA3808C4
0056F86D   50               PUSH EAX ;EAX=40A40022
0056F86E   52               PUSH EDX ;EDX=EA3808C4
0056F86F   8BC6             MOV EAX,ESI ;player obj index -> EAX=E3AE013F
0056F871   E8 9A300000      CALL haloce.00572910
->
00572910   8B0D B0B37F00    MOV ECX,DWORD PTR DS:[7FB3B0] ;object 
00572916   8B51 34          MOV EDX,DWORD PTR DS:[ECX+34] ;EDX=400506EC (first obj ptr)
00572919   8B4C24 04        MOV ECX,DWORD PTR SS:[ESP+4] ;first parameter ->ECX=EA3808C4
0057291D   25 FFFF0000      AND EAX,0FFFF
00572922   8D0440           LEA EAX,DWORD PTR DS:[EAX+EAX*2]; ->EAX=000003BD
00572925   8B4482 08        MOV EAX,DWORD PTR DS:[EDX+EAX*4+8] ;[400506EC+000003BD*4+8] ->EAX=400AF1F8 (player obj)
00572929   66:8B5424 08     MOV DX,WORD PTR SS:[ESP+8] ;2nd parameter -> DX=0022
0057292E   8988 CC000000    MOV DWORD PTR DS:[EAX+CC],ECX ;ECX = EA3808C4 AntrMetaIndex (animation trigger)
00572934   66:8990 D0000000 MOV WORD PTR DS:[EAX+D0],DX ;EDX = 0x0022 BitFlags_02
0057293B   66:C780 D2000000 0000 MOV WORD PTR DS:[EAX+D2],0 ;BitFlags_02
00572944   C3               RETN
<-
0056F876   A1 B0B37F00      MOV EAX,DWORD PTR DS:[7FB3B0] ;object ->EAX=400506B4
0056F87B   8B48 34          MOV ECX,DWORD PTR DS:[EAX+34] ;object->FirstObject = OBJECT_TABLE_ARRAY (400506EC)
0056F87E   8B5C39 08        MOV EBX,DWORD PTR DS:[ECX+EDI+8] ;object->FirstObject[319].Object_ptr, EDI=00000EF4 ->(EBX=player object)
0056F882   8B13             MOV EDX,DWORD PTR DS:[EBX] ;->EDX=EA2C08B8
0056F884   A1 E46D8100      MOV EAX,DWORD PTR DS:[816DE4] ;ptr to 40440028
0056F889   81E2 FFFF0000    AND EDX,0FFFF ;->EDX=000008B8
0056F88F   C1E2 05          SHL EDX,5 ;EDX*2^5 ->EDX=00011700
0056F892   8B4402 14        MOV EAX,DWORD PTR DS:[EDX+EAX+14] ;[00011700+40440028+0x14]=[4045173C] ->EAX=40A41E2C
0056F896   8B48 34          MOV ECX,DWORD PTR DS:[EAX+34] ;[40A41E2C+0x34] ->ECX=EA2D08B9
0056F899   83C4 0C          ADD ESP,0C
0056F89C   83F9 FF          CMP ECX,-1 ;EA2D08B9 == -1?
0056F89F   894424 0C        MOV DWORD PTR SS:[ESP+C],EAX ;save to stack 40A41E2C
0056F8A3   74 36            JE SHORT haloce.0056F8DB
0056F8A5   F643 10 01       TEST BYTE PTR DS:[EBX+10],1 ;[(EBX=400AF1F8)+0x10] = 0x22(BitFlags_01) == 01?
0056F8A9   74 12            JE SHORT haloce.0056F8BD
...
0056F8BD   8378 34 FF       CMP DWORD PTR DS:[EAX+34],-1 ;[(EAX=40A41E2C)+0x34] = EA2D08B9
0056F8C1   74 18            JE SHORT haloce.0056F8DB
0056F8C3   8B0D B0B37F00    MOV ECX,DWORD PTR DS:[7FB3B0] ;object
0056F8C9   8B41 34          MOV EAX,DWORD PTR DS:[ECX+34] ;EAX=400506EC (first object)
0056F8CC   8B53 10        |-MOV EDX,DWORD PTR DS:[EBX+10] ;[EBX=400AF1F8(player obj) +0x10] -> EDX=02006922
0056F8CF   03C7           | ADD EAX,EDI ;(EAX=400506EC) + (EDI=00000EF4) -> EAX=400515E0
0056F8D1   83E2 FE        |-AND EDX,FFFFFFFE
0056F8D4   8953 10        |-MOV DWORD PTR DS:[EBX+10],EDX ;BitFlags_01 EDX=02006900
0056F8D7   8048 02 02       OR BYTE PTR DS:[EAX+2],2 ;[(EAX=400515E0)+2] = E2 -> = E2
0056F8DB   8B7C24 14        MOV EDI,DWORD PTR SS:[ESP+14] ;EDI=player obj (400E2BD8)
0056F8DF   8BCE             MOV ECX,ESI   ; ECX=E3AE013F (player obj index)
0056F8E1   C687 A3020000 1B MOV BYTE PTR DS:[EDI+2A3],1B ;Zeros_01 perform action 1B= exit vehicle?
0056F8E8   E8 83CAEBFF      CALL haloce.0042C370
->
0042C370   8B15 B0B37F00    MOV EDX,DWORD PTR DS:[7FB3B0] ;object
0042C376   8B52 34          MOV EDX,DWORD PTR DS:[EDX+34] ;->EDX=400506EC
0042C379   8BC1             MOV EAX,ECX ;->EAX=E3AE013F
0042C37B   25 FFFF0000      AND EAX,0FFFF ;->EAX=0000013F
0042C380   8D0440           LEA EAX,DWORD PTR DS:[EAX+EAX*2] ;->EAX=000003BD
0042C383   8B4482 08        MOV EAX,DWORD PTR DS:[EDX+EAX*4+8] ;->EAX=400AF1F8 (player object)(very repetitive isnt it)
0042C387   8B80 F4010000    MOV EAX,DWORD PTR DS:[EAX+1F4] ;EAX=FFFFFFFF Unknown10 0x1F4
0042C38D   83F8 FF          CMP EAX,-1 ;EAX=FFFFFFFF(-1) != -1?
0042C390   74 3E            JE SHORT haloce.0042C3D0
...
0042C3D0   C3               RETN
<-
0056F8ED   8B47 04          MOV EAX,DWORD PTR DS:[EDI+4] ;[400AF1F8+4] (player obj + 4) Zeros_00 -> EAX=00000000
0056F8F0   85C0             TEST EAX,EAX ;EAX=00000000
0056F8F2   75 0C            JNZ SHORT haloce.0056F900
0056F8F4   6A 00            PUSH 0
0056F8F6   8BCE             MOV ECX,ESI  ;player obj index ECX already is = to ESI, stupid compiler
0056F8F8   E8 B3070000      CALL haloce.005700B0
->
005700B0   83EC 0C          SUB ESP,0C
005700B3   33C0             XOR EAX,EAX ;EAX is aleady 0...
005700B5   83F9 FF          CMP ECX,-1 ;ECX=E3AE013F != -1? (I would hope not)
005700B8   74 17            JE SHORT haloce.005700D1
005700BA   56               PUSH ESI
005700BB   8B35 F0266200    MOV ESI,DWORD PTR DS:[6226F0] ; ptr to 00622668
005700C1   83C6 0C          ADD ESI,0C ;ESI=00622668 + C -> ESI=00622674
005700C4   E8 A741F8FF      CALL haloce.004F4270
->
004F4270   8A06             MOV AL,BYTE PTR DS:[ESI] ;[ESI=00622668] ->AL=01
004F4272   57               PUSH EDI
004F4273   83CF FF          OR EDI,FFFFFFFF
004F4276   3C 01            CMP AL,1
004F4278   75 27            JNZ SHORT haloce.004F42A1
004F427A   83F9 FF          CMP ECX,-1
004F427D   74 22            JE SHORT haloce.004F42A1
004F427F   85C9             TEST ECX,ECX
004F4281   8BC1             MOV EAX,ECX
004F4283   7D 02            JGE SHORT haloce.004F4287
004F4285   F7D8             NEG EAX
004F4287   99               CDQ
004F4288   F77E 04          IDIV DWORD PTR DS:[ESI+4]
004F428B   8B46 08          MOV EAX,DWORD PTR DS:[ESI+8]
004F428E   8B54D0 04        MOV EDX,DWORD PTR DS:[EAX+EDX*8+4]
004F4292   85D2             TEST EDX,EDX
004F4294   74 0B            JE SHORT haloce.004F42A1
004F4296   390A             /CMP DWORD PTR DS:[EDX],ECX
004F4298   74 0B            |JE SHORT haloce.004F42A5
...
004F42A5   8B42 04          MOV EAX,DWORD PTR DS:[EDX+4]
004F42A8   5F               POP EDI
004F42A9   C3               RETN
<-
005700C9   83F8 FF          CMP EAX,-1
005700CC   5E               POP ESI
005700CD   75 02            JNZ SHORT haloce.005700D1
...
005700D1   6A 00            PUSH 0
005700D3   6A 01            PUSH 1
005700D5   6A 00            PUSH 0
005700D7   8D5424 1C        LEA EDX,DWORD PTR SS:[ESP+1C]
005700DB   52               PUSH EDX
005700DC   894424 14        MOV DWORD PTR SS:[ESP+14],EAX
005700E0   8A4424 20        MOV AL,BYTE PTR SS:[ESP+20]
005700E4   6A 00            PUSH 0
005700E6   884424 1C        MOV BYTE PTR SS:[ESP+1C],AL
005700EA   8D4C24 18        LEA ECX,DWORD PTR SS:[ESP+18]
005700EE   6A 09            PUSH 9
005700F0   6A 00            PUSH 0
005700F2   BA F87F0000      MOV EDX,7FF8
005700F7   B8 20CE8000      MOV EAX,haloce.0080CE20
005700FC   894C24 2C        MOV DWORD PTR SS:[ESP+2C],ECX
00570100   C74424 1C 00000000 MOV DWORD PTR SS:[ESP+1C],0
00570108   E8 C304F8FF        CALL haloce.004F05D0
->
004F05D0   81EC A4000000        SUB ESP,0A4
004F05D6   53                   PUSH EBX
004F05D7   55                   PUSH EBP
004F05D8   8BAC24 BC000000      MOV EBP,DWORD PTR SS:[ESP+BC]
004F05DF   33DB                 XOR EBX,EBX
004F05E1   56                   PUSH ESI
004F05E2   8BF0                 MOV ESI,EAX
004F05E4   57                   PUSH EDI
004F05E5   33C0                 XOR EAX,EAX
004F05E7   885C24 20            MOV BYTE PTR SS:[ESP+20],BL
004F05EB   B9 24000000          MOV ECX,24
004F05F0   8D7C24 24            LEA EDI,DWORD PTR SS:[ESP+24]
004F05F4   F3:AB                REP STOS DWORD PTR ES:[EDI]
004F05F6   8B8C24 BC000000      MOV ECX,DWORD PTR SS:[ESP+BC]
004F05FD   8B048D 40BA5F00      MOV EAX,DWORD PTR DS:[ECX*4+5FBA40]
004F0604   8B40 0C              MOV EAX,DWORD PTR DS:[EAX+C]
004F0607   895424 30            MOV DWORD PTR SS:[ESP+30],EDX
004F060B   2BD0                 SUB EDX,EAX
004F060D   894C24 24            MOV DWORD PTR SS:[ESP+24],ECX
004F0611   8B8C24 B8000000      MOV ECX,DWORD PTR SS:[ESP+B8]
004F0618   895424 38            MOV DWORD PTR SS:[ESP+38],EDX
004F061C   897424 2C            MOV DWORD PTR SS:[ESP+2C],ESI
004F0620   897424 40            MOV DWORD PTR SS:[ESP+40],ESI
004F0624   8D50 FF              LEA EDX,DWORD PTR DS:[EAX-1]
004F0627   8D7424 20            LEA ESI,DWORD PTR SS:[ESP+20]
004F062B   894C24 28            MOV DWORD PTR SS:[ESP+28],ECX
004F062F   895C24 34            MOV DWORD PTR SS:[ESP+34],EBX
004F0633   895C24 58            MOV DWORD PTR SS:[ESP+58],EBX
004F0637   894424 5C            MOV DWORD PTR SS:[ESP+5C],EAX
004F063B   895C24 4C            MOV DWORD PTR SS:[ESP+4C],EBX
004F063F   895C24 48            MOV DWORD PTR SS:[ESP+48],EBX
004F0643   895C24 3C            MOV DWORD PTR SS:[ESP+3C],EBX
004F0647   895C24 44            MOV DWORD PTR SS:[ESP+44],EBX
004F064B   895424 50            MOV DWORD PTR SS:[ESP+50],EDX
004F064F   894424 54            MOV DWORD PTR SS:[ESP+54],EAX
004F0653   C64424 20 01         MOV BYTE PTR SS:[ESP+20],1
004F0658   E8 33030000          CALL haloce.004F0990
->
004F0990   51                   PUSH ECX
004F0991   A1 64826B00          MOV EAX,DWORD PTR DS:[6B8264]
004F0996   53                   PUSH EBX
004F0997   57                   PUSH EDI
004F0998   894424 08            MOV DWORD PTR SS:[ESP+8],EAX
004F099C   8B46 08              MOV EAX,DWORD PTR DS:[ESI+8]
004F099F   8D7E 1C              LEA EDI,DWORD PTR DS:[ESI+1C]
004F09A2   50                   PUSH EAX
004F09A3   8BD7                 MOV EDX,EDI
004F09A5   E8 3625FEFF          CALL haloce.004D2EE0
->
004D2EE0   53                   PUSH EBX
004D2EE1   8B5A 08              MOV EBX,DWORD PTR DS:[EDX+8]
004D2EE4   56                   PUSH ESI
004D2EE5   8B72 0C              MOV ESI,DWORD PTR DS:[EDX+C]
004D2EE8   57                   PUSH EDI
004D2EE9   8B7A 10              MOV EDI,DWORD PTR DS:[EDX+10]
004D2EEC   8D0CF7               LEA ECX,DWORD PTR DS:[EDI+ESI*8]
004D2EEF   32C0                 XOR AL,AL
004D2EF1   3BCB                 CMP ECX,EBX
004D2EF3   72 5C                JB SHORT haloce.004D2F51
004D2EF5   3B4A 14              CMP ECX,DWORD PTR DS:[EDX+14]
004D2EF8   77 57                JA SHORT haloce.004D2F51
004D2EFA   837C24 10 01         CMP DWORD PTR SS:[ESP+10],1
004D2EFF   75 11                JNZ SHORT haloce.004D2F12
...
004D2F12   8B4A 04              MOV ECX,DWORD PTR DS:[EDX+4]             ; haloce.0080CE20
004D2F15   03F1                 ADD ESI,ECX
004D2F17   8BCF                 MOV ECX,EDI
004D2F19   B0 01                MOV AL,1
004D2F1B   D2E0                 SHL AL,CL
004D2F1D   8A0E                 MOV CL,BYTE PTR DS:[ESI]
004D2F1F   F6D0                 NOT AL
004D2F21   22C8                 AND CL,AL
004D2F23   880E                 MOV BYTE PTR DS:[ESI],CL
004D2F25   8B4A 0C              MOV ECX,DWORD PTR DS:[EDX+C]
004D2F28   8B42 10              MOV EAX,DWORD PTR DS:[EDX+10]
004D2F2B   8D44C8 01            LEA EAX,DWORD PTR DS:[EAX+ECX*8+1]
004D2F2F   3B42 08              CMP EAX,DWORD PTR DS:[EDX+8]
004D2F32   72 05                JB SHORT haloce.004D2F39
004D2F34   3B42 14              CMP EAX,DWORD PTR DS:[EDX+14]
004D2F37   76 08                JBE SHORT haloce.004D2F41
...
004D2F41   8BC8                 MOV ECX,EAX
004D2F43   83E1 07              AND ECX,7
004D2F46   C1E8 03              SHR EAX,3
004D2F49   894A 10              MOV DWORD PTR DS:[EDX+10],ECX
004D2F4C   8942 0C              MOV DWORD PTR DS:[EDX+C],EAX
004D2F4F   B0 01                MOV AL,1
004D2F51   5F                   POP EDI
004D2F52   5E                   POP ESI
004D2F53   5B                   POP EBX
004D2F54   C3                   RETN
<-
004F09AA   8B96 84000000        MOV EDX,DWORD PTR DS:[ESI+84]
004F09B0   84C0                 TEST AL,AL
004F09B2   0F95C3               SETNE BL
004F09B5   83C2 06              ADD EDX,6
004F09B8   8BC2                 MOV EAX,EDX
004F09BA   50                   PUSH EAX
004F09BB   8D4E 04              LEA ECX,DWORD PTR DS:[ESI+4]
004F09BE   8BC7                 MOV EAX,EDI
004F09C0   C786 80000000 01000000 MOV DWORD PTR DS:[ESI+80],1
004F09CA   8996 84000000        MOV DWORD PTR DS:[ESI+84],EDX
004F09D0   E8 5B24FEFF          CALL haloce.004D2E30
->
004D2E30   53                   PUSH EBX
004D2E31   55                   PUSH EBP
004D2E32   8B6C24 0C            MOV EBP,DWORD PTR SS:[ESP+C]
004D2E36   85ED                 TEST EBP,EBP
004D2E38   56                   PUSH ESI
004D2E39   57                   PUSH EDI
004D2E3A   8BF0                 MOV ESI,EAX
004D2E3C   8BD9                 MOV EBX,ECX
004D2E3E   8BFD                 MOV EDI,EBP
004D2E40   7E 37                JLE SHORT haloce.004D2E79
004D2E42   83FF 20              /CMP EDI,20
004D2E45   8B13                 |MOV EDX,DWORD PTR DS:[EBX]
004D2E47   7C 21                |JL SHORT haloce.004D2E6A
...
004D2E6A   57                   PUSH EDI
004D2E6B   E8 F0000000          CALL haloce.004D2F60
->
004D2F60   8B4E 0C              MOV ECX,DWORD PTR DS:[ESI+C]
004D2F63   83EC 08              SUB ESP,8
004D2F66   53                   PUSH EBX
004D2F67   55                   PUSH EBP
004D2F68   8B6C24 14            MOV EBP,DWORD PTR SS:[ESP+14]
004D2F6C   57                   PUSH EDI
004D2F6D   8B7E 10              MOV EDI,DWORD PTR DS:[ESI+10]
004D2F70   8D1CCF               LEA EBX,DWORD PTR DS:[EDI+ECX*8]
004D2F73   8D5C2B FF            LEA EBX,DWORD PTR DS:[EBX+EBP-1]
004D2F77   32C0                 XOR AL,AL
004D2F79   3B5E 08              CMP EBX,DWORD PTR DS:[ESI+8]
004D2F7C   0F82 33010000        JB haloce.004D30B5
004D2F82   3B5E 14              CMP EBX,DWORD PTR DS:[ESI+14]
004D2F85   0F87 2A010000        JA haloce.004D30B5
004D2F8B   33DB                 XOR EBX,EBX
004D2F8D   85FF                 TEST EDI,EDI
004D2F8F   74 7C                JE SHORT haloce.004D300D
004D2F91   BB 08000000          MOV EBX,8
004D2F96   2BDF                 SUB EBX,EDI
004D2F98   3BEB                 CMP EBP,EBX
004D2F9A   73 08                JNB SHORT haloce.004D2FA4
004D2F9C   8A85 C0A85F00        MOV AL,BYTE PTR SS:[EBP+5FA8C0]
004D2FA2   EB 08                JMP SHORT haloce.004D2FAC
...
004D2FAC   8B5E 04              MOV EBX,DWORD PTR DS:[ESI+4]             ; haloce.0080CE20
004D2FAF   03D9                 ADD EBX,ECX
004D2FB1   895C24 10            MOV DWORD PTR SS:[ESP+10],EBX
004D2FB5   8AD8                 MOV BL,AL
004D2FB7   8BCF                 MOV ECX,EDI
004D2FB9   D2E3                 SHL BL,CL
004D2FBB   8B4C24 10            MOV ECX,DWORD PTR SS:[ESP+10]
004D2FBF   F6D3                 NOT BL
004D2FC1   2219                 AND BL,BYTE PTR DS:[ECX]
004D2FC3   8ACA                 MOV CL,DL
004D2FC5   22C8                 AND CL,AL
004D2FC7   8AC1                 MOV AL,CL
004D2FC9   8BCF                 MOV ECX,EDI
004D2FCB   D2E0                 SHL AL,CL
004D2FCD   8BCD                 MOV ECX,EBP
004D2FCF   D3EA                 SHR EDX,CL
004D2FD1   0AD8                 OR BL,AL
004D2FD3   8B4424 10            MOV EAX,DWORD PTR SS:[ESP+10]
004D2FD7   8818                 MOV BYTE PTR DS:[EAX],BL
004D2FD9   8B4E 0C              MOV ECX,DWORD PTR DS:[ESI+C]
004D2FDC   8B7E 10              MOV EDI,DWORD PTR DS:[ESI+10]
004D2FDF   8D44CD 00            LEA EAX,DWORD PTR SS:[EBP+ECX*8]
004D2FE3   8B4E 08              MOV ECX,DWORD PTR DS:[ESI+8]
004D2FE6   03C7                 ADD EAX,EDI
004D2FE8   3BC1                 CMP EAX,ECX
004D2FEA   8BDD                 MOV EBX,EBP
004D2FEC   72 05                JB SHORT haloce.004D2FF3
004D2FEE   3B46 14              CMP EAX,DWORD PTR DS:[ESI+14]
004D2FF1   76 08                JBE SHORT haloce.004D2FFB
004D2FF3   8B4E 14              MOV ECX,DWORD PTR DS:[ESI+14]
004D2FF6   41                   INC ECX
004D2FF7   3BC1                 CMP EAX,ECX
004D2FF9   75 0E                JNZ SHORT haloce.004D3009
004D2FFB   8BC8                 MOV ECX,EAX
004D2FFD   83E1 07              AND ECX,7
004D3000   C1E8 03              SHR EAX,3
004D3003   894E 10              MOV DWORD PTR DS:[ESI+10],ECX
004D3006   8946 0C              MOV DWORD PTR DS:[ESI+C],EAX
004D3009   8B6C24 18            MOV EBP,DWORD PTR SS:[ESP+18]
004D300D   3BDD                 CMP EBX,EBP
004D300F   0F83 9E000000        JNB haloce.004D30B3
...
004D30B3   B0 01                MOV AL,1
004D30B5   5F                   POP EDI
004D30B6   5D                   POP EBP
004D30B7   5B                   POP EBX
004D30B8   83C4 08              ADD ESP,8
004D30BB   C3                   RETN
<-
004D2E70   83C4 04              ADD ESP,4
004D2E73   84C0                 TEST AL,AL
004D2E75   74 02                JE SHORT haloce.004D2E79
004D2E77   33FF                 XOR EDI,EDI
004D2E79   8BC5                 MOV EAX,EBP
004D2E7B   2BC7                 SUB EAX,EDI
004D2E7D   5F                   POP EDI
004D2E7E   5E                   POP ESI
004D2E7F   5D                   POP EBP
004D2E80   5B                   POP EBX
004D2E81   C3                   RETN
<-
004F09D5   83C4 08              ADD ESP,8
004F09D8   85C0                 TEST EAX,EAX
004F09DA   74 08                JE SHORT haloce.004F09E4
004F09DC   84DB                 TEST BL,BL
004F09DE   74 04                JE SHORT haloce.004F09E4
004F09E0   B3 01                MOV BL,1
004F09E2   EB 02                JMP SHORT haloce.004F09E6
...
004F09E6   803D 60826B00 01     CMP BYTE PTR DS:[6B8260],1
004F09ED   75 6D                JNZ SHORT haloce.004F0A5C
...
004F0A5C   5F                   POP EDI                                  ; 0018CD9C
004F0A5D   8AC3                 MOV AL,BL
004F0A5F   5B                   POP EBX
004F0A60   59                   POP ECX
004F0A61   C3                   RETN
<-
004F065D   8B8424 CC000000      MOV EAX,DWORD PTR SS:[ESP+CC]
004F0664   3BC3                 CMP EAX,EBX
004F0666   0F8E 25010000        JLE haloce.004F0791
004F066C   8B9424 C0000000      MOV EDX,DWORD PTR SS:[ESP+C0]
004F0673   8BB424 C8000000      MOV ESI,DWORD PTR SS:[ESP+C8]
004F067A   2BD5                 SUB EDX,EBP
004F067C   8BCD                 MOV ECX,EBP
004F067E   2BF5                 SUB ESI,EBP
004F0680   894C24 10            MOV DWORD PTR SS:[ESP+10],ECX
004F0684   895424 14            MOV DWORD PTR SS:[ESP+14],EDX
004F0688   897424 1C            MOV DWORD PTR SS:[ESP+1C],ESI
004F068C   894424 18            MOV DWORD PTR SS:[ESP+18],EAX
004F0690   EB 0E                JMP SHORT haloce.004F06A0
...
004F06A0   399C24 C0000000       CMP DWORD PTR SS:[ESP+C0],EBX
004F06A7   75 04                |JNZ SHORT haloce.004F06AD
004F06A9   33FF                 |XOR EDI,EDI
004F06AB   EB 03                |JMP SHORT haloce.004F06B0
...
004F06B0   399C24 B8000000      |CMP DWORD PTR SS:[ESP+B8],EBX
004F06B7   8B29                 |MOV EBP,DWORD PTR DS:[ECX]
004F06B9   75 04                |JNZ SHORT haloce.004F06BF
004F06BB   33F6                 |XOR ESI,ESI
004F06BD   EB 03                |JMP SHORT haloce.004F06C2
...
004F06C2   8D4424 20            |LEA EAX,DWORD PTR SS:[ESP+20]
004F06C6   E8 25010000          |CALL haloce.004F07F0
->
004F07F0   8B48 08              MOV ECX,DWORD PTR DS:[EAX+8]
004F07F3   53                   PUSH EBX
004F07F4   56                   PUSH ESI
004F07F5   57                   PUSH EDI
004F07F6   33FF                 XOR EDI,EDI
004F07F8   83F9 01              CMP ECX,1
004F07FB   8978 40              MOV DWORD PTR DS:[EAX+40],EDI
004F07FE   8978 44              MOV DWORD PTR DS:[EAX+44],EDI
004F0801   75 3B                JNZ SHORT haloce.004F083E
...
004F083E   33D2                 XOR EDX,EDX
004F0840   8D48 48              LEA ECX,DWORD PTR DS:[EAX+48]
004F0843   8911                 MOV DWORD PTR DS:[ECX],EDX
004F0845   8951 04              MOV DWORD PTR DS:[ECX+4],EDX
004F0848   8951 08              MOV DWORD PTR DS:[ECX+8],EDX
004F084B   8951 0C              MOV DWORD PTR DS:[ECX+C],EDX
004F084E   8951 10              MOV DWORD PTR DS:[ECX+10],EDX
004F0851   8951 14              MOV DWORD PTR DS:[ECX+14],EDX
004F0854   8951 18              MOV DWORD PTR DS:[ECX+18],EDX
004F0857   8B70 40              MOV ESI,DWORD PTR DS:[EAX+40]
004F085A   8B48 3C              MOV ECX,DWORD PTR DS:[EAX+3C]
004F085D   8B50 18              MOV EDX,DWORD PTR DS:[EAX+18]
004F0860   03CE                 ADD ECX,ESI
004F0862   2BD6                 SUB EDX,ESI
004F0864   8B70 0C              MOV ESI,DWORD PTR DS:[EAX+C]
004F0867   8BD9                 MOV EBX,ECX
004F0869   83E3 07              AND EBX,7
004F086C   8958 74              MOV DWORD PTR DS:[EAX+74],EBX
004F086F   8BD9                 MOV EBX,ECX
004F0871   8978 64              MOV DWORD PTR DS:[EAX+64],EDI
004F0874   8948 6C              MOV DWORD PTR DS:[EAX+6C],ECX
004F0877   5F                   POP EDI
004F0878   C1EB 03              SHR EBX,3
004F087B   8970 68              MOV DWORD PTR DS:[EAX+68],ESI
004F087E   8D4C0A FF            LEA ECX,DWORD PTR DS:[EDX+ECX-1]
004F0882   8958 70              MOV DWORD PTR DS:[EAX+70],EBX
004F0885   5E                   POP ESI
004F0886   8948 78              MOV DWORD PTR DS:[EAX+78],ECX
004F0889   8950 7C              MOV DWORD PTR DS:[EAX+7C],EDX
004F088C   B0 01                MOV AL,1
004F088E   5B                   POP EBX
004F088F   C3                   RETN
<-
004F06CB   56                   |PUSH ESI
004F06CC   55                   |PUSH EBP
004F06CD   57                   |PUSH EDI
004F06CE   8D4424 2C            |LEA EAX,DWORD PTR SS:[ESP+2C]
004F06D2   E8 B9010000          |CALL haloce.004F0890
->
004F0890   83EC 08              SUB ESP,8
004F0893   53                   PUSH EBX
004F0894   55                   PUSH EBP
004F0895   56                   PUSH ESI
004F0896   8BF0                 MOV ESI,EAX
004F0898   8B46 04              MOV EAX,DWORD PTR DS:[ESI+4]
004F089B   8B0C85 40BA5F00      MOV ECX,DWORD PTR DS:[EAX*4+5FBA40]
004F08A2   8B51 1C              MOV EDX,DWORD PTR DS:[ECX+1C]
004F08A5   833A 00              CMP DWORD PTR DS:[EDX],0
004F08A8   57                   PUSH EDI
004F08A9   894C24 14            MOV DWORD PTR SS:[ESP+14],ECX
004F08AD   7E 68                JLE SHORT haloce.004F0917
...
004F0917   8B51 20              MOV EDX,DWORD PTR DS:[ECX+20]
004F091A   33C0                 XOR EAX,EAX
004F091C   B9 10000000          MOV ECX,10
004F0921   BF 10396500          MOV EDI,haloce.00653910
004F0926   F3:AB                REP STOS DWORD PTR ES:[EDI]
004F0928   8B4E 08              MOV ECX,DWORD PTR DS:[ESI+8]
004F092B   BD 01000000          MOV EBP,1
004F0930   3BCD                 CMP ECX,EBP
004F0932   0F95C3               SETNE BL
004F0935   33FF                 XOR EDI,EDI
004F0937   85D2                 TEST EDX,EDX
004F0939   895424 14            MOV DWORD PTR SS:[ESP+14],EDX
004F093D   7E 3D                JLE SHORT haloce.004F097C
004F093F   90                   NOP
004F0940   8B4C24 20            /MOV ECX,DWORD PTR SS:[ESP+20]
004F0944   8B4424 24            |MOV EAX,DWORD PTR SS:[ESP+24]
004F0948   51                   |PUSH ECX
004F0949   57                   |PUSH EDI
004F094A   E8 21010000          |CALL haloce.004F0A70
->
004F0A72   8B6C24 0C            MOV EBP,DWORD PTR SS:[ESP+C]
004F0A76   57                   PUSH EDI
004F0A77   8BF8                 MOV EDI,EAX
004F0A79   8B46 04              MOV EAX,DWORD PTR DS:[ESI+4]
004F0A7C   8B1485 40BA5F00      MOV EDX,DWORD PTR DS:[EAX*4+5FBA40]
004F0A83   8BCD                 MOV ECX,EBP
004F0A85   C1E1 04              SHL ECX,4
004F0A88   8D440A 28            LEA EAX,DWORD PTR DS:[EDX+ECX+28]
004F0A8C   8B08                 MOV ECX,DWORD PTR DS:[EAX]
004F0A8E   8B50 04              MOV EDX,DWORD PTR DS:[EAX+4]
004F0A91   32DB                 XOR BL,BL
004F0A93   85FF                 TEST EDI,EDI
004F0A95   74 07                JE SHORT haloce.004F0A9E
...
004F0A9E   33C0                 XOR EAX,EAX                              ; haloce.006362B0
004F0AA0   8D7E 64              LEA EDI,DWORD PTR DS:[ESI+64]
004F0AA3   57                   PUSH EDI
004F0AA4   8B7C24 18            MOV EDI,DWORD PTR SS:[ESP+18]
004F0AA8   03D7                 ADD EDX,EDI
004F0AAA   52                   PUSH EDX
004F0AAB   50                   PUSH EAX
004F0AAC   51                   PUSH ECX
004F0AAD   FF51 50              CALL DWORD PTR DS:[ECX+50]
->
004ED830   8B5424 08            MOV EDX,DWORD PTR SS:[ESP+8]
004ED834   85D2                 TEST EDX,EDX
004ED836   8B4424 04            MOV EAX,DWORD PTR SS:[ESP+4]
004ED83A   8B40 58              MOV EAX,DWORD PTR DS:[EAX+58]
004ED83D   8B4C24 0C            MOV ECX,DWORD PTR SS:[ESP+C]
004ED841   74 08                JE SHORT haloce.004ED84B
...
004ED84B   8B50 08              MOV EDX,DWORD PTR DS:[EAX+8]
004ED84E   8B4424 10            MOV EAX,DWORD PTR SS:[ESP+10]
004ED852   52                   PUSH EDX
004ED853   E8 D855FEFF          CALL haloce.004D2E30
->
004D2E30   53                   PUSH EBX
004D2E31   55                   PUSH EBP
004D2E32   8B6C24 0C            MOV EBP,DWORD PTR SS:[ESP+C]
004D2E36   85ED                 TEST EBP,EBP
004D2E38   56                   PUSH ESI
004D2E39   57                   PUSH EDI
004D2E3A   8BF0                 MOV ESI,EAX
004D2E3C   8BD9                 MOV EBX,ECX
004D2E3E   8BFD                 MOV EDI,EBP
004D2E40   7E 37                JLE SHORT haloce.004D2E79
004D2E42   83FF 20              /CMP EDI,20
004D2E45   8B13                 |MOV EDX,DWORD PTR DS:[EBX]
004D2E47   7C 21                |JL SHORT haloce.004D2E6A
...
004D2E6A   57                   PUSH EDI
004D2E6B   E8 F0000000          CALL haloce.004D2F60
->
004D2F60   8B4E 0C              MOV ECX,DWORD PTR DS:[ESI+C]
004D2F63   83EC 08              SUB ESP,8
004D2F66   53                   PUSH EBX
004D2F67   55                   PUSH EBP
004D2F68   8B6C24 14            MOV EBP,DWORD PTR SS:[ESP+14]
004D2F6C   57                   PUSH EDI
004D2F6D   8B7E 10              MOV EDI,DWORD PTR DS:[ESI+10]
004D2F70   8D1CCF               LEA EBX,DWORD PTR DS:[EDI+ECX*8]
004D2F73   8D5C2B FF            LEA EBX,DWORD PTR DS:[EBX+EBP-1]
004D2F77   32C0                 XOR AL,AL
004D2F79   3B5E 08              CMP EBX,DWORD PTR DS:[ESI+8]
004D2F7C   0F82 33010000        JB haloce.004D30B5
004D2F82   3B5E 14              CMP EBX,DWORD PTR DS:[ESI+14]
004D2F85   0F87 2A010000        JA haloce.004D30B5
004D2F8B   33DB                 XOR EBX,EBX
004D2F8D   85FF                 TEST EDI,EDI
004D2F8F   74 7C                JE SHORT haloce.004D300D
004D2F91   BB 08000000          MOV EBX,8
004D2F96   2BDF                 SUB EBX,EDI
004D2F98   3BEB                 CMP EBP,EBX
004D2F9A   73 08                JNB SHORT haloce.004D2FA4
...
004D2FA4   8A83 C0A85F00        MOV AL,BYTE PTR DS:[EBX+5FA8C0]
004D2FAA   8BEB                 MOV EBP,EBX
004D2FAC   8B5E 04              MOV EBX,DWORD PTR DS:[ESI+4]
004D2FAF   03D9                 ADD EBX,ECX
004D2FB1   895C24 10            MOV DWORD PTR SS:[ESP+10],EBX
004D2FB5   8AD8                 MOV BL,AL
004D2FB7   8BCF                 MOV ECX,EDI
004D2FB9   D2E3                 SHL BL,CL
004D2FBB   8B4C24 10            MOV ECX,DWORD PTR SS:[ESP+10]
004D2FBF   F6D3                 NOT BL
004D2FC1   2219                 AND BL,BYTE PTR DS:[ECX]
004D2FC3   8ACA                 MOV CL,DL
004D2FC5   22C8                 AND CL,AL
004D2FC7   8AC1                 MOV AL,CL
004D2FC9   8BCF                 MOV ECX,EDI
004D2FCB   D2E0                 SHL AL,CL
004D2FCD   8BCD                 MOV ECX,EBP
004D2FCF   D3EA                 SHR EDX,CL
004D2FD1   0AD8                 OR BL,AL
004D2FD3   8B4424 10            MOV EAX,DWORD PTR SS:[ESP+10]
004D2FD7   8818                 MOV BYTE PTR DS:[EAX],BL
004D2FD9   8B4E 0C              MOV ECX,DWORD PTR DS:[ESI+C]
004D2FDC   8B7E 10              MOV EDI,DWORD PTR DS:[ESI+10]
004D2FDF   8D44CD 00            LEA EAX,DWORD PTR SS:[EBP+ECX*8]
004D2FE3   8B4E 08              MOV ECX,DWORD PTR DS:[ESI+8]
004D2FE6   03C7                 ADD EAX,EDI
004D2FE8   3BC1                 CMP EAX,ECX
004D2FEA   8BDD                 MOV EBX,EBP
004D2FEC   72 05                JB SHORT haloce.004D2FF3
004D2FEE   3B46 14              CMP EAX,DWORD PTR DS:[ESI+14]
004D2FF1   76 08                JBE SHORT haloce.004D2FFB
...
004D2FFB   8BC8                 MOV ECX,EAX
004D2FFD   83E1 07              AND ECX,7
004D3000   C1E8 03              SHR EAX,3
004D3003   894E 10              MOV DWORD PTR DS:[ESI+10],ECX
004D3006   8946 0C              MOV DWORD PTR DS:[ESI+C],EAX
004D3009   8B6C24 18            MOV EBP,DWORD PTR SS:[ESP+18]
004D300D   3BDD                 CMP EBX,EBP
004D300F   0F83 9E000000        JNB haloce.004D30B3
004D3015   8B4E 04              /MOV ECX,DWORD PTR DS:[ESI+4]
004D3018   8B46 0C              |MOV EAX,DWORD PTR DS:[ESI+C]
004D301B   8BFD                 |MOV EDI,EBP
004D301D   2BFB                 |SUB EDI,EBX
004D301F   83FF 08              |CMP EDI,8
004D3022   72 37                |JB SHORT haloce.004D305B
004D3024   881408               |MOV BYTE PTR DS:[EAX+ECX],DL
004D3027   8B4E 10              |MOV ECX,DWORD PTR DS:[ESI+10]
004D302A   8B46 0C              |MOV EAX,DWORD PTR DS:[ESI+C]
004D302D   8D44C1 08            |LEA EAX,DWORD PTR DS:[ECX+EAX*8+8]
004D3031   8B4E 08              |MOV ECX,DWORD PTR DS:[ESI+8]
004D3034   C1EA 08              |SHR EDX,8
004D3037   83C3 08              |ADD EBX,8
004D303A   3BC1                 |CMP EAX,ECX
004D303C   72 05                |JB SHORT haloce.004D3043
004D303E   3B46 14              |CMP EAX,DWORD PTR DS:[ESI+14]
004D3041   76 08                |JBE SHORT haloce.004D304B
...
004D304B   8BC8                 |MOV ECX,EAX
004D304D   83E1 07              |AND ECX,7
004D3050   C1E8 03              |SHR EAX,3
004D3053   894E 10              |MOV DWORD PTR DS:[ESI+10],ECX
004D3056   8946 0C              |MOV DWORD PTR DS:[ESI+C],EAX
004D3059   EB 50                |JMP SHORT haloce.004D30AB
...
004D30AB   3BDD                 |CMP EBX,EBP
004D30AD  ^0F82 62FFFFFF        \JB haloce.004D3015
004D30B3   B0 01                MOV AL,1
004D30B5   5F                   POP EDI
004D30B6   5D                   POP EBP
004D30B7   5B                   POP EBX
004D30B8   83C4 08              ADD ESP,8
004D30BB   C3                   RETN
<-
004D2E70   83C4 04              ADD ESP,4
004D2E73   84C0                 TEST AL,AL
004D2E75   74 02                JE SHORT haloce.004D2E79
004D2E77   33FF                 XOR EDI,EDI
004D2E79   8BC5                 MOV EAX,EBP
004D2E7B   2BC7                 SUB EAX,EDI
004D2E7D   5F                   POP EDI
004D2E7E   5E                   POP ESI
004D2E7F   5D                   POP EBP
004D2E80   5B                   POP EBX
004D2E81   C3                   RETN
<-
004ED858   83C4 04              ADD ESP,4
004ED85B   C3                   RETN
<-
004F0AB0   8BF8                 MOV EDI,EAX
004F0AB2   8B46 08              MOV EAX,DWORD PTR DS:[ESI+8]
004F0AB5   83C4 10              ADD ESP,10
004F0AB8   83F8 01              CMP EAX,1
004F0ABB   75 20                JNZ SHORT haloce.004F0ADD
...
004F0ADD   85FF                 TEST EDI,EDI
004F0ADF   7E 02                JLE SHORT haloce.004F0AE3
004F0AE1   B3 01                MOV BL,1
004F0AE3   8B4E 44              MOV ECX,DWORD PTR DS:[ESI+44]
004F0AE6   03CF                 ADD ECX,EDI
004F0AE8   85FF                 TEST EDI,EDI
004F0AEA   894E 44              MOV DWORD PTR DS:[ESI+44],ECX
004F0AED   0F95C1               SETNE CL
004F0AF0   5F                   POP EDI
004F0AF1   888D 10396500        MOV BYTE PTR SS:[EBP+653910],CL
004F0AF7   5D                   POP EBP
004F0AF8   8AC3                 MOV AL,BL
004F0AFA   5B                   POP EBX
004F0AFB   C3                   RETN
<-
004F094F   8B4E 08              |MOV ECX,DWORD PTR DS:[ESI+8]
004F0952   83C4 08              |ADD ESP,8
004F0955   3BCD                 |CMP ECX,EBP
004F0957   75 0C                |JNZ SHORT haloce.004F0965
...
004F0965   84DB                 |TEST BL,BL
004F0967   74 08                |JE SHORT haloce.004F0971
004F0969   84C0                 |TEST AL,AL
004F096B   74 04                |JE SHORT haloce.004F0971
004F096D   B3 01                |MOV BL,1
004F096F   EB 02                |JMP SHORT haloce.004F0973
...
004F0973   8B4424 14            |MOV EAX,DWORD PTR SS:[ESP+14]
004F0977   47                   |INC EDI
004F0978   3BF8                 |CMP EDI,EAX
004F097A  ^7C C4                \JL SHORT haloce.004F0940
...
004F0940   8B4C24 20            /MOV ECX,DWORD PTR SS:[ESP+20]
004F0944   8B4424 24            |MOV EAX,DWORD PTR SS:[ESP+24]
004F0948   51                   |PUSH ECX
004F0949   57                   |PUSH EDI
004F094A   E8 21010000          |CALL haloce.004F0A70
->
004F0A70   53                   PUSH EBX
004F0A71   55                   PUSH EBP
004F0A72   8B6C24 0C            MOV EBP,DWORD PTR SS:[ESP+C]
004F0A76   57                   PUSH EDI
004F0A77   8BF8                 MOV EDI,EAX
004F0A79   8B46 04              MOV EAX,DWORD PTR DS:[ESI+4]
004F0A7C   8B1485 40BA5F00      MOV EDX,DWORD PTR DS:[EAX*4+5FBA40]
004F0A83   8BCD                 MOV ECX,EBP
004F0A85   C1E1 04              SHL ECX,4
004F0A88   8D440A 28            LEA EAX,DWORD PTR DS:[EDX+ECX+28]
004F0A8C   8B08                 MOV ECX,DWORD PTR DS:[EAX]
004F0A8E   8B50 04              MOV EDX,DWORD PTR DS:[EAX+4]
004F0A91   32DB                 XOR BL,BL
004F0A93   85FF                 TEST EDI,EDI
004F0A95   74 07                JE SHORT haloce.004F0A9E
...
004F0A9E   33C0                 XOR EAX,EAX                              ; haloce.006362C0
004F0AA0   8D7E 64              LEA EDI,DWORD PTR DS:[ESI+64]
004F0AA3   57                   PUSH EDI
004F0AA4   8B7C24 18            MOV EDI,DWORD PTR SS:[ESP+18]
004F0AA8   03D7                 ADD EDX,EDI
004F0AAA   52                   PUSH EDX
004F0AAB   50                   PUSH EAX
004F0AAC   51                   PUSH ECX
004F0AAD   FF51 50              CALL DWORD PTR DS:[ECX+50] ;ECX=00622950 haloce.004EC920  
->
004EC920   8B5424 08            MOV EDX,DWORD PTR SS:[ESP+8]
004EC924   8B4C24 0C            MOV ECX,DWORD PTR SS:[ESP+C]
004EC928   8A09                 MOV CL,BYTE PTR DS:[ECX]
004EC92A   33C0                 XOR EAX,EAX
004EC92C   85D2                 TEST EDX,EDX
004EC92E   74 04                JE SHORT haloce.004EC934
...
004EC934   0FB6D1               MOVZX EDX,CL
004EC937   56                   PUSH ESI
004EC938   52                   PUSH EDX
004EC939   8B5424 18            MOV EDX,DWORD PTR SS:[ESP+18]
004EC93D   33F6                 XOR ESI,ESI
004EC93F   E8 9C65FEFF          CALL haloce.004D2EE0
->
004D2EE0   53                   PUSH EBX
004D2EE1   8B5A 08              MOV EBX,DWORD PTR DS:[EDX+8]
004D2EE4   56                   PUSH ESI
004D2EE5   8B72 0C              MOV ESI,DWORD PTR DS:[EDX+C]
004D2EE8   57                   PUSH EDI
004D2EE9   8B7A 10              MOV EDI,DWORD PTR DS:[EDX+10]
004D2EEC   8D0CF7               LEA ECX,DWORD PTR DS:[EDI+ESI*8]
004D2EEF   32C0                 XOR AL,AL
004D2EF1   3BCB                 CMP ECX,EBX
004D2EF3   72 5C                JB SHORT haloce.004D2F51
004D2EF5   3B4A 14              CMP ECX,DWORD PTR DS:[EDX+14]
004D2EF8   77 57                JA SHORT haloce.004D2F51
004D2EFA   837C24 10 01         CMP DWORD PTR SS:[ESP+10],1
004D2EFF   75 11                JNZ SHORT haloce.004D2F12
...
004D2F12   8B4A 04              MOV ECX,DWORD PTR DS:[EDX+4]             ; haloce.0080CE20
004D2F15   03F1                 ADD ESI,ECX
004D2F17   8BCF                 MOV ECX,EDI
004D2F19   B0 01                MOV AL,1
004D2F1B   D2E0                 SHL AL,CL
004D2F1D   8A0E                 MOV CL,BYTE PTR DS:[ESI]
004D2F1F   F6D0                 NOT AL
004D2F21   22C8                 AND CL,AL
004D2F23   880E                 MOV BYTE PTR DS:[ESI],CL
004D2F25   8B4A 0C              MOV ECX,DWORD PTR DS:[EDX+C]
004D2F28   8B42 10              MOV EAX,DWORD PTR DS:[EDX+10]
004D2F2B   8D44C8 01            LEA EAX,DWORD PTR DS:[EAX+ECX*8+1]
004D2F2F   3B42 08              CMP EAX,DWORD PTR DS:[EDX+8]
004D2F32   72 05                JB SHORT haloce.004D2F39
004D2F34   3B42 14              CMP EAX,DWORD PTR DS:[EDX+14]
004D2F37   76 08                JBE SHORT haloce.004D2F41
...
004D2F41   8BC8                 MOV ECX,EAX
004D2F43   83E1 07              AND ECX,7
004D2F46   C1E8 03              SHR EAX,3
004D2F49   894A 10              MOV DWORD PTR DS:[EDX+10],ECX
004D2F4C   8942 0C              MOV DWORD PTR DS:[EDX+C],EAX
004D2F4F   B0 01                MOV AL,1
004D2F51   5F                   POP EDI
004D2F52   5E                   POP ESI
004D2F53   5B                   POP EBX
004D2F54   C3                   RETN
<-
004EC944   83C4 04              ADD ESP,4
004EC947   84C0                 TEST AL,AL
004EC949   74 05                JE SHORT haloce.004EC950
004EC94B   BE 01000000          MOV ESI,1
004EC950   8BC6                 MOV EAX,ESI
004EC952   5E                   POP ESI
004EC953   C3                   RETN
<-
004F0AB0   8BF8                 MOV EDI,EAX
004F0AB2   8B46 08              MOV EAX,DWORD PTR DS:[ESI+8]
004F0AB5   83C4 10              ADD ESP,10
004F0AB8   83F8 01              CMP EAX,1
004F0ABB   75 20                JNZ SHORT haloce.004F0ADD
...
004F0ADD   85FF                 TEST EDI,EDI
004F0ADF   7E 02                JLE SHORT haloce.004F0AE3
004F0AE1   B3 01                MOV BL,1
004F0AE3   8B4E 44              MOV ECX,DWORD PTR DS:[ESI+44]
004F0AE6   03CF                 ADD ECX,EDI
004F0AE8   85FF                 TEST EDI,EDI
004F0AEA   894E 44              MOV DWORD PTR DS:[ESI+44],ECX
004F0AED   0F95C1               SETNE CL
004F0AF0   5F                   POP EDI
004F0AF1   888D 10396500        MOV BYTE PTR SS:[EBP+653910],CL
004F0AF7   5D                   POP EBP
004F0AF8   8AC3                 MOV AL,BL
004F0AFA   5B                   POP EBX
004F0AFB   C3                   RETN
<-
004F094F   8B4E 08              |MOV ECX,DWORD PTR DS:[ESI+8]
004F0952   83C4 08              |ADD ESP,8
004F0955   3BCD                 |CMP ECX,EBP
004F0957   75 0C                |JNZ SHORT haloce.004F0965
...
004F0965   84DB                 |TEST BL,BL
004F0967   74 08                |JE SHORT haloce.004F0971
004F0969   84C0                 |TEST AL,AL
004F096B   74 04                |JE SHORT haloce.004F0971
004F096D   B3 01                |MOV BL,1
004F096F   EB 02                |JMP SHORT haloce.004F0973
...
004F0973   8B4424 14            |MOV EAX,DWORD PTR SS:[ESP+14]
004F0977   47                   |INC EDI
004F0978   3BF8                 |CMP EDI,EAX
004F097A  ^7C C4                \JL SHORT haloce.004F0940
004F097C   5F                   POP EDI
004F097D   5E                   POP ESI
004F097E   5D                   POP EBP
004F097F   8AC3                 MOV AL,BL
004F0981   5B                   POP EBX
004F0982   83C4 08              ADD ESP,8
004F0985   C3                   RETN
<-
004F06D7   8B4424 70            |MOV EAX,DWORD PTR SS:[ESP+70]
004F06DB   83C4 0C              |ADD ESP,0C
004F06DE   3BC3                 |CMP EAX,EBX
004F06E0   7F 09                |JG SHORT haloce.004F06EB
...
004F06EB   8B4C24 60            |MOV ECX,DWORD PTR SS:[ESP+60]
004F06EF   8B7C24 34            |MOV EDI,DWORD PTR SS:[ESP+34]
004F06F3   8B7424 38            |MOV ESI,DWORD PTR SS:[ESP+38]
004F06F7   8B5424 5C            |MOV EDX,DWORD PTR SS:[ESP+5C]
004F06FB   03C1                 |ADD EAX,ECX
004F06FD   8B4C24 58            |MOV ECX,DWORD PTR SS:[ESP+58]
004F0701   03F8                 |ADD EDI,EAX
004F0703   2BF0                 |SUB ESI,EAX
004F0705   03D0                 |ADD EDX,EAX
004F0707   41                   |INC ECX
004F0708   897C24 34            |MOV DWORD PTR SS:[ESP+34],EDI
004F070C   897424 38            |MOV DWORD PTR SS:[ESP+38],ESI
004F0710   895424 5C            |MOV DWORD PTR SS:[ESP+5C],EDX
004F0714   894C24 58            |MOV DWORD PTR SS:[ESP+58],ECX
004F0718   837C24 28 01         |CMP DWORD PTR SS:[ESP+28],1
004F071D   75 23                |JNZ SHORT haloce.004F0742
...
004F0742   8B4C24 10            |MOV ECX,DWORD PTR SS:[ESP+10]
004F0746   8B4424 18            |MOV EAX,DWORD PTR SS:[ESP+18]
004F074A   83C1 04              |ADD ECX,4
004F074D   48                   |DEC EAX
004F074E   C78424 84000000 FFFF>|MOV DWORD PTR SS:[ESP+84],-1
004F0759   899C24 88000000      |MOV DWORD PTR SS:[ESP+88],EBX
004F0760   899C24 8C000000      |MOV DWORD PTR SS:[ESP+8C],EBX
004F0767   899C24 90000000      |MOV DWORD PTR SS:[ESP+90],EBX
004F076E   899C24 94000000      |MOV DWORD PTR SS:[ESP+94],EBX
004F0775   899C24 98000000      |MOV DWORD PTR SS:[ESP+98],EBX
004F077C   899C24 9C000000      |MOV DWORD PTR SS:[ESP+9C],EBX
004F0783   894C24 10            |MOV DWORD PTR SS:[ESP+10],ECX
004F0787   894424 18            |MOV DWORD PTR SS:[ESP+18],EAX
004F078B  ^0F85 01FFFFFF        \JNZ haloce.004F0692
004F0791   8B4C24 34            MOV ECX,DWORD PTR SS:[ESP+34]
004F0795   8B5424 24            MOV EDX,DWORD PTR SS:[ESP+24]
004F0799   8B3C95 40BA5F00      MOV EDI,DWORD PTR DS:[EDX*4+5FBA40]
004F07A0   33C0                 XOR EAX,EAX
004F07A2   3BCB                 CMP ECX,EBX
004F07A4   7E 37                JLE SHORT haloce.004F07DD
004F07A6   8B47 14              MOV EAX,DWORD PTR DS:[EDI+14]
004F07A9   83F8 01              CMP EAX,1
004F07AC   7E 28                JLE SHORT haloce.004F07D6
...
004F07D6   8B47 0C              MOV EAX,DWORD PTR DS:[EDI+C]
004F07D9   034424 34            ADD EAX,DWORD PTR SS:[ESP+34]
004F07DD   5F                   POP EDI
004F07DE   5E                   POP ESI
004F07DF   5D                   POP EBP
004F07E0   5B                   POP EBX
004F07E1   81C4 A4000000        ADD ESP,0A4
004F07E7   C3                   RETN
<-
0057010D   83C4 1C              ADD ESP,1C
00570110   85C0                 TEST EAX,EAX
00570112   7E 1D                JLE SHORT haloce.00570131
00570114   8B0D 84736B00        MOV ECX,DWORD PTR DS:[6B7384]            ; haloce.007FC340
0057011A   6A 03                PUSH 3
0057011C   6A 00                PUSH 0
0057011E   6A 00                PUSH 0
00570120   6A 01                PUSH 1
00570122   68 20CE8000          PUSH haloce.0080CE20
00570127   6A 01                PUSH 1
00570129   E8 0251F7FF          CALL haloce.004E5230
->
004E5230   83EC 08              SUB ESP,8
004E5233   53                   PUSH EBX
004E5234   55                   PUSH EBP
004E5235   8B6C24 28            MOV EBP,DWORD PTR SS:[ESP+28]
004E5239   56                   PUSH ESI
004E523A   8BF1                 MOV ESI,ECX
004E523C   57                   PUSH EDI
004E523D   8BD8                 MOV EBX,EAX
004E523F   C64424 12 01         MOV BYTE PTR SS:[ESP+12],1
004E5244   81C6 F8030000        ADD ESI,3F8
004E524A   C74424 14 10000000   MOV DWORD PTR SS:[ESP+14],10
004E5252   85F6                 /TEST ESI,ESI
004E5254   74 04                |JE SHORT haloce.004E525A
004E5256   8B06                 |MOV EAX,DWORD PTR DS:[ESI]
004E5258   EB 02                |JMP SHORT haloce.004E525C
...
004E525C   32C9                 |XOR CL,CL
004E525E   85C0                 |TEST EAX,EAX
004E5260   74 06                |JE SHORT haloce.004E5268
004E5262   8A88 980A0000        |MOV CL,BYTE PTR DS:[EAX+A98]
004E5268   66:8B46 0E           |MOV AX,WORD PTR DS:[ESI+E]
004E526C   8AD0                 |MOV DL,AL
004E526E   D0EA                 |SHR DL,1
004E5270   F6C2 01              |TEST DL,1
004E5273   74 5E                |JE SHORT haloce.004E52D3
004E5275   C0E8 02              |SHR AL,2
004E5278   A8 01                |TEST AL,1
004E527A   74 57                |JE SHORT haloce.004E52D3
004E527C   80F9 01              |CMP CL,1
004E527F   75 09                |JNZ SHORT haloce.004E528A
004E5281   0FB64424 2C          |MOVZX EAX,BYTE PTR SS:[ESP+2C]
004E5286   85C0                 |TEST EAX,EAX
004E5288   74 49                |JE SHORT haloce.004E52D3
...
004E52D3   8B4424 14            |MOV EAX,DWORD PTR SS:[ESP+14]
004E52D7   83C6 60              |ADD ESI,60
004E52DA   48                   |DEC EAX
004E52DB   894424 14            |MOV DWORD PTR SS:[ESP+14],EAX
004E52DF  ^0F85 6DFFFFFF        \JNZ haloce.004E5252
...
004E5252   85F6                 /TEST ESI,ESI
004E5254   74 04                |JE SHORT haloce.004E525A
004E5256   8B06                 |MOV EAX,DWORD PTR DS:[ESI]
004E5258   EB 02                |JMP SHORT haloce.004E525C
...
004E525C   32C9                 |XOR CL,CL
004E525E   85C0                 |TEST EAX,EAX
004E5260   74 06                |JE SHORT haloce.004E5268
...
004E5268   66:8B46 0E           |MOV AX,WORD PTR DS:[ESI+E]
004E526C   8AD0                 |MOV DL,AL
004E526E   D0EA                 |SHR DL,1
004E5270   F6C2 01              |TEST DL,1
004E5273   74 5E                |JE SHORT haloce.004E52D3
...
004E52D3   8B4424 14            |MOV EAX,DWORD PTR SS:[ESP+14]
004E52D7   83C6 60              |ADD ESI,60
004E52DA   48                   |DEC EAX
004E52DB   894424 14            |MOV DWORD PTR SS:[ESP+14],EAX
004E52DF  ^0F85 6DFFFFFF        \JNZ haloce.004E5252
...
004E5252   85F6                 /TEST ESI,ESI
004E5254   74 04                |JE SHORT haloce.004E525A
004E5256   8B06                 |MOV EAX,DWORD PTR DS:[ESI]
004E5258   EB 02                |JMP SHORT haloce.004E525C
...
004E525C   32C9                 |XOR CL,CL
004E525E   85C0                 |TEST EAX,EAX
004E5260   74 06                |JE SHORT haloce.004E5268
...
004E5268   66:8B46 0E           |MOV AX,WORD PTR DS:[ESI+E]
004E526C   8AD0                 |MOV DL,AL
004E526E   D0EA                 |SHR DL,1
004E5270   F6C2 01              |TEST DL,1
004E5273   74 5E                |JE SHORT haloce.004E52D3
...
004E52D3   8B4424 14            |MOV EAX,DWORD PTR SS:[ESP+14]
004E52D7   83C6 60              |ADD ESI,60
004E52DA   48                   |DEC EAX
004E52DB   894424 14            |MOV DWORD PTR SS:[ESP+14],EAX
004E52DF  ^0F85 6DFFFFFF        \JNZ haloce.004E5252
...
004E5252   85F6                 /TEST ESI,ESI
004E5254   74 04                |JE SHORT haloce.004E525A
004E5256   8B06                 |MOV EAX,DWORD PTR DS:[ESI]
004E5258   EB 02                |JMP SHORT haloce.004E525C
...
004E525C   32C9                 |XOR CL,CL
004E525E   85C0                 |TEST EAX,EAX
004E5260   74 06                |JE SHORT haloce.004E5268
...
004E5268   66:8B46 0E           |MOV AX,WORD PTR DS:[ESI+E]
004E526C   8AD0                 |MOV DL,AL
004E526E   D0EA                 |SHR DL,1
004E5270   F6C2 01              |TEST DL,1
004E5273   74 5E                |JE SHORT haloce.004E52D3
...
004E52D3   8B4424 14            |MOV EAX,DWORD PTR SS:[ESP+14]
004E52D7   83C6 60              |ADD ESI,60
004E52DA   48                   |DEC EAX
004E52DB   894424 14            |MOV DWORD PTR SS:[ESP+14],EAX
004E52DF  ^0F85 6DFFFFFF        \JNZ haloce.004E5252
...
004E5252   85F6                 /TEST ESI,ESI
004E5254   74 04                |JE SHORT haloce.004E525A
004E5256   8B06                 |MOV EAX,DWORD PTR DS:[ESI]
004E5258   EB 02                |JMP SHORT haloce.004E525C
...
004E525C   32C9                 |XOR CL,CL
004E525E   85C0                 |TEST EAX,EAX
004E5260   74 06                |JE SHORT haloce.004E5268
...
004E5268   66:8B46 0E           |MOV AX,WORD PTR DS:[ESI+E]
004E526C   8AD0                 |MOV DL,AL
004E526E   D0EA                 |SHR DL,1
004E5270   F6C2 01              |TEST DL,1
004E5273   74 5E                |JE SHORT haloce.004E52D3
...
004E52D3   8B4424 14            |MOV EAX,DWORD PTR SS:[ESP+14]
004E52D7   83C6 60              |ADD ESI,60
004E52DA   48                   |DEC EAX
004E52DB   894424 14            |MOV DWORD PTR SS:[ESP+14],EAX
004E52DF  ^0F85 6DFFFFFF        \JNZ haloce.004E5252
...
004E5252   85F6                 /TEST ESI,ESI
004E5254   74 04                |JE SHORT haloce.004E525A
004E5256   8B06                 |MOV EAX,DWORD PTR DS:[ESI]
004E5258   EB 02                |JMP SHORT haloce.004E525C
...
004E525C   32C9                 |XOR CL,CL
004E525E   85C0                 |TEST EAX,EAX
004E5260   74 06                |JE SHORT haloce.004E5268
...
004E5268   66:8B46 0E           |MOV AX,WORD PTR DS:[ESI+E]
004E526C   8AD0                 |MOV DL,AL
004E526E   D0EA                 |SHR DL,1
004E5270   F6C2 01              |TEST DL,1
004E5273   74 5E                |JE SHORT haloce.004E52D3
...
004E52D3   8B4424 14            |MOV EAX,DWORD PTR SS:[ESP+14]
004E52D7   83C6 60              |ADD ESI,60
004E52DA   48                   |DEC EAX
004E52DB   894424 14            |MOV DWORD PTR SS:[ESP+14],EAX
004E52DF  ^0F85 6DFFFFFF        \JNZ haloce.004E5252
...
004E5252   85F6                 /TEST ESI,ESI
004E5254   74 04                |JE SHORT haloce.004E525A
004E5256   8B06                 |MOV EAX,DWORD PTR DS:[ESI]
004E5258   EB 02                |JMP SHORT haloce.004E525C
...
004E525C   32C9                 |XOR CL,CL
004E525E   85C0                 |TEST EAX,EAX
004E5260   74 06                |JE SHORT haloce.004E5268
...
004E5260   74 06                |JE SHORT haloce.004E5268
004E5262   8A88 980A0000        |MOV CL,BYTE PTR DS:[EAX+A98]
004E5268   66:8B46 0E           |MOV AX,WORD PTR DS:[ESI+E]
004E526C   8AD0                 |MOV DL,AL
004E526E   D0EA                 |SHR DL,1
004E5270   F6C2 01              |TEST DL,1
004E5273   74 5E                |JE SHORT haloce.004E52D3
...
004E52D3   8B4424 14            |MOV EAX,DWORD PTR SS:[ESP+14]
004E52D7   83C6 60              |ADD ESI,60
004E52DA   48                   |DEC EAX
004E52DB   894424 14            |MOV DWORD PTR SS:[ESP+14],EAX
004E52DF  ^0F85 6DFFFFFF        \JNZ haloce.004E5252
...
*9
...
004E52E5   8A4424 12            MOV AL,BYTE PTR SS:[ESP+12]
004E52E9   5F                   POP EDI                                  ; 400E2BD8
004E52EA   5E                   POP ESI
004E52EB   5D                   POP EBP
004E52EC   5B                   POP EBX
004E52ED   83C4 08              ADD ESP,8
004E52F0   C3                   RETN
<-
0057012E   83C4 18              ADD ESP,18
00570131   83C4 0C              ADD ESP,0C
00570134   C3                   RETN
<-
0056F8FD   83C4 04              ADD ESP,4
0056F900   5F                   POP EDI
0056F901   5E                   POP ESI
0056F902   5B                   POP EBX
0056F903   8BE5                 MOV ESP,EBP
0056F905   5D                   POP EBP
0056F906   C3                   RETN
<-
;end exit vehicle function




0047ED93   8BCE                 MOV ECX,ESI
0047ED95   33C0                 XOR EAX,EAX
0047ED97   5E                   POP ESI
0047ED98   E9 F3E50000          JMP haloce.0048D390
...
0048D390   81E1 FFFF0000        AND ECX,0FFFF
0048D396   56                   PUSH ESI
0048D397   8BF1                 MOV ESI,ECX
0048D399   8B0D B0558100        MOV ECX,DWORD PTR DS:[8155B0] ;hs thread
0048D39F   69F6 18020000        IMUL ESI,ESI,218
0048D3A5   57                   PUSH EDI
0048D3A6   8B79 34              MOV EDI,DWORD PTR DS:[ECX+34]
0048D3A9   8B5437 10            MOV EDX,DWORD PTR DS:[EDI+ESI+10]
0048D3AD   8B4A 04              MOV ECX,DWORD PTR DS:[EDX+4]
0048D3B0   8B15 B4558100        MOV EDX,DWORD PTR DS:[8155B4] ;script node
0048D3B6   8B52 34              MOV EDX,DWORD PTR DS:[EDX+34]
0048D3B9   03FE                 ADD EDI,ESI
0048D3BB   81E1 FFFF0000        AND ECX,0FFFF
0048D3C1   8D0C89               LEA ECX,DWORD PTR DS:[ECX+ECX*4]
0048D3C4   8D0C8A               LEA ECX,DWORD PTR DS:[EDX+ECX*4]
0048D3C7   F641 06 02           TEST BYTE PTR DS:[ECX+6],2
0048D3CB   0FBF51 02            MOVSX EDX,WORD PTR DS:[ECX+2]
0048D3CF   75 0C                JNZ SHORT haloce.0048D3DD
0048D3D1   8B1495 18416200      MOV EDX,DWORD PTR DS:[EDX*4+624118]
0048D3D8   66:8B12              MOV DX,WORD PTR DS:[EDX]
0048D3DB   EB 16                JMP SHORT haloce.0048D3F3
...
0048D3F3   66:8B49 04           MOV CX,WORD PTR DS:[ECX+4]
0048D3F7   66:3BD1              CMP DX,CX
0048D3FA   74 47                JE SHORT haloce.0048D443
...
0048D443   8B4F 10              MOV ECX,DWORD PTR DS:[EDI+10]
0048D446   8B11                 MOV EDX,DWORD PTR DS:[ECX]
0048D448   8B4A 08              MOV ECX,DWORD PTR DS:[EDX+8]
0048D44B   8B15 B0558100        MOV EDX,DWORD PTR DS:[8155B0] ;hs thread
0048D451   8901                 MOV DWORD PTR DS:[ECX],EAX
0048D453   8B42 34              MOV EAX,DWORD PTR DS:[EDX+34]
0048D456   8B4C30 10            MOV ECX,DWORD PTR DS:[EAX+ESI+10]
0048D45A   8B11                 MOV EDX,DWORD PTR DS:[ECX]
0048D45C   03C6                 ADD EAX,ESI
0048D45E   5F                   POP EDI
0048D45F   8950 10              MOV DWORD PTR DS:[EAX+10],EDX
0048D462   5E                   POP ESI
0048D463   C3                   RETN
<-
0048D1E6   83C4 0C              ADD ESP,0C
0048D1E9   EB 53                JMP SHORT haloce.0048D23E
...
0048D23E   8B4E 10              MOV ECX,DWORD PTR DS:[ESI+10]
0048D241   8D46 18              LEA EAX,DWORD PTR DS:[ESI+18]
0048D244   3BC8                 CMP ECX,EAX
0048D246  ^0F85 14FFFFFF        JNZ haloce.0048D160
...
0048D160   8B4E 08              MOV ECX,DWORD PTR DS:[ESI+8]
0048D163   85C9                 TEST ECX,ECX
0048D165   0F8C E1000000        JL haloce.0048D24C
0048D16B   A1 90CD6800          MOV EAX,DWORD PTR DS:[68CD90]
0048D170   8038 00              CMP BYTE PTR DS:[EAX],0
0048D173   74 17                JE SHORT haloce.0048D18C
0048D175   8A50 01              MOV DL,BYTE PTR DS:[EAX+1]
0048D178   84D2                 TEST DL,DL
0048D17A   75 07                JNZ SHORT haloce.0048D183
...
0048D183   3B48 0C              CMP ECX,DWORD PTR DS:[EAX+C]
0048D186   0F8F C0000000        JG haloce.0048D24C
0048D18C   A0 38C56400          MOV AL,BYTE PTR DS:[64C538]
0048D191   84C0                 TEST AL,AL
0048D193   0F84 B3000000        JE haloce.0048D24C
0048D199   8B4E 10              MOV ECX,DWORD PTR DS:[ESI+10]
0048D19C   8B41 04              MOV EAX,DWORD PTR DS:[ECX+4]
0048D19F   25 FFFF0000          AND EAX,0FFFF
0048D1A4   8D1480               LEA EDX,DWORD PTR DS:[EAX+EAX*4]
0048D1A7   A1 B4558100          MOV EAX,DWORD PTR DS:[8155B4]
0048D1AC   8B40 34              MOV EAX,DWORD PTR DS:[EAX+34]
0048D1AF   8D0490               LEA EAX,DWORD PTR DS:[EAX+EDX*4]
0048D1B2   8A56 03              MOV DL,BYTE PTR DS:[ESI+3]
0048D1B5   66:C741 0C 0000      MOV WORD PTR DS:[ECX+C],0
0048D1BB   8066 03 FE           AND BYTE PTR DS:[ESI+3],0FE
0048D1BF   8A48 06              MOV CL,BYTE PTR DS:[EAX+6]
0048D1C2   0FBF40 02            MOVSX EAX,WORD PTR DS:[EAX+2]
0048D1C6   80E2 01              AND DL,1
0048D1C9   F6C1 02              TEST CL,2
0048D1CC   885424 14            MOV BYTE PTR SS:[ESP+14],DL
0048D1D0   75 19                JNZ SHORT haloce.0048D1EB
0048D1D2   0FBFC8               MOVSX ECX,AX
0048D1D5   8B148D 18416200      MOV EDX,DWORD PTR DS:[ECX*4+624118]
0048D1DC   8B4C24 14            MOV ECX,DWORD PTR SS:[ESP+14]
0048D1E0   51                   PUSH ECX
0048D1E1   57                   PUSH EDI
0048D1E2   50                   PUSH EAX
0048D1E3   FF52 0C              CALL DWORD PTR DS:[EDX+C] ;EDX=005F5DD8   haloce.0048C8D0
->
0048C8D0   8B0D B0558100        MOV ECX,DWORD PTR DS:[8155B0] ;hs thread
0048C8D6   8B51 34              MOV EDX,DWORD PTR DS:[ECX+34]
0048C8D9   81EC 00040000        SUB ESP,400
0048C8DF   53                   PUSH EBX
0048C8E0   56                   PUSH ESI
0048C8E1   8BB424 10040000      MOV ESI,DWORD PTR SS:[ESP+410]
0048C8E8   8BC6                 MOV EAX,ESI
0048C8EA   25 FFFF0000          AND EAX,0FFFF
0048C8EF   69C0 18020000        IMUL EAX,EAX,218
0048C8F5   8B4C10 10            MOV ECX,DWORD PTR DS:[EAX+EDX+10]
0048C8F9   8D4410 10            LEA EAX,DWORD PTR DS:[EAX+EDX+10]
0048C8FD   33D2                 XOR EDX,EDX
0048C8FF   66:8B51 0C           MOV DX,WORD PTR DS:[ECX+C]
0048C903   57                   PUSH EDI
0048C904   0FBFFA               MOVSX EDI,DX
0048C907   8D5C0F 0E            LEA EBX,DWORD PTR DS:[EDI+ECX+E]
0048C90B   83C2 04              ADD EDX,4
0048C90E   66:8951 0C           MOV WORD PTR DS:[ECX+C],DX
0048C912   8B10                 MOV EDX,DWORD PTR DS:[EAX]
0048C914   8A8C24 18040000      MOV CL,BYTE PTR SS:[ESP+418]
0048C91B   8B42 04              MOV EAX,DWORD PTR DS:[EDX+4]
0048C91E   25 FFFF0000          AND EAX,0FFFF
0048C923   84C9                 TEST CL,CL
0048C925   8B0D B4558100        MOV ECX,DWORD PTR DS:[8155B4] ;script node
0048C92B   8B49 34              MOV ECX,DWORD PTR DS:[ECX+34]
0048C92E   8D0480               LEA EAX,DWORD PTR DS:[EAX+EAX*4]
0048C931   8B4481 10            MOV EAX,DWORD PTR DS:[ECX+EAX*4+10]
0048C935   74 1D                JE SHORT haloce.0048C954
...
0048C954   25 FFFF0000          AND EAX,0FFFF
0048C959   8D1480               LEA EDX,DWORD PTR DS:[EAX+EAX*4]
0048C95C   8B4491 08            MOV EAX,DWORD PTR DS:[ECX+EDX*4+8]
0048C960   25 FFFF0000          AND EAX,0FFFF
0048C965   8D0480               LEA EAX,DWORD PTR DS:[EAX+EAX*4]
0048C968   8D0481               LEA EAX,DWORD PTR DS:[ECX+EAX*4]
0048C96B   0FBF48 04            MOVSX ECX,WORD PTR DS:[EAX+4]
0048C96F   8B148D 38716200      MOV EDX,DWORD PTR DS:[ECX*4+627138]
0048C976   85D2                 TEST EDX,EDX
0048C978   74 3B                JE SHORT haloce.0048C9B5
...
0048C9B5   33C0                 XOR EAX,EAX
0048C9B7   8BCE                 MOV ECX,ESI
0048C9B9   E8 D2090000          CALL haloce.0048D390
->
0048D390   81E1 FFFF0000        AND ECX,0FFFF
0048D396   56                   PUSH ESI
0048D397   8BF1                 MOV ESI,ECX
0048D399   8B0D B0558100        MOV ECX,DWORD PTR DS:[8155B0] ;hs thread
0048D39F   69F6 18020000        IMUL ESI,ESI,218
0048D3A5   57                   PUSH EDI
0048D3A6   8B79 34              MOV EDI,DWORD PTR DS:[ECX+34]
0048D3A9   8B5437 10            MOV EDX,DWORD PTR DS:[EDI+ESI+10]
0048D3AD   8B4A 04              MOV ECX,DWORD PTR DS:[EDX+4]
0048D3B0   8B15 B4558100        MOV EDX,DWORD PTR DS:[8155B4] ;script node
0048D3B6   8B52 34              MOV EDX,DWORD PTR DS:[EDX+34]
0048D3B9   03FE                 ADD EDI,ESI
0048D3BB   81E1 FFFF0000        AND ECX,0FFFF
0048D3C1   8D0C89               LEA ECX,DWORD PTR DS:[ECX+ECX*4]
0048D3C4   8D0C8A               LEA ECX,DWORD PTR DS:[EDX+ECX*4]
0048D3C7   F641 06 02           TEST BYTE PTR DS:[ECX+6],2
0048D3CB   0FBF51 02            MOVSX EDX,WORD PTR DS:[ECX+2]
0048D3CF   75 0C                JNZ SHORT haloce.0048D3DD
0048D3D1   8B1495 18416200      MOV EDX,DWORD PTR DS:[EDX*4+624118]      ; haloce.005F5DD8
0048D3D8   66:8B12              MOV DX,WORD PTR DS:[EDX]
0048D3DB   EB 16                JMP SHORT haloce.0048D3F3
...
0048D3F3   66:8B49 04           MOV CX,WORD PTR DS:[ECX+4]
0048D3F7   66:3BD1              CMP DX,CX
0048D3FA   74 47                JE SHORT haloce.0048D443
...
0048D443   8B4F 10              MOV ECX,DWORD PTR DS:[EDI+10]
0048D446   8B11                 MOV EDX,DWORD PTR DS:[ECX]
0048D448   8B4A 08              MOV ECX,DWORD PTR DS:[EDX+8]
0048D44B   8B15 B0558100        MOV EDX,DWORD PTR DS:[8155B0] ;hs thread
0048D451   8901                 MOV DWORD PTR DS:[ECX],EAX
0048D453   8B42 34              MOV EAX,DWORD PTR DS:[EDX+34]
0048D456   8B4C30 10            MOV ECX,DWORD PTR DS:[EAX+ESI+10]
0048D45A   8B11                 MOV EDX,DWORD PTR DS:[ECX]
0048D45C   03C6                 ADD EAX,ESI
0048D45E   5F                   POP EDI
0048D45F   8950 10              MOV DWORD PTR DS:[EAX+10],EDX
0048D462   5E                   POP ESI
0048D463   C3                   RETN
<-
0048C9BE   5F                   POP EDI
0048C9BF   5E                   POP ESI
0048C9C0   5B                   POP EBX
0048C9C1   81C4 00040000        ADD ESP,400
0048C9C7   C3                   RETN
<-
0048D1E6   83C4 0C              ADD ESP,0C
0048D1E9   EB 53                JMP SHORT haloce.0048D23E
...
0048D23E   8B4E 10              MOV ECX,DWORD PTR DS:[ESI+10]
0048D241   8D46 18              LEA EAX,DWORD PTR DS:[ESI+18]
0048D244   3BC8                 CMP ECX,EAX
0048D246  ^0F85 14FFFFFF        JNZ haloce.0048D160
0048D24C   8B4E 10              MOV ECX,DWORD PTR DS:[ESI+10]
0048D24F   8D46 18              LEA EAX,DWORD PTR DS:[ESI+18]
0048D252   3BC8                 CMP ECX,EAX
0048D254   75 40                JNZ SHORT haloce.0048D296
...
0048D286   3C 02                CMP AL,2
0048D288   75 0C                JNZ SHORT haloce.0048D296
0048D28A   A1 B0558100          MOV EAX,DWORD PTR DS:[8155B0]
0048D28F   8BD7                 MOV EDX,EDI
0048D291   E8 BA670400          CALL haloce.004D3A50
->
004D3A50   56                   PUSH ESI
004D3A51   8BF2                 MOV ESI,EDX
004D3A53   C1FE 10              SAR ESI,10
004D3A56   66:85D2              TEST DX,DX
004D3A59   57                   PUSH EDI
004D3A5A   7C 25                JL SHORT haloce.004D3A81
004D3A5C   66:3B50 2E           CMP DX,WORD PTR DS:[EAX+2E]
004D3A60   7D 1F                JGE SHORT haloce.004D3A81
004D3A62   0FBF48 22            MOVSX ECX,WORD PTR DS:[EAX+22]
004D3A66   0FBFFA               MOVSX EDI,DX
004D3A69   0FAFCF               IMUL ECX,EDI
004D3A6C   0348 34              ADD ECX,DWORD PTR DS:[EAX+34]
004D3A6F   66:8B39              MOV DI,WORD PTR DS:[ECX]
004D3A72   66:85FF              TEST DI,DI
004D3A75   74 0A                JE SHORT haloce.004D3A81
004D3A77   66:85F6              TEST SI,SI
004D3A7A   74 07                JE SHORT haloce.004D3A83
004D3A7C   66:3BF7              CMP SI,DI
004D3A7F   74 02                JE SHORT haloce.004D3A83
...
;004D3A81 33 C9            xor         ecx,ecx  crashes halo
...
004D3A83   66:C701 0000         MOV WORD PTR DS:[ECX],0
004D3A88   66:3B50 2C           CMP DX,WORD PTR DS:[EAX+2C]
004D3A8C   7D 04                JGE SHORT haloce.004D3A92
004D3A8E   66:8950 2C           MOV WORD PTR DS:[EAX+2C],DX
004D3A92   0FBF70 2E            MOVSX ESI,WORD PTR DS:[EAX+2E]
004D3A96   0FBFD2               MOVSX EDX,DX
004D3A99   42                   INC EDX
004D3A9A   5F                   POP EDI
004D3A9B   3BD6                 CMP EDX,ESI
004D3A9D   5E                   POP ESI
004D3A9E   75 17                JNZ SHORT haloce.004D3AB7
004D3AA0   0FBF50 22            MOVSX EDX,WORD PTR DS:[EAX+22]
004D3AA4   2BCA                 /SUB ECX,EDX
004D3AA6   66:FF48 2E           |DEC WORD PTR DS:[EAX+2E]
004D3AAA   66:8378 2E 00        |CMP WORD PTR DS:[EAX+2E],0
004D3AAF   7E 06                |JLE SHORT haloce.004D3AB7
004D3AB1   66:8339 00           |CMP WORD PTR DS:[ECX],0
004D3AB5  ^74 ED                \JE SHORT haloce.004D3AA4
004D3AB7   66:FF48 30           DEC WORD PTR DS:[EAX+30]
004D3ABB   C3                   RETN
<-
0048D296   5F                   POP EDI
0048D297   5E                   POP ESI
0048D298   5D                   POP EBP
0048D299   66:C705 3AC56400 FFF>MOV WORD PTR DS:[64C53A],0FFFF
0048D2A2   5B                   POP EBX
0048D2A3   83C4 08              ADD ESP,8
0048D2A6   C3                   RETN
<-
0048CFFF   83C4 04              ADD ESP,4
0048D002   5B                   POP EBX
0048D003   5F                   POP EDI
0048D004   5E                   POP ESI
0048D005   83C8 FF              OR EAX,FFFFFFFF
0048D008   5D                   POP EBP
0048D009   C3                   RETN
<-
0048729D   83C4 04              ADD ESP,4
004872A0   EB 1F                JMP SHORT haloce.004872C1
...
004872C1   381D 2DC56400        CMP BYTE PTR DS:[64C52D],BL
004872C7   8B3D C0F05D00        MOV EDI,DWORD PTR DS:[<&KERNEL32.GlobalF>; kernel32.GlobalFree
004872CD   74 1F                JE SHORT haloce.004872EE
...
004872EE   381D 2CC56400        CMP BYTE PTR DS:[64C52C],BL
004872F4   74 15                JE SHORT haloce.0048730B
...
0048730B   881D 08C46400        MOV BYTE PTR DS:[64C408],BL
00487311   5F                   POP EDI
00487312   381D F8C36400        CMP BYTE PTR DS:[64C3F8],BL
00487318   5E                   POP ESI
00487319   74 1E                JE SHORT haloce.00487339
...
00487339   8A4424 0B            MOV AL,BYTE PTR SS:[ESP+B]
0048733D   5D                   POP EBP
0048733E   5B                   POP EBX
0048733F   81C4 0C080000        ADD ESP,80C
00487345   C3                   RETN
<-
004CA09E   83C4 04              ADD ESP,4
004CA0A1   5E                   POP ESI
004CA0A2   881D 1DB36A00        MOV BYTE PTR DS:[6AB31D],BL
004CA0A8   5B                   POP EBX
004CA0A9   81C4 00050000        ADD ESP,500
004CA0AF   C3                   RETN
<- EAX=FFFFFF01








