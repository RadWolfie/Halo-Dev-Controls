;notes by Jesus7Freak
;haloce1.09 rpg_beta6_2
;console 004C9BE3

...1 ;inspect
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F5DD8   haloce.0048C8D0
...2 ;sv_say
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F9A24   haloce.00485AE0
...3 ;sv_say
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F9A24   haloce.00485AE0
...4 ;inspect
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F5DD8   haloce.0048C8D0

...3 ;sv_say
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F9A24   haloce.00485AE0
->
00485AE0   0FBF4424 04      MOVSX EAX,WORD PTR SS:[ESP+4]
00485AE5   8B0485 18416200  MOV EAX,DWORD PTR DS:[EAX*4+624118]
00485AEC   8B4C24 0C        MOV ECX,DWORD PTR SS:[ESP+C]
00485AF0   56               PUSH ESI
00485AF1   8B7424 0C        MOV ESI,DWORD PTR SS:[ESP+C]
00485AF5   51               PUSH ECX
00485AF6   8D50 1C          LEA EDX,DWORD PTR DS:[EAX+1C]
00485AF9   0FBF40 1A        MOVSX EAX,WORD PTR DS:[EAX+1A]
00485AFD   52               PUSH EDX
00485AFE   50               PUSH EAX
00485AFF   56               PUSH ESI
00485B00   E8 9B7A0000      CALL haloce.0048D5A0
00485B05   83C4 10          ADD ESP,10
00485B08   85C0             TEST EAX,EAX
00485B0A   74 11            JE SHORT haloce.00485B1D
;sv_say
00485B0C   8B08             MOV ECX,DWORD PTR DS:[EAX] ;ECX=404E5CEE "test str"
00485B0E   E8 DD0B0600      CALL haloce.004E66F0
->
 004E66F0   51               PUSH ECX
 004E66F1   66:833D D0476B00>CMP WORD PTR DS:[6B47D0],2 ;server check 2=server or hosting
 004E66F9   75 2F            JNZ SHORT haloce.004E672A
 004E66FB   8BC1             MOV EAX,ECX
 004E66FD   56               PUSH ESI
 004E66FE   8D70 01          LEA ESI,DWORD PTR DS:[EAX+1]
 004E6701   8A10             MOV DL,BYTE PTR DS:[EAX]
 004E6703   40               INC EAX
 004E6704   84D2             TEST DL,DL
 004E6706  ^75 F9            JNZ SHORT haloce.004E6701
 004E6708   2BC6             SUB EAX,ESI ;string size->EAX=00000008
 004E670A   894424 04        MOV DWORD PTR SS:[ESP+4],EAX ;Stack SS:[0018CEBC]
 004E670E   5E               POP ESI
 004E670F   74 08            JE SHORT haloce.004E6719
 004E6711   83C4 04          ADD ESP,4
 004E6714  ^E9 377BFCFF      JMP haloce.004AE250
 ...;send sv message?
 004AE250   81EC 28020000    SUB ESP,228
 004AE256   53               PUSH EBX
 004AE257   55               PUSH EBP
 004AE258   51               PUSH ECX
 004AE259   8D4424 34        LEA EAX,DWORD PTR SS:[ESP+34] ;->EAX=0018CCC0
 004AE25D   BA FF000000      MOV EDX,0FF
 004AE262   68 C0A36000      PUSH haloce.0060A3C0                     ; UNICODE "%S"
 004AE267   50               PUSH EAX
 004AE268   C74424 30 030000>MOV DWORD PTR SS:[ESP+30],3 ;Stack SS:[0018CCB4]
 004AE270   885424 34        MOV BYTE PTR SS:[ESP+34],DL ;Stack SS:[0018CCB8]
 004AE274   894424 38        MOV DWORD PTR SS:[ESP+38],EAX ;Stack SS:[0018CCBC]
 004AE278   E8 63D10A00      CALL haloce.0055B3E0
 ->
  0055B3E0   8B4C24 08        MOV ECX,DWORD PTR SS:[ESP+8] ;->ECX=0060A3C0 L"%S"
  0055B3E4   8D4424 0C        LEA EAX,DWORD PTR SS:[ESP+C] ;->EAX=0018CC8C
  0055B3E8   50               PUSH EAX
  0055B3E9   8B4424 08        MOV EAX,DWORD PTR SS:[ESP+8] ;->EAX=0018CCC0
  0055B3ED   51               PUSH ECX
  0055B3EE   52               PUSH EDX ;000000FF
  0055B3EF   50               PUSH EAX
  0055B3F0   E8 18170700      CALL haloce.005CCB0D ;convert to unicode
  0055B3F5   83C4 10          ADD ESP,10
  0055B3F8   C3               RETN  ;[0018CC84] 0018CCC0 L"test str"
 <- 
 004AE27D   33DB             XOR EBX,EBX
 004AE27F   53               PUSH EBX
 004AE280   6A 01            PUSH 1
 004AE282   53               PUSH EBX
 004AE283   8D5424 24        LEA EDX,DWORD PTR SS:[ESP+24] ;->EDX=0018CC9C ptr to chat info
 004AE287   52               PUSH EDX
 004AE288   53               PUSH EBX
 004AE289   8D4C24 44        LEA ECX,DWORD PTR SS:[ESP+44] ;->ECX=0018CCB4 chat info { chat type=3, (char)from player index=-1, wchar_t *sv_msg }
 004AE28D   6A 0F            PUSH 0F
 004AE28F   53               PUSH EBX
 004AE290   BA F87F0000      MOV EDX,7FF8
 004AE295   B8 20CE8000      MOV EAX,haloce.0080CE20
 004AE29A   66:899C24 560200>MOV WORD PTR SS:[ESP+256],BX ;Stack SS:[0018CEBE]
 004AE2A2   894C24 34        MOV DWORD PTR SS:[ESP+34],ECX ;Stack SS:[0018CC9C]
 004AE2A6   895C24 38        MOV DWORD PTR SS:[ESP+38],EBX ;Stack SS:[0018CCA0]
 004AE2AA   E8 21230400      CALL haloce.004F05D0
 004AE2AF   8BE8             MOV EBP,EAX ;->EBP=0000009F
 004AE2B1   83C4 28          ADD ESP,28
 004AE2B4   3BEB             CMP EBP,EBX ;== 0?
 004AE2B6   896C24 0C        MOV DWORD PTR SS:[ESP+C],EBP
 004AE2BA   0F8E 05010000    JLE haloce.004AE3C5
 004AE2C0   A1 C0558100      MOV EAX,DWORD PTR DS:[8155C0]
 004AE2C5   56               PUSH ESI
 004AE2C6   8B35 84736B00    MOV ESI,DWORD PTR DS:[6B7384]            ; haloce.007FC340
 004AE2CC   894424 18        MOV DWORD PTR SS:[ESP+18],EAX
 004AE2D0   57               PUSH EDI
 004AE2D1   35 72657469      XOR EAX,69746572
 004AE2D6   8D7C24 1C        LEA EDI,DWORD PTR SS:[ESP+1C]
 004AE2DA   897424 18        MOV DWORD PTR SS:[ESP+18],ESI
 004AE2DE   66:895C24 20     MOV WORD PTR SS:[ESP+20],BX
 004AE2E3   C74424 24 FFFFFF>MOV DWORD PTR SS:[ESP+24],-1
 004AE2EB   894424 28        MOV DWORD PTR SS:[ESP+28],EAX
 004AE2EF   E8 1C580200      CALL haloce.004D3B10
 004AE2F4   3BC3             CMP EAX,EBX
 004AE2F6   0F84 C7000000    JE haloce.004AE3C3
 004AE2FC   EB 12            JMP SHORT haloce.004AE310
 004AE2FE   8B6C24 14        MOV EBP,DWORD PTR SS:[ESP+14]
 004AE302   8B7424 18        MOV ESI,DWORD PTR SS:[ESP+18]
 004AE306   EB 08            JMP SHORT haloce.004AE310
 004AE308   8DA424 00000000  LEA ESP,DWORD PTR SS:[ESP]
 004AE30F   90               NOP
 004AE310   0FBE50 64        MOVSX EDX,BYTE PTR DS:[EAX+64]
 004AE314   83FA FF          CMP EDX,-1
 004AE317   0F84 95000000    JE haloce.004AE3B2
 004AE31D   33C0             XOR EAX,EAX
 004AE31F   8D8E 04040000    LEA ECX,DWORD PTR DS:[ESI+404]
 004AE325   0FBF39           MOVSX EDI,WORD PTR DS:[ECX]
 004AE328   3BFA             CMP EDI,EDX
 004AE32A   74 0B            JE SHORT haloce.004AE337
 004AE32C   40               INC EAX
 004AE32D   83C1 60          ADD ECX,60
 004AE330   83F8 10          CMP EAX,10
 004AE333  ^7C F0            JL SHORT haloce.004AE325
 004AE335   EB 7B            JMP SHORT haloce.004AE3B2
 004AE337   8D0440           LEA EAX,DWORD PTR DS:[EAX+EAX*2]
 004AE33A   C1E0 05          SHL EAX,5
 004AE33D   8D8430 F8030000  LEA EAX,DWORD PTR DS:[EAX+ESI+3F8]
 004AE344   3BC3             CMP EAX,EBX
 004AE346   74 6A            JE SHORT haloce.004AE3B2
 004AE348   8B38             MOV EDI,DWORD PTR DS:[EAX]
 004AE34A   3BFB             CMP EDI,EBX
 004AE34C   74 64            JE SHORT haloce.004AE3B2
 004AE34E   8A87 8C0A0000    MOV AL,BYTE PTR DS:[EDI+A8C]
 004AE354   45               INC EBP
 004AE355   A8 01            TEST AL,1
 004AE357   C64424 13 01     MOV BYTE PTR SS:[ESP+13],1
 004AE35C   75 54            JNZ SHORT haloce.004AE3B2
 004AE35E   8B4F 1C          MOV ECX,DWORD PTR DS:[EDI+1C]
 004AE361   8B57 24          MOV EDX,DWORD PTR DS:[EDI+24]
 004AE364   8B47 20          MOV EAX,DWORD PTR DS:[EDI+20]
 004AE367   8D77 10          LEA ESI,DWORD PTR DS:[EDI+10]
 004AE36A   C1E1 03          SHL ECX,3
 004AE36D   2BD1             SUB EDX,ECX
 004AE36F   2BD0             SUB EDX,EAX
 004AE371   42               INC EDX
 004AE372   3BEA             CMP EBP,EDX
 004AE374   7E 0F            JLE SHORT haloce.004AE385
 004AE376   6A 01            PUSH 1
 004AE378   57               PUSH EDI
 004AE379   E8 E22D0300      CALL haloce.004E1160
 004AE37E   83C4 08          ADD ESP,8
 004AE381   3AC3             CMP AL,BL
 004AE383   74 2D            JE SHORT haloce.004AE3B2
 004AE385   01AF 800A0000    ADD DWORD PTR DS:[EDI+A80],EBP
 004AE38B   6A 01            PUSH 1
 004AE38D   8D4C24 17        LEA ECX,DWORD PTR SS:[ESP+17]
 004AE391   8BC6             MOV EAX,ESI
 004AE393   E8 984A0200      CALL haloce.004D2E30
 004AE398   8B4424 18        MOV EAX,DWORD PTR SS:[ESP+18]
 004AE39C   50               PUSH EAX
 004AE39D   B9 20CE8000      MOV ECX,haloce.0080CE20
 004AE3A2   8BC6             MOV EAX,ESI
 004AE3A4   885E 1C          MOV BYTE PTR DS:[ESI+1C],BL
 004AE3A7   E8 844A0200      CALL haloce.004D2E30
 004AE3AC   83C4 08          ADD ESP,8
 004AE3AF   885E 1C          MOV BYTE PTR DS:[ESI+1C],BL
 004AE3B2   8D7C24 1C        LEA EDI,DWORD PTR SS:[ESP+1C]
 004AE3B6   E8 55570200      CALL haloce.004D3B10
 004AE3BB   3BC3             CMP EAX,EBX
 004AE3BD  ^0F85 3BFFFFFF    JNZ haloce.004AE2FE
 004AE3C3   5F               POP EDI
 004AE3C4   5E               POP ESI
 004AE3C5   5D               POP EBP
 004AE3C6   5B               POP EBX
 004AE3C7   81C4 28020000    ADD ESP,228
 004AE3CD   C3               RETN
 ;004E6719   68 50D46000      PUSH haloce.0060D450                     ; ASCII "sv_say: must specify a message"
 ;004E671E   33C0             XOR EAX,EAX
 ;004E6720   E8 5B35FBFF      CALL haloce.00499C80
 ;004E6725   83C4 04          ADD ESP,4
 ;004E6728   59               POP ECX
 ;004E6729   C3               RETN
 ;004E672A   A1 BC076200      MOV EAX,DWORD PTR DS:[6207BC]
 ;004E672F   68 1C0F6000      PUSH haloce.00600F1C                     ; ASCII "sv_say"
 ;004E6734   68 30D46000      PUSH haloce.0060D430                     ; ASCII "%s is a server-only function!"
 ;004E6739   E8 4235FBFF      CALL haloce.00499C80
 ;004E673E   83C4 08          ADD ESP,8
 ;004E6741   59               POP ECX
 ;004E6742   C3               RETN
<-
00485B13   8BCE             MOV ECX,ESI
00485B15   33C0             XOR EAX,EAX
00485B17   5E               POP ESI
00485B18   E9 73780000      JMP haloce.0048D390
00485B1D   5E               POP ESI
00485B1E   C3               RETN

