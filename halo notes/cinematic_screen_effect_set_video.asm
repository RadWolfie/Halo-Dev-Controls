;notes by Jesus7Freak
;haloce1.09 p0 rpg_beta6_2
;console 004C9BE3

...1 ;inspect
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F5DD8   haloce.0048C8D0
...2 ;cinematic_screen_effect_set_video
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F8E68   haloce.004840B0
...3 ;cinematic_screen_effect_set_video
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F8E68   haloce.004840B0
...4 ;cinematic_screen_effect_set_video
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F8E68   haloce.004840B0
...5 ;inspect
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F5DD8   haloce.0048C8D0


...2
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F8E68   haloce.004840B0

004840B0   0FBF4424 04      MOVSX EAX,WORD PTR SS:[ESP+4]
004840B5   8B0485 18416200  MOV EAX,DWORD PTR DS:[EAX*4+624118]
004840BC   8B4C24 0C        MOV ECX,DWORD PTR SS:[ESP+C]
004840C0   56               PUSH ESI
004840C1   8B7424 0C        MOV ESI,DWORD PTR SS:[ESP+C]
004840C5   51               PUSH ECX
004840C6   8D50 1C          LEA EDX,DWORD PTR DS:[EAX+1C]
004840C9   0FBF40 1A        MOVSX EAX,WORD PTR DS:[EAX+1A]
004840CD   52               PUSH EDX
004840CE   50               PUSH EAX
004840CF   56               PUSH ESI
004840D0   E8 CB940000      CALL haloce.0048D5A0
004840D5   83C4 10          ADD ESP,10
004840D8   85C0             TEST EAX,EAX ;EAX=00000000
004840DA   74 1C            JE SHORT haloce.004840F8
;004840DC   8B48 04          MOV ECX,DWORD PTR DS:[EAX+4]
;004840DF   33D2             XOR EDX,EDX
;004840E1   66:8B10          MOV DX,WORD PTR DS:[EAX]
;004840E4   51               PUSH ECX
;004840E5   52               PUSH EDX
;004840E6   E8 751E0900      CALL haloce.00515F60
;004840EB   83C4 08          ADD ESP,8
;004840EE   8BCE             MOV ECX,ESI
;004840F0   33C0             XOR EAX,EAX
;004840F2   5E               POP ESI
;004840F3   E9 98920000      JMP haloce.0048D390
004840F8   5E               POP ESI
004840F9   C3               RETN

...3
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F8E68   haloce.004840B0

004840B0   0FBF4424 04      MOVSX EAX,WORD PTR SS:[ESP+4]
004840B5   8B0485 18416200  MOV EAX,DWORD PTR DS:[EAX*4+624118]
004840BC   8B4C24 0C        MOV ECX,DWORD PTR SS:[ESP+C]
004840C0   56               PUSH ESI
004840C1   8B7424 0C        MOV ESI,DWORD PTR SS:[ESP+C]
004840C5   51               PUSH ECX
004840C6   8D50 1C          LEA EDX,DWORD PTR DS:[EAX+1C]
004840C9   0FBF40 1A        MOVSX EAX,WORD PTR DS:[EAX+1A]
004840CD   52               PUSH EDX
004840CE   50               PUSH EAX
004840CF   56               PUSH ESI
004840D0   E8 CB940000      CALL haloce.0048D5A0
004840D5   83C4 10          ADD ESP,10
004840D8   85C0             TEST EAX,EAX ;EAX=00000000
004840DA   74 1C            JE SHORT haloce.004840F8
;004840DC   8B48 04          MOV ECX,DWORD PTR DS:[EAX+4]
;004840DF   33D2             XOR EDX,EDX
;004840E1   66:8B10          MOV DX,WORD PTR DS:[EAX]
;004840E4   51               PUSH ECX
;004840E5   52               PUSH EDX
;004840E6   E8 751E0900      CALL haloce.00515F60
;004840EB   83C4 08          ADD ESP,8
;004840EE   8BCE             MOV ECX,ESI
;004840F0   33C0             XOR EAX,EAX
;004840F2   5E               POP ESI
;004840F3   E9 98920000      JMP haloce.0048D390
004840F8   5E               POP ESI
004840F9   C3               RETN

...4
0048D1E3   FF52 0C          CALL DWORD PTR DS:[EDX+C] ;EDX=005F8E68   haloce.004840B0

004840B0   0FBF4424 04      MOVSX EAX,WORD PTR SS:[ESP+4] ;->EAX=000001AA
004840B5   8B0485 18416200  MOV EAX,DWORD PTR DS:[EAX*4+624118] ;->EAX=005F8E68
004840BC   8B4C24 0C        MOV ECX,DWORD PTR SS:[ESP+C] ;->ECX=403D9900
004840C0   56               PUSH ESI
004840C1   8B7424 0C        MOV ESI,DWORD PTR SS:[ESP+C] ;->ESI=F374000A
004840C5   51               PUSH ECX
004840C6   8D50 1C          LEA EDX,DWORD PTR DS:[EAX+1C] ;->EDX=005F8E84
004840C9   0FBF40 1A        MOVSX EAX,WORD PTR DS:[EAX+1A] ;->EAX=00000002

;parse parameters?
004840CD   52               PUSH EDX ;005F8E84
004840CE   50               PUSH EAX ;00000002
004840CF   56               PUSH ESI ;F374000A
004840D0   E8 CB940000      CALL haloce.0048D5A0
004840D5   83C4 10          ADD ESP,10

004840D8   85C0             TEST EAX,EAX ;EAX=403D9A3A
004840DA   74 1C            JE SHORT haloce.004840F8
004840DC   8B48 04          MOV ECX,DWORD PTR DS:[EAX+4] ;->ECX=3F800000
004840DF   33D2             XOR EDX,EDX
004840E1   66:8B10          MOV DX,WORD PTR DS:[EAX] ;->DX=0000

;cinematic_screen_effect_set_video <short>2 <real>2
004840E4   51               PUSH ECX ;40000000 (2.0)
004840E5   52               PUSH EDX ;0002
004840E6   E8 751E0900      CALL haloce.00515F60
->
 00515F60   8B15 7C826B00    MOV EDX,DWORD PTR DS:[6B827C]
 00515F66   56               PUSH ESI
 00515F67   33F6             XOR ESI,ESI
 00515F69   3BD6             CMP EDX,ESI
 00515F6B   0F84 9E000000    JE haloce.0051600F
 00515F71   53               PUSH EBX
 00515F72   8B1D 1C846B00    MOV EBX,DWORD PTR DS:[6B841C]
 00515F78   8B8B 28010000    MOV ECX,DWORD PTR DS:[EBX+128]
 00515F7E   83C8 FF          OR EAX,FFFFFFFF
 00515F81   3BC8             CMP ECX,EAX
 00515F83   0F84 85000000    JE haloce.0051600E
 00515F89   3983 38010000    CMP DWORD PTR DS:[EBX+138],EAX
 00515F8F   74 7D            JE SHORT haloce.0051600E
 00515F91   33C0             XOR EAX,EAX
 00515F93   57               PUSH EDI
 00515F94   B9 0E000000      MOV ECX,0E
 00515F99   8BFA             MOV EDI,EDX
 00515F9B   F3:AB            REP STOS DWORD PTR ES:[EDI]
 00515F9D   66:8B4424 10     MOV AX,WORD PTR SS:[ESP+10];1st parameter
 00515FA2   66:8942 24       MOV WORD PTR DS:[EDX+24],AX
 00515FA6   A1 E46D8100      MOV EAX,DWORD PTR DS:[816DE4]
 00515FAB   8972 3C          MOV DWORD PTR DS:[EDX+3C],ESI
 00515FAE   8972 40          MOV DWORD PTR DS:[EDX+40],ESI
 00515FB1   8972 44          MOV DWORD PTR DS:[EDX+44],ESI
 00515FB4   8972 48          MOV DWORD PTR DS:[EDX+48],ESI
 00515FB7   8972 4C          MOV DWORD PTR DS:[EDX+4C],ESI
 00515FBA   8972 50          MOV DWORD PTR DS:[EDX+50],ESI
 00515FBD   8972 54          MOV DWORD PTR DS:[EDX+54],ESI
 00515FC0   8972 58          MOV DWORD PTR DS:[EDX+58],ESI
 00515FC3   8972 5C          MOV DWORD PTR DS:[EDX+5C],ESI
 00515FC6   8972 60          MOV DWORD PTR DS:[EDX+60],ESI
 00515FC9   C642 23 01       MOV BYTE PTR DS:[EDX+23],1
 00515FCD   8B8B 28010000    MOV ECX,DWORD PTR DS:[EBX+128]
 00515FD3   81E1 FFFF0000    AND ECX,0FFFF
 00515FD9   C1E1 05          SHL ECX,5
 00515FDC   8B4C01 14        MOV ECX,DWORD PTR DS:[ECX+EAX+14]
 00515FE0   8B49 64          MOV ECX,DWORD PTR DS:[ECX+64]
 00515FE3   894A 28          MOV DWORD PTR DS:[EDX+28],ECX
 00515FE6   8B4C24 14        MOV ECX,DWORD PTR SS:[ESP+14];2nd parameter
 00515FEA   894A 2C          MOV DWORD PTR DS:[EDX+2C],ECX
 00515FED   C742 30 0000803F MOV DWORD PTR DS:[EDX+30],3F800000
 00515FF4   8B8B 38010000    MOV ECX,DWORD PTR DS:[EBX+138]
 00515FFA   81E1 FFFF0000    AND ECX,0FFFF
 00516000   C1E1 05          SHL ECX,5
 00516003   8B4401 14        MOV EAX,DWORD PTR DS:[ECX+EAX+14]
 00516007   8B48 64          MOV ECX,DWORD PTR DS:[EAX+64]
 0051600A   894A 34          MOV DWORD PTR DS:[EDX+34],ECX
 0051600D   5F               POP EDI
 0051600E   5B               POP EBX
 0051600F   5E               POP ESI
 00516010   C3               RETN
<-
004840EB   83C4 08          ADD ESP,8

004840EE   8BCE             MOV ECX,ESI
004840F0   33C0             XOR EAX,EAX
004840F2   5E               POP ESI
004840F3   E9 98920000      JMP haloce.0048D390
004840F8   5E               POP ESI
004840F9   C3               RETN

;halo campaign map: c10
; cinematic_screen_effect_set_video(2, 2.0)
; cinematic_screen_effect_set_video(1, 2.0)
; cinematic_screen_effect_set_video(1, 2.0)